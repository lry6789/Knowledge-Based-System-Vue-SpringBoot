2023-01-27 00:00:00.013 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274055823414661120[0;39m 生成今日电子书快照开始
2023-01-27 00:00:00.061 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274055823414661120[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 00:00:00.067 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274055823414661120[0;39m ==> Parameters: 
2023-01-27 00:00:00.095 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274055823414661120[0;39m <==    Updates: 5
2023-01-27 00:00:00.096 INFO  com.example.wiki.job.EbookSnapshotJob             :35   [32m274055823414661120[0;39m 生成今日电子书快照结束，耗时：36毫秒
2023-01-27 00:00:05.015 INFO  com.example.wiki.job.DocJob                       :32   [32m274055844394569728[0;39m 更新电子书下的文档数据开始
2023-01-27 00:00:05.016 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274055844394569728[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:00:05.016 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274055844394569728[0;39m ==> Parameters: 
2023-01-27 00:00:05.017 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274055844394569728[0;39m <==    Updates: 1
2023-01-27 00:00:05.017 INFO  com.example.wiki.job.DocJob                       :35   [32m274055844394569728[0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2023-01-27 00:00:35.011 INFO  com.example.wiki.job.DocJob                       :32   [32m274055970206912512[0;39m 更新电子书下的文档数据开始
2023-01-27 00:00:35.012 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274055970206912512[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:00:35.013 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274055970206912512[0;39m ==> Parameters: 
2023-01-27 00:00:35.016 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274055970206912512[0;39m <==    Updates: 1
2023-01-27 00:00:35.017 INFO  com.example.wiki.job.DocJob                       :35   [32m274055970206912512[0;39m 更新电子书下的文档数据结束，耗时：6毫秒
2023-01-27 00:01:00.006 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274056075043540992[0;39m 生成今日电子书快照开始
2023-01-27 00:01:00.008 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274056075043540992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 00:01:00.009 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274056075043540992[0;39m ==> Parameters: 
2023-01-27 00:01:00.014 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274056075043540992[0;39m <==    Updates: 0
2023-01-27 00:01:00.016 INFO  com.example.wiki.job.EbookSnapshotJob             :35   [32m274056075043540992[0;39m 生成今日电子书快照结束，耗时：9毫秒
2023-01-27 00:01:05.014 INFO  com.example.wiki.job.DocJob                       :32   [32m274056096048615424[0;39m 更新电子书下的文档数据开始
2023-01-27 00:01:05.015 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274056096048615424[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:01:05.015 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274056096048615424[0;39m ==> Parameters: 
2023-01-27 00:01:05.017 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274056096048615424[0;39m <==    Updates: 1
2023-01-27 00:01:05.018 INFO  com.example.wiki.job.DocJob                       :35   [32m274056096048615424[0;39m 更新电子书下的文档数据结束，耗时：4毫秒
2023-01-27 00:01:35.004 INFO  com.example.wiki.job.DocJob                       :32   [32m274056221835792384[0;39m 更新电子书下的文档数据开始
2023-01-27 00:01:35.005 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274056221835792384[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:01:35.005 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274056221835792384[0;39m ==> Parameters: 
2023-01-27 00:01:35.007 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274056221835792384[0;39m <==    Updates: 1
2023-01-27 00:01:35.007 INFO  com.example.wiki.job.DocJob                       :35   [32m274056221835792384[0;39m 更新电子书下的文档数据结束，耗时：3毫秒
2023-01-27 00:02:00.002 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274056326685003776[0;39m 生成今日电子书快照开始
2023-01-27 00:02:00.003 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274056326685003776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 00:02:00.004 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274056326685003776[0;39m ==> Parameters: 
2023-01-27 00:02:00.006 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274056326685003776[0;39m <==    Updates: 0
2023-01-27 00:02:00.008 INFO  com.example.wiki.job.EbookSnapshotJob             :35   [32m274056326685003776[0;39m 生成今日电子书快照结束，耗时：6毫秒
2023-01-27 00:02:05.011 INFO  com.example.wiki.job.DocJob                       :32   [32m274056347694272512[0;39m 更新电子书下的文档数据开始
2023-01-27 00:02:05.013 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274056347694272512[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:02:05.013 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274056347694272512[0;39m ==> Parameters: 
2023-01-27 00:02:05.015 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274056347694272512[0;39m <==    Updates: 1
2023-01-27 00:02:05.015 INFO  com.example.wiki.job.DocJob                       :35   [32m274056347694272512[0;39m 更新电子书下的文档数据结束，耗时：3毫秒
2023-01-27 00:02:35.014 INFO  com.example.wiki.job.DocJob                       :32   [32m274056473535975424[0;39m 更新电子书下的文档数据开始
2023-01-27 00:02:35.016 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274056473535975424[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:02:35.016 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274056473535975424[0;39m ==> Parameters: 
2023-01-27 00:02:35.019 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274056473535975424[0;39m <==    Updates: 1
2023-01-27 00:02:35.020 INFO  com.example.wiki.job.DocJob                       :35   [32m274056473535975424[0;39m 更新电子书下的文档数据结束，耗时：5毫秒
2023-01-27 00:03:00.006 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274056578360020992[0;39m 生成今日电子书快照开始
2023-01-27 00:03:00.008 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274056578360020992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 00:03:00.009 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274056578360020992[0;39m ==> Parameters: 
2023-01-27 00:03:00.013 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274056578360020992[0;39m <==    Updates: 0
2023-01-27 00:03:00.014 INFO  com.example.wiki.job.EbookSnapshotJob             :35   [32m274056578360020992[0;39m 生成今日电子书快照结束，耗时：7毫秒
2023-01-27 00:03:05.005 INFO  com.example.wiki.job.DocJob                       :32   [32m274056599327346688[0;39m 更新电子书下的文档数据开始
2023-01-27 00:03:05.005 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274056599327346688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:03:05.007 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274056599327346688[0;39m ==> Parameters: 
2023-01-27 00:03:05.008 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274056599327346688[0;39m <==    Updates: 1
2023-01-27 00:03:05.008 INFO  com.example.wiki.job.DocJob                       :35   [32m274056599327346688[0;39m 更新电子书下的文档数据结束，耗时：3毫秒
2023-01-27 00:03:35.007 INFO  com.example.wiki.job.DocJob                       :32   [32m274056725164855296[0;39m 更新电子书下的文档数据开始
2023-01-27 00:03:35.009 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274056725164855296[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:03:35.009 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274056725164855296[0;39m ==> Parameters: 
2023-01-27 00:03:35.012 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274056725164855296[0;39m <==    Updates: 1
2023-01-27 00:03:35.012 INFO  com.example.wiki.job.DocJob                       :35   [32m274056725164855296[0;39m 更新电子书下的文档数据结束，耗时：5毫秒
2023-01-27 00:04:00.014 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274056830051815424[0;39m 生成今日电子书快照开始
2023-01-27 00:04:00.015 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274056830051815424[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 00:04:00.017 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274056830051815424[0;39m ==> Parameters: 
2023-01-27 00:04:00.021 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274056830051815424[0;39m <==    Updates: 0
2023-01-27 00:04:00.023 INFO  com.example.wiki.job.EbookSnapshotJob             :35   [32m274056830051815424[0;39m 生成今日电子书快照结束，耗时：9毫秒
2023-01-27 00:04:05.001 INFO  com.example.wiki.job.DocJob                       :32   [32m274056850968809472[0;39m 更新电子书下的文档数据开始
2023-01-27 00:04:05.003 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274056850968809472[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:04:05.003 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274056850968809472[0;39m ==> Parameters: 
2023-01-27 00:04:05.005 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274056850968809472[0;39m <==    Updates: 1
2023-01-27 00:04:05.006 INFO  com.example.wiki.job.DocJob                       :35   [32m274056850968809472[0;39m 更新电子书下的文档数据结束，耗时：4毫秒
2023-01-27 00:04:35.007 INFO  com.example.wiki.job.DocJob                       :32   [32m274056976823095296[0;39m 更新电子书下的文档数据开始
2023-01-27 00:04:35.008 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274056976823095296[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:04:35.009 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274056976823095296[0;39m ==> Parameters: 
2023-01-27 00:04:35.011 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274056976823095296[0;39m <==    Updates: 1
2023-01-27 00:04:35.011 INFO  com.example.wiki.job.DocJob                       :35   [32m274056976823095296[0;39m 更新电子书下的文档数据结束，耗时：4毫秒
2023-01-27 00:05:00.003 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274057081663918080[0;39m 生成今日电子书快照开始
2023-01-27 00:05:00.005 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274057081663918080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 00:05:00.006 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274057081663918080[0;39m ==> Parameters: 
2023-01-27 00:05:00.011 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274057081663918080[0;39m <==    Updates: 0
2023-01-27 00:05:00.013 INFO  com.example.wiki.job.EbookSnapshotJob             :35   [32m274057081663918080[0;39m 生成今日电子书快照结束，耗时：9毫秒
2023-01-27 00:05:05.002 INFO  com.example.wiki.job.DocJob                       :32   [32m274057102631243776[0;39m 更新电子书下的文档数据开始
2023-01-27 00:05:05.004 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274057102631243776[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:05:05.005 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274057102631243776[0;39m ==> Parameters: 
2023-01-27 00:05:05.007 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274057102631243776[0;39m <==    Updates: 1
2023-01-27 00:05:05.008 INFO  com.example.wiki.job.DocJob                       :35   [32m274057102631243776[0;39m 更新电子书下的文档数据结束，耗时：5毫秒
2023-01-27 00:05:35.009 INFO  com.example.wiki.job.DocJob                       :32   [32m274057228489723904[0;39m 更新电子书下的文档数据开始
2023-01-27 00:05:35.011 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274057228489723904[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:05:35.011 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274057228489723904[0;39m ==> Parameters: 
2023-01-27 00:05:35.014 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274057228489723904[0;39m <==    Updates: 1
2023-01-27 00:05:35.014 INFO  com.example.wiki.job.DocJob                       :35   [32m274057228489723904[0;39m 更新电子书下的文档数据结束，耗时：5毫秒
2023-01-27 00:06:00.004 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274057333326352384[0;39m 生成今日电子书快照开始
2023-01-27 00:06:00.006 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274057333326352384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 00:06:00.007 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274057333326352384[0;39m ==> Parameters: 
2023-01-27 00:06:00.012 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274057333326352384[0;39m <==    Updates: 0
2023-01-27 00:06:00.015 INFO  com.example.wiki.job.EbookSnapshotJob             :35   [32m274057333326352384[0;39m 生成今日电子书快照结束，耗时：10毫秒
2023-01-27 00:06:05.011 INFO  com.example.wiki.job.DocJob                       :32   [32m274057354327232512[0;39m 更新电子书下的文档数据开始
2023-01-27 00:06:05.013 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274057354327232512[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:06:05.013 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274057354327232512[0;39m ==> Parameters: 
2023-01-27 00:06:05.016 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274057354327232512[0;39m <==    Updates: 1
2023-01-27 00:06:05.016 INFO  com.example.wiki.job.DocJob                       :35   [32m274057354327232512[0;39m 更新电子书下的文档数据结束，耗时：4毫秒
2023-01-27 00:06:35.011 INFO  com.example.wiki.job.DocJob                       :32   [32m274057480156352512[0;39m 更新电子书下的文档数据开始
2023-01-27 00:06:35.012 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274057480156352512[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:06:35.013 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274057480156352512[0;39m ==> Parameters: 
2023-01-27 00:06:35.015 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274057480156352512[0;39m <==    Updates: 1
2023-01-27 00:06:35.015 INFO  com.example.wiki.job.DocJob                       :35   [32m274057480156352512[0;39m 更新电子书下的文档数据结束，耗时：3毫秒
2023-01-27 00:07:00.001 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274057584972009472[0;39m 生成今日电子书快照开始
2023-01-27 00:07:00.003 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274057584972009472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 00:07:00.004 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274057584972009472[0;39m ==> Parameters: 
2023-01-27 00:07:00.010 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274057584972009472[0;39m <==    Updates: 0
2023-01-27 00:07:00.011 INFO  com.example.wiki.job.EbookSnapshotJob             :35   [32m274057584972009472[0;39m 生成今日电子书快照结束，耗时：9毫秒
2023-01-27 00:07:05.006 INFO  com.example.wiki.job.DocJob                       :32   [32m274057605964500992[0;39m 更新电子书下的文档数据开始
2023-01-27 00:07:05.006 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274057605964500992[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:07:05.006 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274057605964500992[0;39m ==> Parameters: 
2023-01-27 00:07:05.009 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274057605964500992[0;39m <==    Updates: 1
2023-01-27 00:07:05.009 INFO  com.example.wiki.job.DocJob                       :35   [32m274057605964500992[0;39m 更新电子书下的文档数据结束，耗时：3毫秒
2023-01-27 00:07:35.011 INFO  com.example.wiki.job.DocJob                       :32   [32m274057731814592512[0;39m 更新电子书下的文档数据开始
2023-01-27 00:07:35.013 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274057731814592512[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:07:35.014 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274057731814592512[0;39m ==> Parameters: 
2023-01-27 00:07:35.017 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274057731814592512[0;39m <==    Updates: 1
2023-01-27 00:07:35.017 INFO  com.example.wiki.job.DocJob                       :35   [32m274057731814592512[0;39m 更新电子书下的文档数据结束，耗时：5毫秒
2023-01-27 00:08:00.005 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274057836647026688[0;39m 生成今日电子书快照开始
2023-01-27 00:08:00.007 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274057836647026688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 00:08:00.008 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274057836647026688[0;39m ==> Parameters: 
2023-01-27 00:08:00.014 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274057836647026688[0;39m <==    Updates: 0
2023-01-27 00:08:00.016 INFO  com.example.wiki.job.EbookSnapshotJob             :35   [32m274057836647026688[0;39m 生成今日电子书快照结束，耗时：10毫秒
2023-01-27 00:08:05.011 INFO  com.example.wiki.job.DocJob                       :32   [32m274057857643712512[0;39m 更新电子书下的文档数据开始
2023-01-27 00:08:05.013 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274057857643712512[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:08:05.013 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274057857643712512[0;39m ==> Parameters: 
2023-01-27 00:08:05.016 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274057857643712512[0;39m <==    Updates: 1
2023-01-27 00:08:05.016 INFO  com.example.wiki.job.DocJob                       :35   [32m274057857643712512[0;39m 更新电子书下的文档数据结束，耗时：5毫秒
2023-01-27 00:08:35.001 INFO  com.example.wiki.job.DocJob                       :32   [32m274057983430889472[0;39m 更新电子书下的文档数据开始
2023-01-27 00:08:35.002 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274057983430889472[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:08:35.002 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274057983430889472[0;39m ==> Parameters: 
2023-01-27 00:08:35.004 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274057983430889472[0;39m <==    Updates: 1
2023-01-27 00:08:35.004 INFO  com.example.wiki.job.DocJob                       :35   [32m274057983430889472[0;39m 更新电子书下的文档数据结束，耗时：3毫秒
2023-01-27 00:09:00.006 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274058088309460992[0;39m 生成今日电子书快照开始
2023-01-27 00:09:00.007 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274058088309460992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 00:09:00.007 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274058088309460992[0;39m ==> Parameters: 
2023-01-27 00:09:00.009 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274058088309460992[0;39m <==    Updates: 0
2023-01-27 00:09:00.010 INFO  com.example.wiki.job.EbookSnapshotJob             :35   [32m274058088309460992[0;39m 生成今日电子书快照结束，耗时：4毫秒
2023-01-27 00:09:05.013 INFO  com.example.wiki.job.DocJob                       :32   [32m274058109310341120[0;39m 更新电子书下的文档数据开始
2023-01-27 00:09:05.015 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274058109310341120[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:09:05.016 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274058109310341120[0;39m ==> Parameters: 
2023-01-27 00:09:05.018 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274058109310341120[0;39m <==    Updates: 1
2023-01-27 00:09:05.019 INFO  com.example.wiki.job.DocJob                       :35   [32m274058109310341120[0;39m 更新电子书下的文档数据结束，耗时：5毫秒
2023-01-27 00:09:35.012 INFO  com.example.wiki.job.DocJob                       :32   [32m274058235135266816[0;39m 更新电子书下的文档数据开始
2023-01-27 00:09:35.013 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274058235135266816[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:09:35.013 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274058235135266816[0;39m ==> Parameters: 
2023-01-27 00:09:35.015 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274058235135266816[0;39m <==    Updates: 1
2023-01-27 00:09:35.016 INFO  com.example.wiki.job.DocJob                       :35   [32m274058235135266816[0;39m 更新电子书下的文档数据结束，耗时：4毫秒
2023-01-27 00:10:00.008 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274058339976089600[0;39m 生成今日电子书快照开始
2023-01-27 00:10:00.010 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274058339976089600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 00:10:00.011 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274058339976089600[0;39m ==> Parameters: 
2023-01-27 00:10:00.015 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274058339976089600[0;39m <==    Updates: 0
2023-01-27 00:10:00.017 INFO  com.example.wiki.job.EbookSnapshotJob             :35   [32m274058339976089600[0;39m 生成今日电子书快照结束，耗时：8毫秒
2023-01-27 00:10:05.005 INFO  com.example.wiki.job.DocJob                       :32   [32m274058360935026688[0;39m 更新电子书下的文档数据开始
2023-01-27 00:10:05.006 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274058360935026688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:10:05.006 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274058360935026688[0;39m ==> Parameters: 
2023-01-27 00:10:05.009 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274058360935026688[0;39m <==    Updates: 1
2023-01-27 00:10:05.009 INFO  com.example.wiki.job.DocJob                       :35   [32m274058360935026688[0;39m 更新电子书下的文档数据结束，耗时：4毫秒
2023-01-27 00:10:35.007 INFO  com.example.wiki.job.DocJob                       :32   [32m274058486772535296[0;39m 更新电子书下的文档数据开始
2023-01-27 00:10:35.009 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274058486772535296[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:10:35.010 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274058486772535296[0;39m ==> Parameters: 
2023-01-27 00:10:35.013 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274058486772535296[0;39m <==    Updates: 1
2023-01-27 00:10:35.013 INFO  com.example.wiki.job.DocJob                       :35   [32m274058486772535296[0;39m 更新电子书下的文档数据结束，耗时：5毫秒
2023-01-27 00:11:00.014 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274058591659495424[0;39m 生成今日电子书快照开始
2023-01-27 00:11:00.016 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274058591659495424[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 00:11:00.017 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274058591659495424[0;39m ==> Parameters: 
2023-01-27 00:11:00.020 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274058591659495424[0;39m <==    Updates: 0
2023-01-27 00:11:00.020 INFO  com.example.wiki.job.EbookSnapshotJob             :35   [32m274058591659495424[0;39m 生成今日电子书快照结束，耗时：5毫秒
2023-01-27 00:11:05.001 INFO  com.example.wiki.job.DocJob                       :32   [32m274058612576489472[0;39m 更新电子书下的文档数据开始
2023-01-27 00:11:05.016 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274058612576489472[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:11:05.018 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274058612576489472[0;39m ==> Parameters: 
2023-01-27 00:11:05.019 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274058612576489472[0;39m <==    Updates: 1
2023-01-27 00:11:05.019 INFO  com.example.wiki.job.DocJob                       :35   [32m274058612576489472[0;39m 更新电子书下的文档数据结束，耗时：18毫秒
2023-01-27 00:11:35.013 INFO  com.example.wiki.job.DocJob                       :32   [32m274058738455941120[0;39m 更新电子书下的文档数据开始
2023-01-27 00:11:35.014 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274058738455941120[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:11:35.014 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274058738455941120[0;39m ==> Parameters: 
2023-01-27 00:11:35.015 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274058738455941120[0;39m <==    Updates: 1
2023-01-27 00:11:35.016 INFO  com.example.wiki.job.DocJob                       :35   [32m274058738455941120[0;39m 更新电子书下的文档数据结束，耗时：3毫秒
2023-01-27 00:11:52.307 INFO  com.example.wiki.aspect.LogAspect                 :50   [32m274058810992234496[0;39m ------------- 开始 -------------
2023-01-27 00:11:52.318 INFO  com.example.wiki.aspect.LogAspect                 :51   [32m274058810992234496[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2023-01-27 00:11:52.318 INFO  com.example.wiki.aspect.LogAspect                 :52   [32m274058810992234496[0;39m 类名方法: com.example.wiki.controller.EbookController.list
2023-01-27 00:11:52.319 INFO  com.example.wiki.aspect.LogAspect                 :53   [32m274058810992234496[0;39m 远程地址: 127.0.0.1
2023-01-27 00:11:52.319 INFO  com.example.wiki.aspect.LogAspect                 :75   [32m274058810992234496[0;39m 请求参数: [{"page":1,"size":4}]
2023-01-27 00:11:52.320 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274058810992234496[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2023-01-27 00:11:52.320 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274058810992234496[0;39m ==> Parameters: 
2023-01-27 00:11:52.323 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274058810992234496[0;39m <==    Columns: count(0)
2023-01-27 00:11:52.323 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274058810992234496[0;39m <==        Row: 5
2023-01-27 00:11:52.323 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274058810992234496[0;39m <==      Total: 1
2023-01-27 00:11:52.324 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274058810992234496[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2023-01-27 00:11:52.324 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274058810992234496[0;39m ==> Parameters: 4(Integer)
2023-01-27 00:11:52.325 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274058810992234496[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2023-01-27 00:11:52.325 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274058810992234496[0;39m <==        Row: 1, Spring Boot 入门教程, null, null, 零基础入门 Java 开发，企业级应用开发最佳首选框架, null, 6, 0, 0
2023-01-27 00:11:52.325 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274058810992234496[0;39m <==        Row: 2, Vue 入门教程, null, null, 零基础入门 Vue 开发，企业级应用开发最佳首选框架, null, 0, 0, 0
2023-01-27 00:11:52.325 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274058810992234496[0;39m <==        Row: 3, Python 入门教程, null, null, 零基础入门 Python 开发，企业级应用开发最佳首选框架, null, 0, 0, 0
2023-01-27 00:11:52.326 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274058810992234496[0;39m <==        Row: 4, Mysql 入门教程, null, null, 零基础入门 Mysql 开发，企业级应用开发最佳首选框架, null, 0, 0, 0
2023-01-27 00:11:52.326 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274058810992234496[0;39m <==      Total: 4
2023-01-27 00:11:52.326 INFO  com.example.wiki.service.EbookService             :51   [32m274058810992234496[0;39m 总行数 5
2023-01-27 00:11:52.326 INFO  com.example.wiki.service.EbookService             :52   [32m274058810992234496[0;39m 总页数 2
2023-01-27 00:11:52.327 INFO  com.example.wiki.aspect.LogAspect                 :87   [32m274058810992234496[0;39m 返回结果: {"content":{"list":[{"description":"零基础入门 Java 开发，企业级应用开发最佳首选框架","docCount":6,"id":1,"name":"Spring Boot 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Vue 开发，企业级应用开发最佳首选框架","docCount":0,"id":2,"name":"Vue 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Python 开发，企业级应用开发最佳首选框架","docCount":0,"id":3,"name":"Python 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Mysql 开发，企业级应用开发最佳首选框架","docCount":0,"id":4,"name":"Mysql 入门教程","viewCount":0,"voteCount":0}],"total":5},"success":true}
2023-01-27 00:11:52.327 INFO  com.example.wiki.aspect.LogAspect                 :88   [32m274058810992234496[0;39m ------------- 结束 耗时：20 ms -------------
2023-01-27 00:12:00.009 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274058843296763904[0;39m 生成今日电子书快照开始
2023-01-27 00:12:00.010 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274058843296763904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 00:12:00.010 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274058843296763904[0;39m ==> Parameters: 
2023-01-27 00:12:00.015 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274058843296763904[0;39m <==    Updates: 0
2023-01-27 00:12:00.016 INFO  com.example.wiki.job.EbookSnapshotJob             :35   [32m274058843296763904[0;39m 生成今日电子书快照结束，耗时：7毫秒
2023-01-27 00:12:05.002 INFO  com.example.wiki.job.DocJob                       :32   [32m274058864238923776[0;39m 更新电子书下的文档数据开始
2023-01-27 00:12:05.003 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274058864238923776[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:12:05.004 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274058864238923776[0;39m ==> Parameters: 
2023-01-27 00:12:05.005 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274058864238923776[0;39m <==    Updates: 1
2023-01-27 00:12:05.006 INFO  com.example.wiki.job.DocJob                       :35   [32m274058864238923776[0;39m 更新电子书下的文档数据结束，耗时：4毫秒
2023-01-27 00:12:35.004 INFO  com.example.wiki.job.DocJob                       :32   [32m274058990076432384[0;39m 更新电子书下的文档数据开始
2023-01-27 00:12:35.005 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274058990076432384[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:12:35.005 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274058990076432384[0;39m ==> Parameters: 
2023-01-27 00:12:35.006 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274058990076432384[0;39m <==    Updates: 1
2023-01-27 00:12:35.006 INFO  com.example.wiki.job.DocJob                       :35   [32m274058990076432384[0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2023-01-27 00:12:56.299 INFO  com.example.wiki.aspect.LogAspect                 :50   [32m274059079394136064[0;39m ------------- 开始 -------------
2023-01-27 00:12:56.300 INFO  com.example.wiki.aspect.LogAspect                 :51   [32m274059079394136064[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2023-01-27 00:12:56.300 INFO  com.example.wiki.aspect.LogAspect                 :52   [32m274059079394136064[0;39m 类名方法: com.example.wiki.controller.EbookController.list
2023-01-27 00:12:56.300 INFO  com.example.wiki.aspect.LogAspect                 :53   [32m274059079394136064[0;39m 远程地址: 127.0.0.1
2023-01-27 00:12:56.300 INFO  com.example.wiki.aspect.LogAspect                 :75   [32m274059079394136064[0;39m 请求参数: [{"page":1,"size":4}]
2023-01-27 00:12:56.301 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274059079394136064[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2023-01-27 00:12:56.302 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274059079394136064[0;39m ==> Parameters: 
2023-01-27 00:12:56.304 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274059079394136064[0;39m <==    Columns: count(0)
2023-01-27 00:12:56.304 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274059079394136064[0;39m <==        Row: 5
2023-01-27 00:12:56.304 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274059079394136064[0;39m <==      Total: 1
2023-01-27 00:12:56.306 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274059079394136064[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2023-01-27 00:12:56.308 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274059079394136064[0;39m ==> Parameters: 4(Integer)
2023-01-27 00:12:56.309 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274059079394136064[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2023-01-27 00:12:56.309 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274059079394136064[0;39m <==        Row: 1, Spring Boot 入门教程, null, null, 零基础入门 Java 开发，企业级应用开发最佳首选框架, null, 6, 0, 0
2023-01-27 00:12:56.310 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274059079394136064[0;39m <==        Row: 2, Vue 入门教程, null, null, 零基础入门 Vue 开发，企业级应用开发最佳首选框架, null, 0, 0, 0
2023-01-27 00:12:56.310 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274059079394136064[0;39m <==        Row: 3, Python 入门教程, null, null, 零基础入门 Python 开发，企业级应用开发最佳首选框架, null, 0, 0, 0
2023-01-27 00:12:56.310 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274059079394136064[0;39m <==        Row: 4, Mysql 入门教程, null, null, 零基础入门 Mysql 开发，企业级应用开发最佳首选框架, null, 0, 0, 0
2023-01-27 00:12:56.310 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274059079394136064[0;39m <==      Total: 4
2023-01-27 00:12:56.311 INFO  com.example.wiki.service.EbookService             :51   [32m274059079394136064[0;39m 总行数 5
2023-01-27 00:12:56.311 INFO  com.example.wiki.service.EbookService             :52   [32m274059079394136064[0;39m 总页数 2
2023-01-27 00:12:56.311 INFO  com.example.wiki.aspect.LogAspect                 :87   [32m274059079394136064[0;39m 返回结果: {"content":{"list":[{"description":"零基础入门 Java 开发，企业级应用开发最佳首选框架","docCount":6,"id":1,"name":"Spring Boot 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Vue 开发，企业级应用开发最佳首选框架","docCount":0,"id":2,"name":"Vue 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Python 开发，企业级应用开发最佳首选框架","docCount":0,"id":3,"name":"Python 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Mysql 开发，企业级应用开发最佳首选框架","docCount":0,"id":4,"name":"Mysql 入门教程","viewCount":0,"voteCount":0}],"total":5},"success":true}
2023-01-27 00:12:56.311 INFO  com.example.wiki.aspect.LogAspect                 :88   [32m274059079394136064[0;39m ------------- 结束 耗时：12 ms -------------
2023-01-27 00:13:00.011 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274059094963392512[0;39m 生成今日电子书快照开始
2023-01-27 00:13:00.012 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274059094963392512[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 00:13:00.012 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274059094963392512[0;39m ==> Parameters: 
2023-01-27 00:13:00.014 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274059094963392512[0;39m <==    Updates: 0
2023-01-27 00:13:00.016 INFO  com.example.wiki.job.EbookSnapshotJob             :35   [32m274059094963392512[0;39m 生成今日电子书快照结束，耗时：5毫秒
2023-01-27 00:13:05.005 INFO  com.example.wiki.job.DocJob                       :32   [32m274059115909746688[0;39m 更新电子书下的文档数据开始
2023-01-27 00:13:05.006 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274059115909746688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:13:05.006 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274059115909746688[0;39m ==> Parameters: 
2023-01-27 00:13:05.007 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274059115909746688[0;39m <==    Updates: 1
2023-01-27 00:13:05.007 INFO  com.example.wiki.job.DocJob                       :35   [32m274059115909746688[0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2023-01-27 00:13:35.003 INFO  com.example.wiki.job.DocJob                       :32   [32m274059241730478080[0;39m 更新电子书下的文档数据开始
2023-01-27 00:13:35.005 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274059241730478080[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:13:35.006 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274059241730478080[0;39m ==> Parameters: 
2023-01-27 00:13:35.020 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274059241730478080[0;39m <==    Updates: 1
2023-01-27 00:13:35.020 INFO  com.example.wiki.job.DocJob                       :35   [32m274059241730478080[0;39m 更新电子书下的文档数据结束，耗时：17毫秒
2023-01-27 00:14:00.012 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274059346625826816[0;39m 生成今日电子书快照开始
2023-01-27 00:14:00.013 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274059346625826816[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 00:14:00.014 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274059346625826816[0;39m ==> Parameters: 
2023-01-27 00:14:00.035 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274059346625826816[0;39m <==    Updates: 0
2023-01-27 00:14:00.036 INFO  com.example.wiki.job.EbookSnapshotJob             :35   [32m274059346625826816[0;39m 生成今日电子书快照结束，耗时：24毫秒
2023-01-27 00:14:05.011 INFO  com.example.wiki.job.DocJob                       :32   [32m274059367593152512[0;39m 更新电子书下的文档数据开始
2023-01-27 00:14:05.012 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274059367593152512[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:14:05.013 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274059367593152512[0;39m ==> Parameters: 
2023-01-27 00:14:05.015 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274059367593152512[0;39m <==    Updates: 1
2023-01-27 00:14:05.016 INFO  com.example.wiki.job.DocJob                       :35   [32m274059367593152512[0;39m 更新电子书下的文档数据结束，耗时：4毫秒
2023-01-27 00:14:35.010 INFO  com.example.wiki.job.DocJob                       :32   [32m274059493418078208[0;39m 更新电子书下的文档数据开始
2023-01-27 00:14:35.011 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274059493418078208[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:14:35.011 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274059493418078208[0;39m ==> Parameters: 
2023-01-27 00:14:35.025 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274059493418078208[0;39m <==    Updates: 1
2023-01-27 00:14:35.025 INFO  com.example.wiki.job.DocJob                       :35   [32m274059493418078208[0;39m 更新电子书下的文档数据结束，耗时：15毫秒
2023-01-27 00:15:00.012 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274059598284066816[0;39m 生成今日电子书快照开始
2023-01-27 00:15:00.014 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274059598284066816[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 00:15:00.015 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274059598284066816[0;39m ==> Parameters: 
2023-01-27 00:15:00.022 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274059598284066816[0;39m <==    Updates: 0
2023-01-27 00:15:00.023 INFO  com.example.wiki.job.EbookSnapshotJob             :35   [32m274059598284066816[0;39m 生成今日电子书快照结束，耗时：10毫秒
2023-01-27 00:15:05.001 INFO  com.example.wiki.job.DocJob                       :32   [32m274059619209449472[0;39m 更新电子书下的文档数据开始
2023-01-27 00:15:05.003 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274059619209449472[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:15:05.003 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274059619209449472[0;39m ==> Parameters: 
2023-01-27 00:15:05.006 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274059619209449472[0;39m <==    Updates: 1
2023-01-27 00:15:05.007 INFO  com.example.wiki.job.DocJob                       :35   [32m274059619209449472[0;39m 更新电子书下的文档数据结束，耗时：5毫秒
2023-01-27 00:15:35.004 INFO  com.example.wiki.job.DocJob                       :32   [32m274059745051152384[0;39m 更新电子书下的文档数据开始
2023-01-27 00:15:35.006 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274059745051152384[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:15:35.006 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274059745051152384[0;39m ==> Parameters: 
2023-01-27 00:15:35.010 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274059745051152384[0;39m <==    Updates: 1
2023-01-27 00:15:35.010 INFO  com.example.wiki.job.DocJob                       :35   [32m274059745051152384[0;39m 更新电子书下的文档数据结束，耗时：5毫秒
2023-01-27 00:15:43.388 INFO  com.example.wiki.aspect.LogAspect                 :50   [32m274059780216197120[0;39m ------------- 开始 -------------
2023-01-27 00:15:43.389 INFO  com.example.wiki.aspect.LogAspect                 :51   [32m274059780216197120[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2023-01-27 00:15:43.389 INFO  com.example.wiki.aspect.LogAspect                 :52   [32m274059780216197120[0;39m 类名方法: com.example.wiki.controller.EbookController.list
2023-01-27 00:15:43.390 INFO  com.example.wiki.aspect.LogAspect                 :53   [32m274059780216197120[0;39m 远程地址: 127.0.0.1
2023-01-27 00:15:43.390 INFO  com.example.wiki.aspect.LogAspect                 :75   [32m274059780216197120[0;39m 请求参数: [{"page":1,"size":4}]
2023-01-27 00:15:43.394 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274059780216197120[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2023-01-27 00:15:43.395 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274059780216197120[0;39m ==> Parameters: 
2023-01-27 00:15:43.396 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274059780216197120[0;39m <==    Columns: count(0)
2023-01-27 00:15:43.397 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274059780216197120[0;39m <==        Row: 5
2023-01-27 00:15:43.397 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274059780216197120[0;39m <==      Total: 1
2023-01-27 00:15:43.397 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274059780216197120[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2023-01-27 00:15:43.398 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274059780216197120[0;39m ==> Parameters: 4(Integer)
2023-01-27 00:15:43.399 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274059780216197120[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2023-01-27 00:15:43.399 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274059780216197120[0;39m <==        Row: 1, Spring Boot 入门教程, null, null, 零基础入门 Java 开发，企业级应用开发最佳首选框架, null, 6, 0, 0
2023-01-27 00:15:43.399 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274059780216197120[0;39m <==        Row: 2, Vue 入门教程, null, null, 零基础入门 Vue 开发，企业级应用开发最佳首选框架, null, 0, 0, 0
2023-01-27 00:15:43.399 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274059780216197120[0;39m <==        Row: 3, Python 入门教程, null, null, 零基础入门 Python 开发，企业级应用开发最佳首选框架, null, 0, 0, 0
2023-01-27 00:15:43.399 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274059780216197120[0;39m <==        Row: 4, Mysql 入门教程, null, null, 零基础入门 Mysql 开发，企业级应用开发最佳首选框架, null, 0, 0, 0
2023-01-27 00:15:43.400 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274059780216197120[0;39m <==      Total: 4
2023-01-27 00:15:43.400 INFO  com.example.wiki.service.EbookService             :51   [32m274059780216197120[0;39m 总行数 5
2023-01-27 00:15:43.400 INFO  com.example.wiki.service.EbookService             :52   [32m274059780216197120[0;39m 总页数 2
2023-01-27 00:15:43.400 INFO  com.example.wiki.aspect.LogAspect                 :87   [32m274059780216197120[0;39m 返回结果: {"content":{"list":[{"description":"零基础入门 Java 开发，企业级应用开发最佳首选框架","docCount":6,"id":1,"name":"Spring Boot 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Vue 开发，企业级应用开发最佳首选框架","docCount":0,"id":2,"name":"Vue 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Python 开发，企业级应用开发最佳首选框架","docCount":0,"id":3,"name":"Python 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Mysql 开发，企业级应用开发最佳首选框架","docCount":0,"id":4,"name":"Mysql 入门教程","viewCount":0,"voteCount":0}],"total":5},"success":true}
2023-01-27 00:15:43.400 INFO  com.example.wiki.aspect.LogAspect                 :88   [32m274059780216197120[0;39m ------------- 结束 耗时：12 ms -------------
2023-01-27 00:16:00.001 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274059849896169472[0;39m 生成今日电子书快照开始
2023-01-27 00:16:00.002 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274059849896169472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 00:16:00.002 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274059849896169472[0;39m ==> Parameters: 
2023-01-27 00:16:00.005 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274059849896169472[0;39m <==    Updates: 0
2023-01-27 00:16:00.009 INFO  com.example.wiki.job.EbookSnapshotJob             :35   [32m274059849896169472[0;39m 生成今日电子书快照结束，耗时：8毫秒
2023-01-27 00:16:02.638 INFO  com.example.wiki.aspect.LogAspect                 :50   [32m274059860956549120[0;39m ------------- 开始 -------------
2023-01-27 00:16:02.638 INFO  com.example.wiki.aspect.LogAspect                 :51   [32m274059860956549120[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2023-01-27 00:16:02.638 INFO  com.example.wiki.aspect.LogAspect                 :52   [32m274059860956549120[0;39m 类名方法: com.example.wiki.controller.EbookController.list
2023-01-27 00:16:02.639 INFO  com.example.wiki.aspect.LogAspect                 :53   [32m274059860956549120[0;39m 远程地址: 127.0.0.1
2023-01-27 00:16:02.639 INFO  com.example.wiki.aspect.LogAspect                 :75   [32m274059860956549120[0;39m 请求参数: [{"page":1,"size":4}]
2023-01-27 00:16:02.640 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274059860956549120[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2023-01-27 00:16:02.640 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274059860956549120[0;39m ==> Parameters: 
2023-01-27 00:16:02.642 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274059860956549120[0;39m <==    Columns: count(0)
2023-01-27 00:16:02.642 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274059860956549120[0;39m <==        Row: 5
2023-01-27 00:16:02.643 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274059860956549120[0;39m <==      Total: 1
2023-01-27 00:16:02.643 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274059860956549120[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2023-01-27 00:16:02.643 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274059860956549120[0;39m ==> Parameters: 4(Integer)
2023-01-27 00:16:02.644 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274059860956549120[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2023-01-27 00:16:02.645 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274059860956549120[0;39m <==        Row: 1, Spring Boot 入门教程, null, null, 零基础入门 Java 开发，企业级应用开发最佳首选框架, null, 6, 0, 0
2023-01-27 00:16:02.645 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274059860956549120[0;39m <==        Row: 2, Vue 入门教程, null, null, 零基础入门 Vue 开发，企业级应用开发最佳首选框架, null, 0, 0, 0
2023-01-27 00:16:02.645 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274059860956549120[0;39m <==        Row: 3, Python 入门教程, null, null, 零基础入门 Python 开发，企业级应用开发最佳首选框架, null, 0, 0, 0
2023-01-27 00:16:02.645 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274059860956549120[0;39m <==        Row: 4, Mysql 入门教程, null, null, 零基础入门 Mysql 开发，企业级应用开发最佳首选框架, null, 0, 0, 0
2023-01-27 00:16:02.645 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274059860956549120[0;39m <==      Total: 4
2023-01-27 00:16:02.645 INFO  com.example.wiki.service.EbookService             :51   [32m274059860956549120[0;39m 总行数 5
2023-01-27 00:16:02.646 INFO  com.example.wiki.service.EbookService             :52   [32m274059860956549120[0;39m 总页数 2
2023-01-27 00:16:02.646 INFO  com.example.wiki.aspect.LogAspect                 :87   [32m274059860956549120[0;39m 返回结果: {"content":{"list":[{"description":"零基础入门 Java 开发，企业级应用开发最佳首选框架","docCount":6,"id":1,"name":"Spring Boot 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Vue 开发，企业级应用开发最佳首选框架","docCount":0,"id":2,"name":"Vue 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Python 开发，企业级应用开发最佳首选框架","docCount":0,"id":3,"name":"Python 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Mysql 开发，企业级应用开发最佳首选框架","docCount":0,"id":4,"name":"Mysql 入门教程","viewCount":0,"voteCount":0}],"total":5},"success":true}
2023-01-27 00:16:02.646 INFO  com.example.wiki.aspect.LogAspect                 :88   [32m274059860956549120[0;39m ------------- 结束 耗时：8 ms -------------
2023-01-27 00:16:05.014 INFO  com.example.wiki.job.DocJob                       :32   [32m274059870922215424[0;39m 更新电子书下的文档数据开始
2023-01-27 00:16:05.015 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274059870922215424[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:16:05.015 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274059870922215424[0;39m ==> Parameters: 
2023-01-27 00:16:05.016 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274059870922215424[0;39m <==    Updates: 1
2023-01-27 00:16:05.016 INFO  com.example.wiki.job.DocJob                       :35   [32m274059870922215424[0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2023-01-27 00:16:11.785 INFO  com.example.wiki.aspect.LogAspect                 :50   [32m274059899321847808[0;39m ------------- 开始 -------------
2023-01-27 00:16:11.785 INFO  com.example.wiki.aspect.LogAspect                 :51   [32m274059899321847808[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2023-01-27 00:16:11.785 INFO  com.example.wiki.aspect.LogAspect                 :52   [32m274059899321847808[0;39m 类名方法: com.example.wiki.controller.EbookController.list
2023-01-27 00:16:11.786 INFO  com.example.wiki.aspect.LogAspect                 :53   [32m274059899321847808[0;39m 远程地址: 127.0.0.1
2023-01-27 00:16:11.786 INFO  com.example.wiki.aspect.LogAspect                 :75   [32m274059899321847808[0;39m 请求参数: [{"page":1,"size":4}]
2023-01-27 00:16:11.787 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274059899321847808[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2023-01-27 00:16:11.788 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274059899321847808[0;39m ==> Parameters: 
2023-01-27 00:16:11.789 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274059899321847808[0;39m <==    Columns: count(0)
2023-01-27 00:16:11.790 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274059899321847808[0;39m <==        Row: 5
2023-01-27 00:16:11.790 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274059899321847808[0;39m <==      Total: 1
2023-01-27 00:16:11.791 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274059899321847808[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2023-01-27 00:16:11.791 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274059899321847808[0;39m ==> Parameters: 4(Integer)
2023-01-27 00:16:11.793 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274059899321847808[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2023-01-27 00:16:11.793 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274059899321847808[0;39m <==        Row: 1, Spring Boot 入门教程, null, null, 零基础入门 Java 开发，企业级应用开发最佳首选框架, null, 6, 0, 0
2023-01-27 00:16:11.793 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274059899321847808[0;39m <==        Row: 2, Vue 入门教程, null, null, 零基础入门 Vue 开发，企业级应用开发最佳首选框架, null, 0, 0, 0
2023-01-27 00:16:11.794 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274059899321847808[0;39m <==        Row: 3, Python 入门教程, null, null, 零基础入门 Python 开发，企业级应用开发最佳首选框架, null, 0, 0, 0
2023-01-27 00:16:11.794 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274059899321847808[0;39m <==        Row: 4, Mysql 入门教程, null, null, 零基础入门 Mysql 开发，企业级应用开发最佳首选框架, null, 0, 0, 0
2023-01-27 00:16:11.794 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274059899321847808[0;39m <==      Total: 4
2023-01-27 00:16:11.794 INFO  com.example.wiki.service.EbookService             :51   [32m274059899321847808[0;39m 总行数 5
2023-01-27 00:16:11.794 INFO  com.example.wiki.service.EbookService             :52   [32m274059899321847808[0;39m 总页数 2
2023-01-27 00:16:11.795 INFO  com.example.wiki.aspect.LogAspect                 :87   [32m274059899321847808[0;39m 返回结果: {"content":{"list":[{"description":"零基础入门 Java 开发，企业级应用开发最佳首选框架","docCount":6,"id":1,"name":"Spring Boot 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Vue 开发，企业级应用开发最佳首选框架","docCount":0,"id":2,"name":"Vue 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Python 开发，企业级应用开发最佳首选框架","docCount":0,"id":3,"name":"Python 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Mysql 开发，企业级应用开发最佳首选框架","docCount":0,"id":4,"name":"Mysql 入门教程","viewCount":0,"voteCount":0}],"total":5},"success":true}
2023-01-27 00:16:11.795 INFO  com.example.wiki.aspect.LogAspect                 :88   [32m274059899321847808[0;39m ------------- 结束 耗时：10 ms -------------
2023-01-27 00:16:17.952 INFO  com.example.wiki.aspect.LogAspect                 :50   [32m274059925188120576[0;39m ------------- 开始 -------------
2023-01-27 00:16:17.952 INFO  com.example.wiki.aspect.LogAspect                 :51   [32m274059925188120576[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2023-01-27 00:16:17.953 INFO  com.example.wiki.aspect.LogAspect                 :52   [32m274059925188120576[0;39m 类名方法: com.example.wiki.controller.EbookController.list
2023-01-27 00:16:17.953 INFO  com.example.wiki.aspect.LogAspect                 :53   [32m274059925188120576[0;39m 远程地址: 127.0.0.1
2023-01-27 00:16:17.953 INFO  com.example.wiki.aspect.LogAspect                 :75   [32m274059925188120576[0;39m 请求参数: [{"page":2,"size":4}]
2023-01-27 00:16:17.954 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274059925188120576[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2023-01-27 00:16:17.955 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274059925188120576[0;39m ==> Parameters: 
2023-01-27 00:16:17.957 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274059925188120576[0;39m <==    Columns: count(0)
2023-01-27 00:16:17.957 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274059925188120576[0;39m <==        Row: 5
2023-01-27 00:16:17.957 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274059925188120576[0;39m <==      Total: 1
2023-01-27 00:16:17.958 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274059925188120576[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?, ?
2023-01-27 00:16:17.958 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274059925188120576[0;39m ==> Parameters: 4(Integer), 4(Integer)
2023-01-27 00:16:17.959 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274059925188120576[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2023-01-27 00:16:17.959 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274059925188120576[0;39m <==        Row: 5, Oracle 入门教程, null, null, 零基础入门 Oracle 开发，企业级应用开发最佳首选框架, null, 0, 0, 0
2023-01-27 00:16:17.959 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274059925188120576[0;39m <==      Total: 1
2023-01-27 00:16:17.960 INFO  com.example.wiki.service.EbookService             :51   [32m274059925188120576[0;39m 总行数 5
2023-01-27 00:16:17.960 INFO  com.example.wiki.service.EbookService             :52   [32m274059925188120576[0;39m 总页数 2
2023-01-27 00:16:17.960 INFO  com.example.wiki.aspect.LogAspect                 :87   [32m274059925188120576[0;39m 返回结果: {"content":{"list":[{"description":"零基础入门 Oracle 开发，企业级应用开发最佳首选框架","docCount":0,"id":5,"name":"Oracle 入门教程","viewCount":0,"voteCount":0}],"total":5},"success":true}
2023-01-27 00:16:17.960 INFO  com.example.wiki.aspect.LogAspect                 :88   [32m274059925188120576[0;39m ------------- 结束 耗时：8 ms -------------
2023-01-27 00:16:35.009 INFO  com.example.wiki.job.DocJob                       :32   [32m274059996730363904[0;39m 更新电子书下的文档数据开始
2023-01-27 00:16:35.009 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274059996730363904[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:16:35.010 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274059996730363904[0;39m ==> Parameters: 
2023-01-27 00:16:35.010 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274059996730363904[0;39m <==    Updates: 1
2023-01-27 00:16:35.011 INFO  com.example.wiki.job.DocJob                       :35   [32m274059996730363904[0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2023-01-27 00:17:00.011 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274060101596352512[0;39m 生成今日电子书快照开始
2023-01-27 00:17:00.011 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274060101596352512[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 00:17:00.011 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274060101596352512[0;39m ==> Parameters: 
2023-01-27 00:17:00.014 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274060101596352512[0;39m <==    Updates: 0
2023-01-27 00:17:00.014 INFO  com.example.wiki.job.EbookSnapshotJob             :35   [32m274060101596352512[0;39m 生成今日电子书快照结束，耗时：3毫秒
2023-01-27 00:17:05.006 INFO  com.example.wiki.job.DocJob                       :32   [32m274060122546900992[0;39m 更新电子书下的文档数据开始
2023-01-27 00:17:05.007 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274060122546900992[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:17:05.007 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274060122546900992[0;39m ==> Parameters: 
2023-01-27 00:17:05.008 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274060122546900992[0;39m <==    Updates: 1
2023-01-27 00:17:05.009 INFO  com.example.wiki.job.DocJob                       :35   [32m274060122546900992[0;39m 更新电子书下的文档数据结束，耗时：3毫秒
2023-01-27 00:17:35.002 INFO  com.example.wiki.job.DocJob                       :32   [32m274060248359243776[0;39m 更新电子书下的文档数据开始
2023-01-27 00:17:35.002 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274060248359243776[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:17:35.003 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274060248359243776[0;39m ==> Parameters: 
2023-01-27 00:17:35.019 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274060248359243776[0;39m <==    Updates: 1
2023-01-27 00:17:35.020 INFO  com.example.wiki.job.DocJob                       :35   [32m274060248359243776[0;39m 更新电子书下的文档数据结束，耗时：18毫秒
2023-01-27 00:18:00.002 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274060353216843776[0;39m 生成今日电子书快照开始
2023-01-27 00:18:00.003 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274060353216843776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 00:18:00.004 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274060353216843776[0;39m ==> Parameters: 
2023-01-27 00:18:00.007 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274060353216843776[0;39m <==    Updates: 0
2023-01-27 00:18:00.007 INFO  com.example.wiki.job.EbookSnapshotJob             :35   [32m274060353216843776[0;39m 生成今日电子书快照结束，耗时：5毫秒
2023-01-27 00:18:05.003 INFO  com.example.wiki.job.DocJob                       :32   [32m274060374192558080[0;39m 更新电子书下的文档数据开始
2023-01-27 00:18:05.003 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274060374192558080[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:18:05.003 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274060374192558080[0;39m ==> Parameters: 
2023-01-27 00:18:05.006 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274060374192558080[0;39m <==    Updates: 1
2023-01-27 00:18:05.006 INFO  com.example.wiki.job.DocJob                       :35   [32m274060374192558080[0;39m 更新电子书下的文档数据结束，耗时：3毫秒
2023-01-27 00:18:35.011 INFO  com.example.wiki.job.DocJob                       :32   [32m274060500055232512[0;39m 更新电子书下的文档数据开始
2023-01-27 00:18:35.012 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274060500055232512[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:18:35.012 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274060500055232512[0;39m ==> Parameters: 
2023-01-27 00:18:35.013 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274060500055232512[0;39m <==    Updates: 1
2023-01-27 00:18:35.013 INFO  com.example.wiki.job.DocJob                       :35   [32m274060500055232512[0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2023-01-27 00:19:00.009 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274060604904443904[0;39m 生成今日电子书快照开始
2023-01-27 00:19:00.010 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274060604904443904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 00:19:00.011 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274060604904443904[0;39m ==> Parameters: 
2023-01-27 00:19:00.013 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274060604904443904[0;39m <==    Updates: 0
2023-01-27 00:19:00.013 INFO  com.example.wiki.job.EbookSnapshotJob             :35   [32m274060604904443904[0;39m 生成今日电子书快照结束，耗时：4毫秒
2023-01-27 00:19:05.009 INFO  com.example.wiki.job.DocJob                       :32   [32m274060625875963904[0;39m 更新电子书下的文档数据开始
2023-01-27 00:19:05.011 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274060625875963904[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:19:05.011 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274060625875963904[0;39m ==> Parameters: 
2023-01-27 00:19:05.015 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274060625875963904[0;39m <==    Updates: 1
2023-01-27 00:19:05.015 INFO  com.example.wiki.job.DocJob                       :35   [32m274060625875963904[0;39m 更新电子书下的文档数据结束，耗时：5毫秒
2023-01-27 00:19:35.008 INFO  com.example.wiki.job.DocJob                       :32   [32m274060751700889600[0;39m 更新电子书下的文档数据开始
2023-01-27 00:19:35.009 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274060751700889600[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:19:35.010 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274060751700889600[0;39m ==> Parameters: 
2023-01-27 00:19:35.013 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274060751700889600[0;39m <==    Updates: 1
2023-01-27 00:19:35.013 INFO  com.example.wiki.job.DocJob                       :35   [32m274060751700889600[0;39m 更新电子书下的文档数据结束，耗时：4毫秒
2023-01-27 00:19:37.291 WARN  c.e.wiki.controller.ControllerExceptionHandler    :29   [32m274052275863949312[0;39m 参数校验失败：Size cannot be larger than 1000
2023-01-27 00:19:37.294 WARN  o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver   :207  [32m274052275863949312[0;39m Resolved [org.springframework.validation.BindException: org.springframework.validation.BeanPropertyBindingResult: 1 errors
Field error in object 'ebookQueryReq' on field 'size': rejected value [1001]; codes [Max.ebookQueryReq.size,Max.size,Max.int,Max]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [ebookQueryReq.size,size]; arguments []; default message [size],1000]; default message [Size cannot be larger than 1000]]
2023-01-27 00:20:00.007 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274060856554295296[0;39m 生成今日电子书快照开始
2023-01-27 00:20:00.008 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274060856554295296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 00:20:00.009 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274060856554295296[0;39m ==> Parameters: 
2023-01-27 00:20:00.011 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274060856554295296[0;39m <==    Updates: 0
2023-01-27 00:20:00.012 INFO  com.example.wiki.job.EbookSnapshotJob             :35   [32m274060856554295296[0;39m 生成今日电子书快照结束，耗时：4毫秒
2023-01-27 00:20:04.961 WARN  c.e.wiki.controller.ControllerExceptionHandler    :29   [32m274058810992234496[0;39m 参数校验失败：Size cannot be larger than 1000
2023-01-27 00:20:04.964 WARN  o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver   :207  [32m274058810992234496[0;39m Resolved [org.springframework.validation.BindException: org.springframework.validation.BeanPropertyBindingResult: 1 errors
Field error in object 'ebookQueryReq' on field 'size': rejected value [1001]; codes [Max.ebookQueryReq.size,Max.size,Max.int,Max]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [ebookQueryReq.size,size]; arguments []; default message [size],1000]; default message [Size cannot be larger than 1000]]
2023-01-27 00:20:05.010 INFO  com.example.wiki.job.DocJob                       :32   [32m274060877538398208[0;39m 更新电子书下的文档数据开始
2023-01-27 00:20:05.010 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274060877538398208[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:20:05.011 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274060877538398208[0;39m ==> Parameters: 
2023-01-27 00:20:05.011 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274060877538398208[0;39m <==    Updates: 1
2023-01-27 00:20:05.012 INFO  com.example.wiki.job.DocJob                       :35   [32m274060877538398208[0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2023-01-27 00:20:35.004 INFO  com.example.wiki.job.DocJob                       :32   [32m274061003342352384[0;39m 更新电子书下的文档数据开始
2023-01-27 00:20:35.004 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274061003342352384[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:20:35.005 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274061003342352384[0;39m ==> Parameters: 
2023-01-27 00:20:35.006 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274061003342352384[0;39m <==    Updates: 1
2023-01-27 00:20:35.006 INFO  com.example.wiki.job.DocJob                       :35   [32m274061003342352384[0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2023-01-27 00:21:00.002 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274061108191563776[0;39m 生成今日电子书快照开始
2023-01-27 00:21:00.004 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274061108191563776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 00:21:00.005 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274061108191563776[0;39m ==> Parameters: 
2023-01-27 00:21:00.009 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274061108191563776[0;39m <==    Updates: 0
2023-01-27 00:21:00.010 INFO  com.example.wiki.job.EbookSnapshotJob             :35   [32m274061108191563776[0;39m 生成今日电子书快照结束，耗时：7毫秒
2023-01-27 00:21:05.005 INFO  com.example.wiki.job.DocJob                       :32   [32m274061129175666688[0;39m 更新电子书下的文档数据开始
2023-01-27 00:21:05.007 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274061129175666688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:21:05.007 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274061129175666688[0;39m ==> Parameters: 
2023-01-27 00:21:05.010 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274061129175666688[0;39m <==    Updates: 1
2023-01-27 00:21:05.011 INFO  com.example.wiki.job.DocJob                       :35   [32m274061129175666688[0;39m 更新电子书下的文档数据结束，耗时：5毫秒
2023-01-27 00:21:35.010 INFO  com.example.wiki.job.DocJob                       :32   [32m274061255025758208[0;39m 更新电子书下的文档数据开始
2023-01-27 00:21:35.012 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274061255025758208[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:21:35.014 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274061255025758208[0;39m ==> Parameters: 
2023-01-27 00:21:35.015 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274061255025758208[0;39m <==    Updates: 1
2023-01-27 00:21:35.017 INFO  com.example.wiki.job.DocJob                       :35   [32m274061255025758208[0;39m 更新电子书下的文档数据结束，耗时：7毫秒
2023-01-27 00:22:00.010 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274061359883358208[0;39m 生成今日电子书快照开始
2023-01-27 00:22:00.011 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274061359883358208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 00:22:00.012 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274061359883358208[0;39m ==> Parameters: 
2023-01-27 00:22:00.015 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274061359883358208[0;39m <==    Updates: 0
2023-01-27 00:22:00.018 INFO  com.example.wiki.job.EbookSnapshotJob             :35   [32m274061359883358208[0;39m 生成今日电子书快照结束，耗时：7毫秒
2023-01-27 00:22:05.004 INFO  com.example.wiki.job.DocJob                       :32   [32m274061380829712384[0;39m 更新电子书下的文档数据开始
2023-01-27 00:22:05.005 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274061380829712384[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:22:05.005 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274061380829712384[0;39m ==> Parameters: 
2023-01-27 00:22:05.006 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274061380829712384[0;39m <==    Updates: 1
2023-01-27 00:22:05.006 INFO  com.example.wiki.job.DocJob                       :35   [32m274061380829712384[0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2023-01-27 00:22:11.831 INFO  com.example.wiki.aspect.LogAspect                 :50   [32m274061409464225792[0;39m ------------- 开始 -------------
2023-01-27 00:22:11.832 INFO  com.example.wiki.aspect.LogAspect                 :51   [32m274061409464225792[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2023-01-27 00:22:11.832 INFO  com.example.wiki.aspect.LogAspect                 :52   [32m274061409464225792[0;39m 类名方法: com.example.wiki.controller.EbookController.list
2023-01-27 00:22:11.832 INFO  com.example.wiki.aspect.LogAspect                 :53   [32m274061409464225792[0;39m 远程地址: 127.0.0.1
2023-01-27 00:22:11.832 INFO  com.example.wiki.aspect.LogAspect                 :75   [32m274061409464225792[0;39m 请求参数: [{"page":1,"size":10}]
2023-01-27 00:22:11.833 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274061409464225792[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2023-01-27 00:22:11.834 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274061409464225792[0;39m ==> Parameters: 
2023-01-27 00:22:11.835 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274061409464225792[0;39m <==    Columns: count(0)
2023-01-27 00:22:11.836 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274061409464225792[0;39m <==        Row: 5
2023-01-27 00:22:11.836 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274061409464225792[0;39m <==      Total: 1
2023-01-27 00:22:11.836 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274061409464225792[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2023-01-27 00:22:11.836 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274061409464225792[0;39m ==> Parameters: 10(Integer)
2023-01-27 00:22:11.837 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274061409464225792[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2023-01-27 00:22:11.838 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274061409464225792[0;39m <==        Row: 1, Spring Boot 入门教程, null, null, 零基础入门 Java 开发，企业级应用开发最佳首选框架, null, 6, 0, 0
2023-01-27 00:22:11.838 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274061409464225792[0;39m <==        Row: 2, Vue 入门教程, null, null, 零基础入门 Vue 开发，企业级应用开发最佳首选框架, null, 0, 0, 0
2023-01-27 00:22:11.838 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274061409464225792[0;39m <==        Row: 3, Python 入门教程, null, null, 零基础入门 Python 开发，企业级应用开发最佳首选框架, null, 0, 0, 0
2023-01-27 00:22:11.838 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274061409464225792[0;39m <==        Row: 4, Mysql 入门教程, null, null, 零基础入门 Mysql 开发，企业级应用开发最佳首选框架, null, 0, 0, 0
2023-01-27 00:22:11.839 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274061409464225792[0;39m <==        Row: 5, Oracle 入门教程, null, null, 零基础入门 Oracle 开发，企业级应用开发最佳首选框架, null, 0, 0, 0
2023-01-27 00:22:11.839 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274061409464225792[0;39m <==      Total: 5
2023-01-27 00:22:11.839 INFO  com.example.wiki.service.EbookService             :51   [32m274061409464225792[0;39m 总行数 5
2023-01-27 00:22:11.839 INFO  com.example.wiki.service.EbookService             :52   [32m274061409464225792[0;39m 总页数 1
2023-01-27 00:22:11.840 INFO  com.example.wiki.aspect.LogAspect                 :87   [32m274061409464225792[0;39m 返回结果: {"content":{"list":[{"description":"零基础入门 Java 开发，企业级应用开发最佳首选框架","docCount":6,"id":1,"name":"Spring Boot 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Vue 开发，企业级应用开发最佳首选框架","docCount":0,"id":2,"name":"Vue 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Python 开发，企业级应用开发最佳首选框架","docCount":0,"id":3,"name":"Python 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Mysql 开发，企业级应用开发最佳首选框架","docCount":0,"id":4,"name":"Mysql 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Oracle 开发，企业级应用开发最佳首选框架","docCount":0,"id":5,"name":"Oracle 入门教程","viewCount":0,"voteCount":0}],"total":5},"success":true}
2023-01-27 00:22:11.840 INFO  com.example.wiki.aspect.LogAspect                 :88   [32m274061409464225792[0;39m ------------- 结束 耗时：9 ms -------------
2023-01-27 00:22:14.565 INFO  com.example.wiki.aspect.LogAspect                 :50   [32m274061420931452928[0;39m ------------- 开始 -------------
2023-01-27 00:22:14.565 INFO  com.example.wiki.aspect.LogAspect                 :51   [32m274061420931452928[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2023-01-27 00:22:14.566 INFO  com.example.wiki.aspect.LogAspect                 :52   [32m274061420931452928[0;39m 类名方法: com.example.wiki.controller.EbookController.list
2023-01-27 00:22:14.566 INFO  com.example.wiki.aspect.LogAspect                 :53   [32m274061420931452928[0;39m 远程地址: 127.0.0.1
2023-01-27 00:22:14.566 INFO  com.example.wiki.aspect.LogAspect                 :75   [32m274061420931452928[0;39m 请求参数: [{"page":1,"size":10}]
2023-01-27 00:22:14.567 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274061420931452928[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2023-01-27 00:22:14.567 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274061420931452928[0;39m ==> Parameters: 
2023-01-27 00:22:14.569 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274061420931452928[0;39m <==    Columns: count(0)
2023-01-27 00:22:14.569 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274061420931452928[0;39m <==        Row: 5
2023-01-27 00:22:14.569 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274061420931452928[0;39m <==      Total: 1
2023-01-27 00:22:14.570 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274061420931452928[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2023-01-27 00:22:14.570 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274061420931452928[0;39m ==> Parameters: 10(Integer)
2023-01-27 00:22:14.570 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274061420931452928[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2023-01-27 00:22:14.571 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274061420931452928[0;39m <==        Row: 1, Spring Boot 入门教程, null, null, 零基础入门 Java 开发，企业级应用开发最佳首选框架, null, 6, 0, 0
2023-01-27 00:22:14.571 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274061420931452928[0;39m <==        Row: 2, Vue 入门教程, null, null, 零基础入门 Vue 开发，企业级应用开发最佳首选框架, null, 0, 0, 0
2023-01-27 00:22:14.571 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274061420931452928[0;39m <==        Row: 3, Python 入门教程, null, null, 零基础入门 Python 开发，企业级应用开发最佳首选框架, null, 0, 0, 0
2023-01-27 00:22:14.572 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274061420931452928[0;39m <==        Row: 4, Mysql 入门教程, null, null, 零基础入门 Mysql 开发，企业级应用开发最佳首选框架, null, 0, 0, 0
2023-01-27 00:22:14.572 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274061420931452928[0;39m <==        Row: 5, Oracle 入门教程, null, null, 零基础入门 Oracle 开发，企业级应用开发最佳首选框架, null, 0, 0, 0
2023-01-27 00:22:14.572 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274061420931452928[0;39m <==      Total: 5
2023-01-27 00:22:14.573 INFO  com.example.wiki.service.EbookService             :51   [32m274061420931452928[0;39m 总行数 5
2023-01-27 00:22:14.573 INFO  com.example.wiki.service.EbookService             :52   [32m274061420931452928[0;39m 总页数 1
2023-01-27 00:22:14.573 INFO  com.example.wiki.aspect.LogAspect                 :87   [32m274061420931452928[0;39m 返回结果: {"content":{"list":[{"description":"零基础入门 Java 开发，企业级应用开发最佳首选框架","docCount":6,"id":1,"name":"Spring Boot 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Vue 开发，企业级应用开发最佳首选框架","docCount":0,"id":2,"name":"Vue 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Python 开发，企业级应用开发最佳首选框架","docCount":0,"id":3,"name":"Python 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Mysql 开发，企业级应用开发最佳首选框架","docCount":0,"id":4,"name":"Mysql 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Oracle 开发，企业级应用开发最佳首选框架","docCount":0,"id":5,"name":"Oracle 入门教程","viewCount":0,"voteCount":0}],"total":5},"success":true}
2023-01-27 00:22:14.573 INFO  com.example.wiki.aspect.LogAspect                 :88   [32m274061420931452928[0;39m ------------- 结束 耗时：8 ms -------------
2023-01-27 00:22:18.151 INFO  com.example.wiki.aspect.LogAspect                 :50   [32m274061435972227072[0;39m ------------- 开始 -------------
2023-01-27 00:22:18.151 INFO  com.example.wiki.aspect.LogAspect                 :51   [32m274061435972227072[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2023-01-27 00:22:18.151 INFO  com.example.wiki.aspect.LogAspect                 :52   [32m274061435972227072[0;39m 类名方法: com.example.wiki.controller.EbookController.list
2023-01-27 00:22:18.151 INFO  com.example.wiki.aspect.LogAspect                 :53   [32m274061435972227072[0;39m 远程地址: 127.0.0.1
2023-01-27 00:22:18.152 INFO  com.example.wiki.aspect.LogAspect                 :75   [32m274061435972227072[0;39m 请求参数: [{"page":1,"size":10}]
2023-01-27 00:22:18.153 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274061435972227072[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2023-01-27 00:22:18.153 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274061435972227072[0;39m ==> Parameters: 
2023-01-27 00:22:18.156 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274061435972227072[0;39m <==    Columns: count(0)
2023-01-27 00:22:18.158 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274061435972227072[0;39m <==        Row: 5
2023-01-27 00:22:18.158 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274061435972227072[0;39m <==      Total: 1
2023-01-27 00:22:18.158 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274061435972227072[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2023-01-27 00:22:18.159 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274061435972227072[0;39m ==> Parameters: 10(Integer)
2023-01-27 00:22:18.159 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274061435972227072[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2023-01-27 00:22:18.160 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274061435972227072[0;39m <==        Row: 1, Spring Boot 入门教程, null, null, 零基础入门 Java 开发，企业级应用开发最佳首选框架, null, 6, 0, 0
2023-01-27 00:22:18.160 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274061435972227072[0;39m <==        Row: 2, Vue 入门教程, null, null, 零基础入门 Vue 开发，企业级应用开发最佳首选框架, null, 0, 0, 0
2023-01-27 00:22:18.160 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274061435972227072[0;39m <==        Row: 3, Python 入门教程, null, null, 零基础入门 Python 开发，企业级应用开发最佳首选框架, null, 0, 0, 0
2023-01-27 00:22:18.160 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274061435972227072[0;39m <==        Row: 4, Mysql 入门教程, null, null, 零基础入门 Mysql 开发，企业级应用开发最佳首选框架, null, 0, 0, 0
2023-01-27 00:22:18.161 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274061435972227072[0;39m <==        Row: 5, Oracle 入门教程, null, null, 零基础入门 Oracle 开发，企业级应用开发最佳首选框架, null, 0, 0, 0
2023-01-27 00:22:18.161 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274061435972227072[0;39m <==      Total: 5
2023-01-27 00:22:18.161 INFO  com.example.wiki.service.EbookService             :51   [32m274061435972227072[0;39m 总行数 5
2023-01-27 00:22:18.161 INFO  com.example.wiki.service.EbookService             :52   [32m274061435972227072[0;39m 总页数 1
2023-01-27 00:22:18.162 INFO  com.example.wiki.aspect.LogAspect                 :87   [32m274061435972227072[0;39m 返回结果: {"content":{"list":[{"description":"零基础入门 Java 开发，企业级应用开发最佳首选框架","docCount":6,"id":1,"name":"Spring Boot 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Vue 开发，企业级应用开发最佳首选框架","docCount":0,"id":2,"name":"Vue 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Python 开发，企业级应用开发最佳首选框架","docCount":0,"id":3,"name":"Python 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Mysql 开发，企业级应用开发最佳首选框架","docCount":0,"id":4,"name":"Mysql 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Oracle 开发，企业级应用开发最佳首选框架","docCount":0,"id":5,"name":"Oracle 入门教程","viewCount":0,"voteCount":0}],"total":5},"success":true}
2023-01-27 00:22:18.162 INFO  com.example.wiki.aspect.LogAspect                 :88   [32m274061435972227072[0;39m ------------- 结束 耗时：11 ms -------------
2023-01-27 00:22:35.015 INFO  com.example.wiki.job.DocJob                       :32   [32m274061506704969728[0;39m 更新电子书下的文档数据开始
2023-01-27 00:22:35.016 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274061506704969728[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:22:35.016 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274061506704969728[0;39m ==> Parameters: 
2023-01-27 00:22:35.017 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274061506704969728[0;39m <==    Updates: 1
2023-01-27 00:22:35.017 INFO  com.example.wiki.job.DocJob                       :35   [32m274061506704969728[0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2023-01-27 00:23:00.014 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274061611558375424[0;39m 生成今日电子书快照开始
2023-01-27 00:23:00.015 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274061611558375424[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 00:23:00.016 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274061611558375424[0;39m ==> Parameters: 
2023-01-27 00:23:00.023 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274061611558375424[0;39m <==    Updates: 0
2023-01-27 00:23:00.025 INFO  com.example.wiki.job.EbookSnapshotJob             :35   [32m274061611558375424[0;39m 生成今日电子书快照结束，耗时：11毫秒
2023-01-27 00:23:05.007 INFO  com.example.wiki.job.DocJob                       :32   [32m274061632500535296[0;39m 更新电子书下的文档数据开始
2023-01-27 00:23:05.009 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274061632500535296[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:23:05.009 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274061632500535296[0;39m ==> Parameters: 
2023-01-27 00:23:05.012 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274061632500535296[0;39m <==    Updates: 1
2023-01-27 00:23:05.012 INFO  com.example.wiki.job.DocJob                       :35   [32m274061632500535296[0;39m 更新电子书下的文档数据结束，耗时：5毫秒
2023-01-27 00:23:35.004 INFO  com.example.wiki.job.DocJob                       :32   [32m274061758317072384[0;39m 更新电子书下的文档数据开始
2023-01-27 00:23:35.005 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274061758317072384[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:23:35.005 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274061758317072384[0;39m ==> Parameters: 
2023-01-27 00:23:35.008 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274061758317072384[0;39m <==    Updates: 1
2023-01-27 00:23:35.008 INFO  com.example.wiki.job.DocJob                       :35   [32m274061758317072384[0;39m 更新电子书下的文档数据结束，耗时：4毫秒
2023-01-27 00:24:00.012 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274061863208226816[0;39m 生成今日电子书快照开始
2023-01-27 00:24:00.013 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274061863208226816[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 00:24:00.013 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274061863208226816[0;39m ==> Parameters: 
2023-01-27 00:24:00.016 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274061863208226816[0;39m <==    Updates: 0
2023-01-27 00:24:00.018 INFO  com.example.wiki.job.EbookSnapshotJob             :35   [32m274061863208226816[0;39m 生成今日电子书快照结束，耗时：6毫秒
2023-01-27 00:24:05.001 INFO  com.example.wiki.job.DocJob                       :32   [32m274061884133609472[0;39m 更新电子书下的文档数据开始
2023-01-27 00:24:05.003 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274061884133609472[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:24:05.003 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274061884133609472[0;39m ==> Parameters: 
2023-01-27 00:24:05.006 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274061884133609472[0;39m <==    Updates: 1
2023-01-27 00:24:05.006 INFO  com.example.wiki.job.DocJob                       :35   [32m274061884133609472[0;39m 更新电子书下的文档数据结束，耗时：4毫秒
2023-01-27 00:24:35.003 INFO  com.example.wiki.job.DocJob                       :32   [32m274062009971118080[0;39m 更新电子书下的文档数据开始
2023-01-27 00:24:35.004 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274062009971118080[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:24:35.004 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274062009971118080[0;39m ==> Parameters: 
2023-01-27 00:24:35.006 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274062009971118080[0;39m <==    Updates: 1
2023-01-27 00:24:35.006 INFO  com.example.wiki.job.DocJob                       :35   [32m274062009971118080[0;39m 更新电子书下的文档数据结束，耗时：3毫秒
2023-01-27 00:25:00.010 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274062114858078208[0;39m 生成今日电子书快照开始
2023-01-27 00:25:00.012 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274062114858078208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 00:25:00.013 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274062114858078208[0;39m ==> Parameters: 
2023-01-27 00:25:00.016 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274062114858078208[0;39m <==    Updates: 0
2023-01-27 00:25:00.016 INFO  com.example.wiki.job.EbookSnapshotJob             :35   [32m274062114858078208[0;39m 生成今日电子书快照结束，耗时：5毫秒
2023-01-27 00:25:05.015 INFO  com.example.wiki.job.DocJob                       :32   [32m274062135850569728[0;39m 更新电子书下的文档数据开始
2023-01-27 00:25:05.016 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274062135850569728[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:25:05.016 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274062135850569728[0;39m ==> Parameters: 
2023-01-27 00:25:05.017 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274062135850569728[0;39m <==    Updates: 1
2023-01-27 00:25:05.017 INFO  com.example.wiki.job.DocJob                       :35   [32m274062135850569728[0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2023-01-27 00:25:31.992 INFO  com.example.wiki.aspect.LogAspect                 :50   [32m274062249000308736[0;39m ------------- 开始 -------------
2023-01-27 00:25:31.992 INFO  com.example.wiki.aspect.LogAspect                 :51   [32m274062249000308736[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2023-01-27 00:25:31.992 INFO  com.example.wiki.aspect.LogAspect                 :52   [32m274062249000308736[0;39m 类名方法: com.example.wiki.controller.EbookController.list
2023-01-27 00:25:31.993 INFO  com.example.wiki.aspect.LogAspect                 :53   [32m274062249000308736[0;39m 远程地址: 127.0.0.1
2023-01-27 00:25:31.993 INFO  com.example.wiki.aspect.LogAspect                 :75   [32m274062249000308736[0;39m 请求参数: [{"page":1,"size":10}]
2023-01-27 00:25:31.994 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274062249000308736[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2023-01-27 00:25:31.995 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274062249000308736[0;39m ==> Parameters: 
2023-01-27 00:25:31.997 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274062249000308736[0;39m <==    Columns: count(0)
2023-01-27 00:25:31.997 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274062249000308736[0;39m <==        Row: 5
2023-01-27 00:25:31.997 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274062249000308736[0;39m <==      Total: 1
2023-01-27 00:25:31.998 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274062249000308736[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2023-01-27 00:25:31.998 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274062249000308736[0;39m ==> Parameters: 10(Integer)
2023-01-27 00:25:31.999 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274062249000308736[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2023-01-27 00:25:31.999 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274062249000308736[0;39m <==        Row: 1, Spring Boot 入门教程, null, null, 零基础入门 Java 开发，企业级应用开发最佳首选框架, null, 6, 0, 0
2023-01-27 00:25:31.999 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274062249000308736[0;39m <==        Row: 2, Vue 入门教程, null, null, 零基础入门 Vue 开发，企业级应用开发最佳首选框架, null, 0, 0, 0
2023-01-27 00:25:31.999 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274062249000308736[0;39m <==        Row: 3, Python 入门教程, null, null, 零基础入门 Python 开发，企业级应用开发最佳首选框架, null, 0, 0, 0
2023-01-27 00:25:32.000 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274062249000308736[0;39m <==        Row: 4, Mysql 入门教程, null, null, 零基础入门 Mysql 开发，企业级应用开发最佳首选框架, null, 0, 0, 0
2023-01-27 00:25:32.000 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274062249000308736[0;39m <==        Row: 5, Oracle 入门教程, null, null, 零基础入门 Oracle 开发，企业级应用开发最佳首选框架, null, 0, 0, 0
2023-01-27 00:25:32.000 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274062249000308736[0;39m <==      Total: 5
2023-01-27 00:25:32.000 INFO  com.example.wiki.service.EbookService             :51   [32m274062249000308736[0;39m 总行数 5
2023-01-27 00:25:32.000 INFO  com.example.wiki.service.EbookService             :52   [32m274062249000308736[0;39m 总页数 1
2023-01-27 00:25:32.001 INFO  com.example.wiki.aspect.LogAspect                 :87   [32m274062249000308736[0;39m 返回结果: {"content":{"list":[{"description":"零基础入门 Java 开发，企业级应用开发最佳首选框架","docCount":6,"id":1,"name":"Spring Boot 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Vue 开发，企业级应用开发最佳首选框架","docCount":0,"id":2,"name":"Vue 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Python 开发，企业级应用开发最佳首选框架","docCount":0,"id":3,"name":"Python 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Mysql 开发，企业级应用开发最佳首选框架","docCount":0,"id":4,"name":"Mysql 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Oracle 开发，企业级应用开发最佳首选框架","docCount":0,"id":5,"name":"Oracle 入门教程","viewCount":0,"voteCount":0}],"total":5},"success":true}
2023-01-27 00:25:32.001 INFO  com.example.wiki.aspect.LogAspect                 :88   [32m274062249000308736[0;39m ------------- 结束 耗时：9 ms -------------
2023-01-27 00:25:35.002 INFO  com.example.wiki.job.DocJob                       :32   [32m274062261625163776[0;39m 更新电子书下的文档数据开始
2023-01-27 00:25:35.004 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274062261625163776[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:25:35.004 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274062261625163776[0;39m ==> Parameters: 
2023-01-27 00:25:35.007 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274062261625163776[0;39m <==    Updates: 1
2023-01-27 00:25:35.007 INFO  com.example.wiki.job.DocJob                       :35   [32m274062261625163776[0;39m 更新电子书下的文档数据结束，耗时：4毫秒
2023-01-27 00:26:00.010 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274062366516318208[0;39m 生成今日电子书快照开始
2023-01-27 00:26:00.011 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274062366516318208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 00:26:00.012 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274062366516318208[0;39m ==> Parameters: 
2023-01-27 00:26:00.013 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274062366516318208[0;39m <==    Updates: 0
2023-01-27 00:26:00.013 INFO  com.example.wiki.job.EbookSnapshotJob             :35   [32m274062366516318208[0;39m 生成今日电子书快照结束，耗时：3毫秒
2023-01-27 00:26:05.013 INFO  com.example.wiki.job.DocJob                       :32   [32m274062387500421120[0;39m 更新电子书下的文档数据开始
2023-01-27 00:26:05.015 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274062387500421120[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:26:05.016 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274062387500421120[0;39m ==> Parameters: 
2023-01-27 00:26:05.018 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274062387500421120[0;39m <==    Updates: 1
2023-01-27 00:26:05.018 INFO  com.example.wiki.job.DocJob                       :35   [32m274062387500421120[0;39m 更新电子书下的文档数据结束，耗时：4毫秒
2023-01-27 00:26:35.015 INFO  com.example.wiki.job.DocJob                       :32   [32m274062513337929728[0;39m 更新电子书下的文档数据开始
2023-01-27 00:26:35.016 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274062513337929728[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:26:35.016 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274062513337929728[0;39m ==> Parameters: 
2023-01-27 00:26:35.017 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274062513337929728[0;39m <==    Updates: 1
2023-01-27 00:26:35.017 INFO  com.example.wiki.job.DocJob                       :35   [32m274062513337929728[0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2023-01-27 00:27:00.004 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274062618149392384[0;39m 生成今日电子书快照开始
2023-01-27 00:27:00.005 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274062618149392384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 00:27:00.005 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274062618149392384[0;39m ==> Parameters: 
2023-01-27 00:27:00.008 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274062618149392384[0;39m <==    Updates: 0
2023-01-27 00:27:00.009 INFO  com.example.wiki.job.EbookSnapshotJob             :35   [32m274062618149392384[0;39m 生成今日电子书快照结束，耗时：5毫秒
2023-01-27 00:27:05.011 INFO  com.example.wiki.job.DocJob                       :32   [32m274062639150272512[0;39m 更新电子书下的文档数据开始
2023-01-27 00:27:05.012 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274062639150272512[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:27:05.012 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274062639150272512[0;39m ==> Parameters: 
2023-01-27 00:27:05.013 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274062639150272512[0;39m <==    Updates: 1
2023-01-27 00:27:05.014 INFO  com.example.wiki.job.DocJob                       :35   [32m274062639150272512[0;39m 更新电子书下的文档数据结束，耗时：3毫秒
2023-01-27 00:27:07.166 INFO  com.example.wiki.aspect.LogAspect                 :50   [32m274062648188997632[0;39m ------------- 开始 -------------
2023-01-27 00:27:07.168 INFO  com.example.wiki.aspect.LogAspect                 :51   [32m274062648188997632[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2023-01-27 00:27:07.168 INFO  com.example.wiki.aspect.LogAspect                 :52   [32m274062648188997632[0;39m 类名方法: com.example.wiki.controller.EbookController.list
2023-01-27 00:27:07.169 INFO  com.example.wiki.aspect.LogAspect                 :53   [32m274062648188997632[0;39m 远程地址: 127.0.0.1
2023-01-27 00:27:07.169 INFO  com.example.wiki.aspect.LogAspect                 :75   [32m274062648188997632[0;39m 请求参数: [{"page":1,"size":10}]
2023-01-27 00:27:07.170 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274062648188997632[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2023-01-27 00:27:07.170 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274062648188997632[0;39m ==> Parameters: 
2023-01-27 00:27:07.172 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274062648188997632[0;39m <==    Columns: count(0)
2023-01-27 00:27:07.172 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274062648188997632[0;39m <==        Row: 5
2023-01-27 00:27:07.172 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274062648188997632[0;39m <==      Total: 1
2023-01-27 00:27:07.174 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274062648188997632[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2023-01-27 00:27:07.174 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274062648188997632[0;39m ==> Parameters: 10(Integer)
2023-01-27 00:27:07.175 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274062648188997632[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2023-01-27 00:27:07.175 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274062648188997632[0;39m <==        Row: 1, Spring Boot 入门教程, null, null, 零基础入门 Java 开发，企业级应用开发最佳首选框架, null, 6, 0, 0
2023-01-27 00:27:07.176 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274062648188997632[0;39m <==        Row: 2, Vue 入门教程, null, null, 零基础入门 Vue 开发，企业级应用开发最佳首选框架, null, 0, 0, 0
2023-01-27 00:27:07.176 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274062648188997632[0;39m <==        Row: 3, Python 入门教程, null, null, 零基础入门 Python 开发，企业级应用开发最佳首选框架, null, 0, 0, 0
2023-01-27 00:27:07.176 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274062648188997632[0;39m <==        Row: 4, Mysql 入门教程, null, null, 零基础入门 Mysql 开发，企业级应用开发最佳首选框架, null, 0, 0, 0
2023-01-27 00:27:07.176 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274062648188997632[0;39m <==        Row: 5, Oracle 入门教程, null, null, 零基础入门 Oracle 开发，企业级应用开发最佳首选框架, null, 0, 0, 0
2023-01-27 00:27:07.176 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274062648188997632[0;39m <==      Total: 5
2023-01-27 00:27:07.176 INFO  com.example.wiki.service.EbookService             :51   [32m274062648188997632[0;39m 总行数 5
2023-01-27 00:27:07.177 INFO  com.example.wiki.service.EbookService             :52   [32m274062648188997632[0;39m 总页数 1
2023-01-27 00:27:07.177 INFO  com.example.wiki.aspect.LogAspect                 :87   [32m274062648188997632[0;39m 返回结果: {"content":{"list":[{"description":"零基础入门 Java 开发，企业级应用开发最佳首选框架","docCount":6,"id":1,"name":"Spring Boot 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Vue 开发，企业级应用开发最佳首选框架","docCount":0,"id":2,"name":"Vue 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Python 开发，企业级应用开发最佳首选框架","docCount":0,"id":3,"name":"Python 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Mysql 开发，企业级应用开发最佳首选框架","docCount":0,"id":4,"name":"Mysql 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Oracle 开发，企业级应用开发最佳首选框架","docCount":0,"id":5,"name":"Oracle 入门教程","viewCount":0,"voteCount":0}],"total":5},"success":true}
2023-01-27 00:27:07.177 INFO  com.example.wiki.aspect.LogAspect                 :88   [32m274062648188997632[0;39m ------------- 结束 耗时：11 ms -------------
2023-01-27 00:27:35.009 INFO  com.example.wiki.job.DocJob                       :32   [32m274062764971003904[0;39m 更新电子书下的文档数据开始
2023-01-27 00:27:35.010 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274062764971003904[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:27:35.011 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274062764971003904[0;39m ==> Parameters: 
2023-01-27 00:27:35.014 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274062764971003904[0;39m <==    Updates: 1
2023-01-27 00:27:35.014 INFO  com.example.wiki.job.DocJob                       :35   [32m274062764971003904[0;39m 更新电子书下的文档数据结束，耗时：5毫秒
2023-01-27 00:28:00.001 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274062869795049472[0;39m 生成今日电子书快照开始
2023-01-27 00:28:00.003 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274062869795049472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 00:28:00.004 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274062869795049472[0;39m ==> Parameters: 
2023-01-27 00:28:00.007 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274062869795049472[0;39m <==    Updates: 0
2023-01-27 00:28:00.007 INFO  com.example.wiki.job.EbookSnapshotJob             :35   [32m274062869795049472[0;39m 生成今日电子书快照结束，耗时：5毫秒
2023-01-27 00:28:05.003 INFO  com.example.wiki.job.DocJob                       :32   [32m274062890774958080[0;39m 更新电子书下的文档数据开始
2023-01-27 00:28:05.004 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274062890774958080[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:28:05.005 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274062890774958080[0;39m ==> Parameters: 
2023-01-27 00:28:05.007 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274062890774958080[0;39m <==    Updates: 1
2023-01-27 00:28:05.008 INFO  com.example.wiki.job.DocJob                       :35   [32m274062890774958080[0;39m 更新电子书下的文档数据结束，耗时：5毫秒
2023-01-27 00:28:35.003 INFO  com.example.wiki.job.DocJob                       :32   [32m274063016604078080[0;39m 更新电子书下的文档数据开始
2023-01-27 00:28:35.003 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274063016604078080[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 00:28:35.004 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274063016604078080[0;39m ==> Parameters: 
2023-01-27 00:28:35.005 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274063016604078080[0;39m <==    Updates: 1
2023-01-27 00:28:35.005 INFO  com.example.wiki.job.DocJob                       :35   [32m274063016604078080[0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2023-01-27 00:28:46.595 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :218  [32m                  [0;39m Shutting down ExecutorService 'taskScheduler'
2023-01-27 00:28:46.600 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :218  [32m                  [0;39m Shutting down ExecutorService 'applicationTaskExecutor'
2023-01-27 00:28:46.603 INFO  com.zaxxer.hikari.HikariDataSource                :350  [32m                  [0;39m HikariPool-1 - Shutdown initiated...
2023-01-27 00:28:46.612 INFO  com.zaxxer.hikari.HikariDataSource                :352  [32m                  [0;39m HikariPool-1 - Shutdown completed.
2023-01-27 20:36:48.034 INFO  org.hibernate.validator.internal.util.Version     :21   [32m                  [0;39m HV000001: Hibernate Validator 6.1.6.Final
2023-01-27 20:36:48.047 INFO  com.example.wiki.config.WikiApplication           :55   [32m                  [0;39m Starting WikiApplication using Java 1.8.0_352 on Noland with PID 5936 (C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes started by amper in C:\Users\amper\project\Wiki\Knowledge-Based-System)
2023-01-27 20:36:48.048 INFO  com.example.wiki.config.WikiApplication           :660  [32m                  [0;39m No active profile set, falling back to default profiles: default
2023-01-27 20:36:48.124 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2023-01-27 20:36:48.124 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2023-01-27 20:36:49.040 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :250  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2023-01-27 20:36:49.044 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :128  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2023-01-27 20:36:49.072 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :188  [32m                  [0;39m Finished Spring Data repository scanning in 7 ms. Found 0 Redis repository interfaces.
2023-01-27 20:36:50.020 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8080 (http)
2023-01-27 20:36:50.031 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8080"]
2023-01-27 20:36:50.033 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2023-01-27 20:36:50.033 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.39]
2023-01-27 20:36:50.362 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2023-01-27 20:36:50.363 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :289  [32m                  [0;39m Root WebApplicationContext: initialization completed in 2238 ms
2023-01-27 20:36:51.239 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :181  [32m                  [0;39m Initializing ExecutorService 'applicationTaskExecutor'
2023-01-27 20:36:51.588 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :181  [32m                  [0;39m Initializing ExecutorService 'taskScheduler'
2023-01-27 20:36:51.637 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2023-01-27 20:36:51.658 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Starting ProtocolHandler ["http-nio-8080"]
2023-01-27 20:36:51.673 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8080 (http) with context path ''
2023-01-27 20:36:51.686 INFO  com.example.wiki.config.WikiApplication           :61   [32m                  [0;39m Started WikiApplication in 4.32 seconds (JVM running for 5.69)
2023-01-27 20:36:51.689 INFO  com.example.wiki.config.WikiApplication           :24   [32m                  [0;39m Start successfully!
2023-01-27 20:36:51.689 INFO  com.example.wiki.config.WikiApplication           :25   [32m                  [0;39m Address: 	http://127.0.0.1:8080
2023-01-27 20:37:00.012 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274367124653346816[0;39m 生成今日电子书快照开始
2023-01-27 20:37:00.060 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m274367124653346816[0;39m HikariPool-1 - Starting...
2023-01-27 20:37:00.483 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m274367124653346816[0;39m HikariPool-1 - Start completed.
2023-01-27 20:37:00.492 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274367124653346816[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 20:37:00.515 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274367124653346816[0;39m ==> Parameters: 
2023-01-27 20:37:00.565 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274367124653346816[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 22 common frames omitted
2023-01-27 20:37:05.010 INFO  com.example.wiki.job.DocJob                       :32   [32m274367145616478208[0;39m 更新电子书下的文档数据开始
2023-01-27 20:37:05.015 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274367145616478208[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 20:37:05.016 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274367145616478208[0;39m ==> Parameters: 
2023-01-27 20:37:05.030 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274367145616478208[0;39m <==    Updates: 1
2023-01-27 20:37:05.031 INFO  com.example.wiki.job.DocJob                       :35   [32m274367145616478208[0;39m 更新电子书下的文档数据结束，耗时：20毫秒
2023-01-27 20:37:35.013 INFO  com.example.wiki.job.DocJob                       :32   [32m274367271458181120[0;39m 更新电子书下的文档数据开始
2023-01-27 20:37:35.015 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274367271458181120[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 20:37:35.016 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274367271458181120[0;39m ==> Parameters: 
2023-01-27 20:37:35.019 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274367271458181120[0;39m <==    Updates: 1
2023-01-27 20:37:35.020 INFO  com.example.wiki.job.DocJob                       :35   [32m274367271458181120[0;39m 更新电子书下的文档数据结束，耗时：6毫秒
2023-01-27 20:38:00.011 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274367376307392512[0;39m 生成今日电子书快照开始
2023-01-27 20:38:00.012 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274367376307392512[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 20:38:00.014 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274367376307392512[0;39m ==> Parameters: 
2023-01-27 20:38:00.016 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274367376307392512[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 22 common frames omitted
2023-01-27 20:38:05.014 INFO  com.example.wiki.job.DocJob                       :32   [32m274367397291495424[0;39m 更新电子书下的文档数据开始
2023-01-27 20:38:05.015 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274367397291495424[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 20:38:05.016 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274367397291495424[0;39m ==> Parameters: 
2023-01-27 20:38:05.017 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274367397291495424[0;39m <==    Updates: 1
2023-01-27 20:38:05.018 INFO  com.example.wiki.job.DocJob                       :35   [32m274367397291495424[0;39m 更新电子书下的文档数据结束，耗时：4毫秒
2023-01-27 20:38:35.008 INFO  com.example.wiki.job.DocJob                       :32   [32m274367523095449600[0;39m 更新电子书下的文档数据开始
2023-01-27 20:38:35.009 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274367523095449600[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 20:38:35.010 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274367523095449600[0;39m ==> Parameters: 
2023-01-27 20:38:35.011 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274367523095449600[0;39m <==    Updates: 1
2023-01-27 20:38:35.012 INFO  com.example.wiki.job.DocJob                       :35   [32m274367523095449600[0;39m 更新电子书下的文档数据结束，耗时：4毫秒
2023-01-27 20:39:00.004 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274367627936272384[0;39m 生成今日电子书快照开始
2023-01-27 20:39:00.006 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274367627936272384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 20:39:00.007 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274367627936272384[0;39m ==> Parameters: 
2023-01-27 20:39:00.014 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274367627936272384[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 22 common frames omitted
2023-01-27 20:39:05.011 INFO  com.example.wiki.job.DocJob                       :32   [32m274367648937152512[0;39m 更新电子书下的文档数据开始
2023-01-27 20:39:05.013 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274367648937152512[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 20:39:05.015 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274367648937152512[0;39m ==> Parameters: 
2023-01-27 20:39:05.018 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274367648937152512[0;39m <==    Updates: 1
2023-01-27 20:39:05.019 INFO  com.example.wiki.job.DocJob                       :35   [32m274367648937152512[0;39m 更新电子书下的文档数据结束，耗时：7毫秒
2023-01-27 20:39:35.007 INFO  com.example.wiki.job.DocJob                       :32   [32m274367774749495296[0;39m 更新电子书下的文档数据开始
2023-01-27 20:39:35.008 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274367774749495296[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 20:39:35.008 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274367774749495296[0;39m ==> Parameters: 
2023-01-27 20:39:35.009 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274367774749495296[0;39m <==    Updates: 1
2023-01-27 20:39:35.009 INFO  com.example.wiki.job.DocJob                       :35   [32m274367774749495296[0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2023-01-27 20:40:00.011 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274367879623872512[0;39m 生成今日电子书快照开始
2023-01-27 20:40:00.012 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274367879623872512[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 20:40:00.013 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274367879623872512[0;39m ==> Parameters: 
2023-01-27 20:40:00.018 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274367879623872512[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 22 common frames omitted
2023-01-27 20:40:05.016 INFO  com.example.wiki.job.DocJob                       :32   [32m274367900616364032[0;39m 更新电子书下的文档数据开始
2023-01-27 20:40:05.019 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274367900616364032[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 20:40:05.020 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274367900616364032[0;39m ==> Parameters: 
2023-01-27 20:40:05.022 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274367900616364032[0;39m <==    Updates: 1
2023-01-27 20:40:05.023 INFO  com.example.wiki.job.DocJob                       :35   [32m274367900616364032[0;39m 更新电子书下的文档数据结束，耗时：6毫秒
2023-01-27 20:40:35.001 INFO  com.example.wiki.job.DocJob                       :32   [32m274368026382569472[0;39m 更新电子书下的文档数据开始
2023-01-27 20:40:35.002 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274368026382569472[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 20:40:35.003 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274368026382569472[0;39m ==> Parameters: 
2023-01-27 20:40:35.004 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274368026382569472[0;39m <==    Updates: 1
2023-01-27 20:40:35.005 INFO  com.example.wiki.job.DocJob                       :35   [32m274368026382569472[0;39m 更新电子书下的文档数据结束，耗时：4毫秒
2023-01-27 20:41:00.015 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274368131298889728[0;39m 生成今日电子书快照开始
2023-01-27 20:41:00.017 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274368131298889728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 20:41:00.018 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274368131298889728[0;39m ==> Parameters: 
2023-01-27 20:41:00.021 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274368131298889728[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 22 common frames omitted
2023-01-27 20:41:05.010 INFO  com.example.wiki.job.DocJob                       :32   [32m274368152249438208[0;39m 更新电子书下的文档数据开始
2023-01-27 20:41:05.011 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274368152249438208[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 20:41:05.011 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274368152249438208[0;39m ==> Parameters: 
2023-01-27 20:41:05.012 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274368152249438208[0;39m <==    Updates: 1
2023-01-27 20:41:05.013 INFO  com.example.wiki.job.DocJob                       :35   [32m274368152249438208[0;39m 更新电子书下的文档数据结束，耗时：3毫秒
2023-01-27 20:41:22.606 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring DispatcherServlet 'dispatcherServlet'
2023-01-27 20:41:22.606 INFO  org.springframework.web.servlet.DispatcherServlet :525  [32m                  [0;39m Initializing Servlet 'dispatcherServlet'
2023-01-27 20:41:22.608 INFO  org.springframework.web.servlet.DispatcherServlet :547  [32m                  [0;39m Completed initialization in 2 ms
2023-01-27 20:41:22.692 INFO  com.example.wiki.aspect.LogAspect                 :50   [32m274368226408927232[0;39m ------------- 开始 -------------
2023-01-27 20:41:22.693 INFO  com.example.wiki.aspect.LogAspect                 :51   [32m274368226408927232[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2023-01-27 20:41:22.693 INFO  com.example.wiki.aspect.LogAspect                 :52   [32m274368226408927232[0;39m 类名方法: com.example.wiki.controller.EbookController.list
2023-01-27 20:41:22.693 INFO  com.example.wiki.aspect.LogAspect                 :53   [32m274368226408927232[0;39m 远程地址: 127.0.0.1
2023-01-27 20:41:22.764 INFO  com.example.wiki.aspect.LogAspect                 :75   [32m274368226408927232[0;39m 请求参数: [{"page":0,"size":0}]
2023-01-27 20:41:22.815 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274368226408927232[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2023-01-27 20:41:22.815 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274368226408927232[0;39m ==> Parameters: 
2023-01-27 20:41:22.832 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274368226408927232[0;39m <==    Columns: count(0)
2023-01-27 20:41:22.832 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274368226408927232[0;39m <==        Row: 5
2023-01-27 20:41:22.834 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274368226408927232[0;39m <==      Total: 1
2023-01-27 20:41:22.836 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274368226408927232[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook
2023-01-27 20:41:22.836 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274368226408927232[0;39m ==> Parameters: 
2023-01-27 20:41:22.838 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274368226408927232[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2023-01-27 20:41:22.838 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274368226408927232[0;39m <==        Row: 1, Spring Boot 入门教程, null, null, 零基础入门 Java 开发，企业级应用开发最佳首选框架, null, 6, 0, 0
2023-01-27 20:41:22.839 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274368226408927232[0;39m <==        Row: 2, Vue 入门教程, null, null, 零基础入门 Vue 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 20:41:22.839 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274368226408927232[0;39m <==        Row: 3, Python 入门教程, null, null, 零基础入门 Python 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 20:41:22.839 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274368226408927232[0;39m <==        Row: 4, Mysql 入门教程, null, null, 零基础入门 Mysql 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 20:41:22.840 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274368226408927232[0;39m <==        Row: 5, Oracle 入门教程, null, null, 零基础入门 Oracle 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 20:41:22.840 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274368226408927232[0;39m <==      Total: 5
2023-01-27 20:41:22.841 INFO  com.example.wiki.service.EbookService             :51   [32m274368226408927232[0;39m 总行数 5
2023-01-27 20:41:22.841 INFO  com.example.wiki.service.EbookService             :52   [32m274368226408927232[0;39m 总页数 0
2023-01-27 20:41:22.850 INFO  com.example.wiki.aspect.LogAspect                 :87   [32m274368226408927232[0;39m 返回结果: {"content":{"list":[{"description":"零基础入门 Java 开发，企业级应用开发最佳首选框架","docCount":6,"id":1,"name":"Spring Boot 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Vue 开发，企业级应用开发最佳首选框架","id":2,"name":"Vue 入门教程"},{"description":"零基础入门 Python 开发，企业级应用开发最佳首选框架","id":3,"name":"Python 入门教程"},{"description":"零基础入门 Mysql 开发，企业级应用开发最佳首选框架","id":4,"name":"Mysql 入门教程"},{"description":"零基础入门 Oracle 开发，企业级应用开发最佳首选框架","id":5,"name":"Oracle 入门教程"}],"total":5},"success":true}
2023-01-27 20:41:22.851 INFO  com.example.wiki.aspect.LogAspect                 :88   [32m274368226408927232[0;39m ------------- 结束 耗时：161 ms -------------
2023-01-27 20:41:23.265 INFO  com.example.wiki.interceptor.LoginInterceptor     :29   [32m                  [0;39m ------------- LoginInterceptor 开始 -------------
2023-01-27 20:41:23.265 INFO  com.example.wiki.interceptor.LoginInterceptor     :40   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/favicon.ico
2023-01-27 20:41:23.265 INFO  com.example.wiki.interceptor.LoginInterceptor     :44   [32m                  [0;39m 登录校验开始，token：null
2023-01-27 20:41:23.265 INFO  com.example.wiki.interceptor.LoginInterceptor     :46   [32m                  [0;39m token为空，请求被拦截
2023-01-27 20:41:23.292 INFO  com.example.wiki.interceptor.LoginInterceptor     :29   [32m                  [0;39m ------------- LoginInterceptor 开始 -------------
2023-01-27 20:41:23.293 INFO  com.example.wiki.interceptor.LoginInterceptor     :40   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/favicon.ico
2023-01-27 20:41:23.293 INFO  com.example.wiki.interceptor.LoginInterceptor     :44   [32m                  [0;39m 登录校验开始，token：null
2023-01-27 20:41:23.293 INFO  com.example.wiki.interceptor.LoginInterceptor     :46   [32m                  [0;39m token为空，请求被拦截
2023-01-27 20:41:34.893 INFO  com.example.wiki.aspect.LogAspect                 :50   [32m274368277587824640[0;39m ------------- 开始 -------------
2023-01-27 20:41:34.893 INFO  com.example.wiki.aspect.LogAspect                 :51   [32m274368277587824640[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2023-01-27 20:41:34.894 INFO  com.example.wiki.aspect.LogAspect                 :52   [32m274368277587824640[0;39m 类名方法: com.example.wiki.controller.EbookController.list
2023-01-27 20:41:34.894 INFO  com.example.wiki.aspect.LogAspect                 :53   [32m274368277587824640[0;39m 远程地址: 127.0.0.1
2023-01-27 20:41:34.894 INFO  com.example.wiki.aspect.LogAspect                 :75   [32m274368277587824640[0;39m 请求参数: [{"page":1,"size":1000}]
2023-01-27 20:41:34.900 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274368277587824640[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2023-01-27 20:41:34.900 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274368277587824640[0;39m ==> Parameters: 
2023-01-27 20:41:34.903 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274368277587824640[0;39m <==    Columns: count(0)
2023-01-27 20:41:34.904 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274368277587824640[0;39m <==        Row: 5
2023-01-27 20:41:34.904 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274368277587824640[0;39m <==      Total: 1
2023-01-27 20:41:34.907 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274368277587824640[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2023-01-27 20:41:34.908 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274368277587824640[0;39m ==> Parameters: 1000(Integer)
2023-01-27 20:41:34.910 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274368277587824640[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2023-01-27 20:41:34.911 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274368277587824640[0;39m <==        Row: 1, Spring Boot 入门教程, null, null, 零基础入门 Java 开发，企业级应用开发最佳首选框架, null, 6, 0, 0
2023-01-27 20:41:34.912 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274368277587824640[0;39m <==        Row: 2, Vue 入门教程, null, null, 零基础入门 Vue 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 20:41:34.913 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274368277587824640[0;39m <==        Row: 3, Python 入门教程, null, null, 零基础入门 Python 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 20:41:34.913 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274368277587824640[0;39m <==        Row: 4, Mysql 入门教程, null, null, 零基础入门 Mysql 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 20:41:34.914 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274368277587824640[0;39m <==        Row: 5, Oracle 入门教程, null, null, 零基础入门 Oracle 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 20:41:34.915 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274368277587824640[0;39m <==      Total: 5
2023-01-27 20:41:34.915 INFO  com.example.wiki.service.EbookService             :51   [32m274368277587824640[0;39m 总行数 5
2023-01-27 20:41:34.915 INFO  com.example.wiki.service.EbookService             :52   [32m274368277587824640[0;39m 总页数 1
2023-01-27 20:41:34.916 INFO  com.example.wiki.aspect.LogAspect                 :87   [32m274368277587824640[0;39m 返回结果: {"content":{"list":[{"description":"零基础入门 Java 开发，企业级应用开发最佳首选框架","docCount":6,"id":1,"name":"Spring Boot 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Vue 开发，企业级应用开发最佳首选框架","id":2,"name":"Vue 入门教程"},{"description":"零基础入门 Python 开发，企业级应用开发最佳首选框架","id":3,"name":"Python 入门教程"},{"description":"零基础入门 Mysql 开发，企业级应用开发最佳首选框架","id":4,"name":"Mysql 入门教程"},{"description":"零基础入门 Oracle 开发，企业级应用开发最佳首选框架","id":5,"name":"Oracle 入门教程"}],"total":5},"success":true}
2023-01-27 20:41:34.916 INFO  com.example.wiki.aspect.LogAspect                 :88   [32m274368277587824640[0;39m ------------- 结束 耗时：23 ms -------------
2023-01-27 20:41:35.007 INFO  com.example.wiki.job.DocJob                       :32   [32m274368278065975296[0;39m 更新电子书下的文档数据开始
2023-01-27 20:41:35.008 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274368278065975296[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 20:41:35.008 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274368278065975296[0;39m ==> Parameters: 
2023-01-27 20:41:35.010 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274368278065975296[0;39m <==    Updates: 1
2023-01-27 20:41:35.010 INFO  com.example.wiki.job.DocJob                       :35   [32m274368278065975296[0;39m 更新电子书下的文档数据结束，耗时：3毫秒
2023-01-27 20:41:43.462 INFO  com.example.wiki.aspect.LogAspect                 :50   [32m274368313528815616[0;39m ------------- 开始 -------------
2023-01-27 20:41:43.463 INFO  com.example.wiki.aspect.LogAspect                 :51   [32m274368313528815616[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2023-01-27 20:41:43.463 INFO  com.example.wiki.aspect.LogAspect                 :52   [32m274368313528815616[0;39m 类名方法: com.example.wiki.controller.EbookController.list
2023-01-27 20:41:43.463 INFO  com.example.wiki.aspect.LogAspect                 :53   [32m274368313528815616[0;39m 远程地址: 127.0.0.1
2023-01-27 20:41:43.463 INFO  com.example.wiki.aspect.LogAspect                 :75   [32m274368313528815616[0;39m 请求参数: [{"page":1,"size":10}]
2023-01-27 20:41:43.465 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274368313528815616[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2023-01-27 20:41:43.465 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274368313528815616[0;39m ==> Parameters: 
2023-01-27 20:41:43.468 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274368313528815616[0;39m <==    Columns: count(0)
2023-01-27 20:41:43.468 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274368313528815616[0;39m <==        Row: 5
2023-01-27 20:41:43.468 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274368313528815616[0;39m <==      Total: 1
2023-01-27 20:41:43.469 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274368313528815616[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2023-01-27 20:41:43.470 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274368313528815616[0;39m ==> Parameters: 10(Integer)
2023-01-27 20:41:43.471 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274368313528815616[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2023-01-27 20:41:43.471 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274368313528815616[0;39m <==        Row: 1, Spring Boot 入门教程, null, null, 零基础入门 Java 开发，企业级应用开发最佳首选框架, null, 6, 0, 0
2023-01-27 20:41:43.471 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274368313528815616[0;39m <==        Row: 2, Vue 入门教程, null, null, 零基础入门 Vue 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 20:41:43.472 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274368313528815616[0;39m <==        Row: 3, Python 入门教程, null, null, 零基础入门 Python 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 20:41:43.472 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274368313528815616[0;39m <==        Row: 4, Mysql 入门教程, null, null, 零基础入门 Mysql 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 20:41:43.472 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274368313528815616[0;39m <==        Row: 5, Oracle 入门教程, null, null, 零基础入门 Oracle 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 20:41:43.472 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274368313528815616[0;39m <==      Total: 5
2023-01-27 20:41:43.473 INFO  com.example.wiki.service.EbookService             :51   [32m274368313528815616[0;39m 总行数 5
2023-01-27 20:41:43.473 INFO  com.example.wiki.service.EbookService             :52   [32m274368313528815616[0;39m 总页数 1
2023-01-27 20:41:43.474 INFO  com.example.wiki.aspect.LogAspect                 :87   [32m274368313528815616[0;39m 返回结果: {"content":{"list":[{"description":"零基础入门 Java 开发，企业级应用开发最佳首选框架","docCount":6,"id":1,"name":"Spring Boot 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Vue 开发，企业级应用开发最佳首选框架","id":2,"name":"Vue 入门教程"},{"description":"零基础入门 Python 开发，企业级应用开发最佳首选框架","id":3,"name":"Python 入门教程"},{"description":"零基础入门 Mysql 开发，企业级应用开发最佳首选框架","id":4,"name":"Mysql 入门教程"},{"description":"零基础入门 Oracle 开发，企业级应用开发最佳首选框架","id":5,"name":"Oracle 入门教程"}],"total":5},"success":true}
2023-01-27 20:41:43.474 INFO  com.example.wiki.aspect.LogAspect                 :88   [32m274368313528815616[0;39m ------------- 结束 耗时：12 ms -------------
2023-01-27 20:42:00.016 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274368382961324032[0;39m 生成今日电子书快照开始
2023-01-27 20:42:00.020 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274368382961324032[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 20:42:00.021 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274368382961324032[0;39m ==> Parameters: 
2023-01-27 20:42:00.028 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274368382961324032[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 22 common frames omitted
2023-01-27 20:42:05.009 INFO  com.example.wiki.job.DocJob                       :32   [32m274368403903483904[0;39m 更新电子书下的文档数据开始
2023-01-27 20:42:05.010 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274368403903483904[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 20:42:05.011 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274368403903483904[0;39m ==> Parameters: 
2023-01-27 20:42:05.012 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274368403903483904[0;39m <==    Updates: 1
2023-01-27 20:42:05.012 INFO  com.example.wiki.job.DocJob                       :35   [32m274368403903483904[0;39m 更新电子书下的文档数据结束，耗时：3毫秒
2023-01-27 20:42:35.014 INFO  com.example.wiki.job.DocJob                       :32   [32m274368529753575424[0;39m 更新电子书下的文档数据开始
2023-01-27 20:42:35.015 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274368529753575424[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 20:42:35.015 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274368529753575424[0;39m ==> Parameters: 
2023-01-27 20:42:35.017 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274368529753575424[0;39m <==    Updates: 1
2023-01-27 20:42:35.017 INFO  com.example.wiki.job.DocJob                       :35   [32m274368529753575424[0;39m 更新电子书下的文档数据结束，耗时：3毫秒
2023-01-27 20:43:00.008 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274368634586009600[0;39m 生成今日电子书快照开始
2023-01-27 20:43:00.011 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274368634586009600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 20:43:00.013 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274368634586009600[0;39m ==> Parameters: 
2023-01-27 20:43:00.020 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274368634586009600[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor71.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 22 common frames omitted
2023-01-27 20:43:05.011 INFO  com.example.wiki.job.DocJob                       :32   [32m274368655570112512[0;39m 更新电子书下的文档数据开始
2023-01-27 20:43:05.012 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274368655570112512[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 20:43:05.012 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274368655570112512[0;39m ==> Parameters: 
2023-01-27 20:43:05.013 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274368655570112512[0;39m <==    Updates: 1
2023-01-27 20:43:05.014 INFO  com.example.wiki.job.DocJob                       :35   [32m274368655570112512[0;39m 更新电子书下的文档数据结束，耗时：3毫秒
2023-01-27 20:43:35.005 INFO  com.example.wiki.job.DocJob                       :32   [32m274368781374066688[0;39m 更新电子书下的文档数据开始
2023-01-27 20:43:35.006 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274368781374066688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 20:43:35.006 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274368781374066688[0;39m ==> Parameters: 
2023-01-27 20:43:35.008 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274368781374066688[0;39m <==    Updates: 1
2023-01-27 20:43:35.008 INFO  com.example.wiki.job.DocJob                       :35   [32m274368781374066688[0;39m 更新电子书下的文档数据结束，耗时：3毫秒
2023-01-27 20:43:45.000 INFO  com.example.wiki.aspect.LogAspect                 :50   [32m274368823296135168[0;39m ------------- 开始 -------------
2023-01-27 20:43:45.001 INFO  com.example.wiki.aspect.LogAspect                 :51   [32m274368823296135168[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2023-01-27 20:43:45.001 INFO  com.example.wiki.aspect.LogAspect                 :52   [32m274368823296135168[0;39m 类名方法: com.example.wiki.controller.EbookController.list
2023-01-27 20:43:45.002 INFO  com.example.wiki.aspect.LogAspect                 :53   [32m274368823296135168[0;39m 远程地址: 127.0.0.1
2023-01-27 20:43:45.002 INFO  com.example.wiki.aspect.LogAspect                 :75   [32m274368823296135168[0;39m 请求参数: [{"page":1,"size":1000}]
2023-01-27 20:43:45.003 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274368823296135168[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2023-01-27 20:43:45.004 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274368823296135168[0;39m ==> Parameters: 
2023-01-27 20:43:45.006 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274368823296135168[0;39m <==    Columns: count(0)
2023-01-27 20:43:45.006 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274368823296135168[0;39m <==        Row: 5
2023-01-27 20:43:45.007 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274368823296135168[0;39m <==      Total: 1
2023-01-27 20:43:45.008 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274368823296135168[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2023-01-27 20:43:45.008 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274368823296135168[0;39m ==> Parameters: 1000(Integer)
2023-01-27 20:43:45.009 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274368823296135168[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2023-01-27 20:43:45.009 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274368823296135168[0;39m <==        Row: 1, Spring Boot 入门教程, null, null, 零基础入门 Java 开发，企业级应用开发最佳首选框架, null, 6, 0, 0
2023-01-27 20:43:45.011 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274368823296135168[0;39m <==        Row: 2, Vue 入门教程, null, null, 零基础入门 Vue 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 20:43:45.011 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274368823296135168[0;39m <==        Row: 3, Python 入门教程, null, null, 零基础入门 Python 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 20:43:45.011 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274368823296135168[0;39m <==        Row: 4, Mysql 入门教程, null, null, 零基础入门 Mysql 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 20:43:45.011 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274368823296135168[0;39m <==        Row: 5, Oracle 入门教程, null, null, 零基础入门 Oracle 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 20:43:45.012 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274368823296135168[0;39m <==      Total: 5
2023-01-27 20:43:45.012 INFO  com.example.wiki.service.EbookService             :51   [32m274368823296135168[0;39m 总行数 5
2023-01-27 20:43:45.012 INFO  com.example.wiki.service.EbookService             :52   [32m274368823296135168[0;39m 总页数 1
2023-01-27 20:43:45.014 INFO  com.example.wiki.aspect.LogAspect                 :87   [32m274368823296135168[0;39m 返回结果: {"content":{"list":[{"description":"零基础入门 Java 开发，企业级应用开发最佳首选框架","docCount":6,"id":1,"name":"Spring Boot 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Vue 开发，企业级应用开发最佳首选框架","id":2,"name":"Vue 入门教程"},{"description":"零基础入门 Python 开发，企业级应用开发最佳首选框架","id":3,"name":"Python 入门教程"},{"description":"零基础入门 Mysql 开发，企业级应用开发最佳首选框架","id":4,"name":"Mysql 入门教程"},{"description":"零基础入门 Oracle 开发，企业级应用开发最佳首选框架","id":5,"name":"Oracle 入门教程"}],"total":5},"success":true}
2023-01-27 20:43:45.014 INFO  com.example.wiki.aspect.LogAspect                 :88   [32m274368823296135168[0;39m ------------- 结束 耗时：14 ms -------------
2023-01-27 20:43:46.380 INFO  com.example.wiki.aspect.LogAspect                 :50   [32m274368829084274688[0;39m ------------- 开始 -------------
2023-01-27 20:43:46.380 INFO  com.example.wiki.aspect.LogAspect                 :51   [32m274368829084274688[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2023-01-27 20:43:46.380 INFO  com.example.wiki.aspect.LogAspect                 :52   [32m274368829084274688[0;39m 类名方法: com.example.wiki.controller.EbookController.list
2023-01-27 20:43:46.381 INFO  com.example.wiki.aspect.LogAspect                 :53   [32m274368829084274688[0;39m 远程地址: 127.0.0.1
2023-01-27 20:43:46.381 INFO  com.example.wiki.aspect.LogAspect                 :75   [32m274368829084274688[0;39m 请求参数: [{"page":1,"size":10}]
2023-01-27 20:43:46.382 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274368829084274688[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2023-01-27 20:43:46.383 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274368829084274688[0;39m ==> Parameters: 
2023-01-27 20:43:46.388 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274368829084274688[0;39m <==    Columns: count(0)
2023-01-27 20:43:46.389 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274368829084274688[0;39m <==        Row: 5
2023-01-27 20:43:46.389 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274368829084274688[0;39m <==      Total: 1
2023-01-27 20:43:46.390 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274368829084274688[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2023-01-27 20:43:46.390 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274368829084274688[0;39m ==> Parameters: 10(Integer)
2023-01-27 20:43:46.391 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274368829084274688[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2023-01-27 20:43:46.391 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274368829084274688[0;39m <==        Row: 1, Spring Boot 入门教程, null, null, 零基础入门 Java 开发，企业级应用开发最佳首选框架, null, 6, 0, 0
2023-01-27 20:43:46.392 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274368829084274688[0;39m <==        Row: 2, Vue 入门教程, null, null, 零基础入门 Vue 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 20:43:46.392 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274368829084274688[0;39m <==        Row: 3, Python 入门教程, null, null, 零基础入门 Python 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 20:43:46.392 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274368829084274688[0;39m <==        Row: 4, Mysql 入门教程, null, null, 零基础入门 Mysql 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 20:43:46.393 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274368829084274688[0;39m <==        Row: 5, Oracle 入门教程, null, null, 零基础入门 Oracle 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 20:43:46.393 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274368829084274688[0;39m <==      Total: 5
2023-01-27 20:43:46.393 INFO  com.example.wiki.service.EbookService             :51   [32m274368829084274688[0;39m 总行数 5
2023-01-27 20:43:46.393 INFO  com.example.wiki.service.EbookService             :52   [32m274368829084274688[0;39m 总页数 1
2023-01-27 20:43:46.394 INFO  com.example.wiki.aspect.LogAspect                 :87   [32m274368829084274688[0;39m 返回结果: {"content":{"list":[{"description":"零基础入门 Java 开发，企业级应用开发最佳首选框架","docCount":6,"id":1,"name":"Spring Boot 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Vue 开发，企业级应用开发最佳首选框架","id":2,"name":"Vue 入门教程"},{"description":"零基础入门 Python 开发，企业级应用开发最佳首选框架","id":3,"name":"Python 入门教程"},{"description":"零基础入门 Mysql 开发，企业级应用开发最佳首选框架","id":4,"name":"Mysql 入门教程"},{"description":"零基础入门 Oracle 开发，企业级应用开发最佳首选框架","id":5,"name":"Oracle 入门教程"}],"total":5},"success":true}
2023-01-27 20:43:46.394 INFO  com.example.wiki.aspect.LogAspect                 :88   [32m274368829084274688[0;39m ------------- 结束 耗时：14 ms -------------
2023-01-27 20:44:00.014 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274368886269415424[0;39m 生成今日电子书快照开始
2023-01-27 20:44:00.017 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274368886269415424[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 20:44:00.019 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274368886269415424[0;39m ==> Parameters: 
2023-01-27 20:44:00.025 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274368886269415424[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor71.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 22 common frames omitted
2023-01-27 20:44:05.011 INFO  com.example.wiki.job.DocJob                       :32   [32m274368907228352512[0;39m 更新电子书下的文档数据开始
2023-01-27 20:44:05.013 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274368907228352512[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 20:44:05.014 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274368907228352512[0;39m ==> Parameters: 
2023-01-27 20:44:05.016 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274368907228352512[0;39m <==    Updates: 1
2023-01-27 20:44:05.027 INFO  com.example.wiki.job.DocJob                       :35   [32m274368907228352512[0;39m 更新电子书下的文档数据结束，耗时：15毫秒
2023-01-27 20:44:35.005 INFO  com.example.wiki.job.DocJob                       :32   [32m274369033032306688[0;39m 更新电子书下的文档数据开始
2023-01-27 20:44:35.007 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274369033032306688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 20:44:35.008 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274369033032306688[0;39m ==> Parameters: 
2023-01-27 20:44:35.009 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274369033032306688[0;39m <==    Updates: 1
2023-01-27 20:44:35.010 INFO  com.example.wiki.job.DocJob                       :35   [32m274369033032306688[0;39m 更新电子书下的文档数据结束，耗时：4毫秒
2023-01-27 20:45:00.010 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274369137910878208[0;39m 生成今日电子书快照开始
2023-01-27 20:45:00.012 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274369137910878208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 20:45:00.013 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274369137910878208[0;39m ==> Parameters: 
2023-01-27 20:45:00.021 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274369137910878208[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor71.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 22 common frames omitted
2023-01-27 20:45:05.001 INFO  com.example.wiki.job.DocJob                       :32   [32m274369158844649472[0;39m 更新电子书下的文档数据开始
2023-01-27 20:45:05.003 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274369158844649472[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 20:45:05.004 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274369158844649472[0;39m ==> Parameters: 
2023-01-27 20:45:05.006 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274369158844649472[0;39m <==    Updates: 1
2023-01-27 20:45:05.006 INFO  com.example.wiki.job.DocJob                       :35   [32m274369158844649472[0;39m 更新电子书下的文档数据结束，耗时：4毫秒
2023-01-27 20:45:35.005 INFO  com.example.wiki.job.DocJob                       :32   [32m274369284690546688[0;39m 更新电子书下的文档数据开始
2023-01-27 20:45:35.006 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274369284690546688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 20:45:35.006 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274369284690546688[0;39m ==> Parameters: 
2023-01-27 20:45:35.008 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274369284690546688[0;39m <==    Updates: 1
2023-01-27 20:45:35.008 INFO  com.example.wiki.job.DocJob                       :35   [32m274369284690546688[0;39m 更新电子书下的文档数据结束，耗时：3毫秒
2023-01-27 20:45:55.011 INFO  com.example.wiki.aspect.LogAspect                 :50   [32m274369368601792512[0;39m ------------- 开始 -------------
2023-01-27 20:45:55.012 INFO  com.example.wiki.aspect.LogAspect                 :51   [32m274369368601792512[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2023-01-27 20:45:55.012 INFO  com.example.wiki.aspect.LogAspect                 :52   [32m274369368601792512[0;39m 类名方法: com.example.wiki.controller.EbookController.list
2023-01-27 20:45:55.013 INFO  com.example.wiki.aspect.LogAspect                 :53   [32m274369368601792512[0;39m 远程地址: 127.0.0.1
2023-01-27 20:45:55.013 INFO  com.example.wiki.aspect.LogAspect                 :75   [32m274369368601792512[0;39m 请求参数: [{"page":1,"size":1000}]
2023-01-27 20:45:55.017 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274369368601792512[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2023-01-27 20:45:55.019 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274369368601792512[0;39m ==> Parameters: 
2023-01-27 20:45:55.026 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274369368601792512[0;39m <==    Columns: count(0)
2023-01-27 20:45:55.026 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274369368601792512[0;39m <==        Row: 5
2023-01-27 20:45:55.026 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274369368601792512[0;39m <==      Total: 1
2023-01-27 20:45:55.027 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274369368601792512[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2023-01-27 20:45:55.027 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274369368601792512[0;39m ==> Parameters: 1000(Integer)
2023-01-27 20:45:55.029 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274369368601792512[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2023-01-27 20:45:55.029 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274369368601792512[0;39m <==        Row: 1, Spring Boot 入门教程, null, null, 零基础入门 Java 开发，企业级应用开发最佳首选框架, null, 6, 0, 0
2023-01-27 20:45:55.030 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274369368601792512[0;39m <==        Row: 2, Vue 入门教程, null, null, 零基础入门 Vue 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 20:45:55.030 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274369368601792512[0;39m <==        Row: 3, Python 入门教程, null, null, 零基础入门 Python 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 20:45:55.032 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274369368601792512[0;39m <==        Row: 4, Mysql 入门教程, null, null, 零基础入门 Mysql 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 20:45:55.032 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274369368601792512[0;39m <==        Row: 5, Oracle 入门教程, null, null, 零基础入门 Oracle 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 20:45:55.032 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274369368601792512[0;39m <==      Total: 5
2023-01-27 20:45:55.033 INFO  com.example.wiki.service.EbookService             :51   [32m274369368601792512[0;39m 总行数 5
2023-01-27 20:45:55.033 INFO  com.example.wiki.service.EbookService             :52   [32m274369368601792512[0;39m 总页数 1
2023-01-27 20:45:55.033 INFO  com.example.wiki.aspect.LogAspect                 :87   [32m274369368601792512[0;39m 返回结果: {"content":{"list":[{"description":"零基础入门 Java 开发，企业级应用开发最佳首选框架","docCount":6,"id":1,"name":"Spring Boot 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Vue 开发，企业级应用开发最佳首选框架","id":2,"name":"Vue 入门教程"},{"description":"零基础入门 Python 开发，企业级应用开发最佳首选框架","id":3,"name":"Python 入门教程"},{"description":"零基础入门 Mysql 开发，企业级应用开发最佳首选框架","id":4,"name":"Mysql 入门教程"},{"description":"零基础入门 Oracle 开发，企业级应用开发最佳首选框架","id":5,"name":"Oracle 入门教程"}],"total":5},"success":true}
2023-01-27 20:45:55.034 INFO  com.example.wiki.aspect.LogAspect                 :88   [32m274369368601792512[0;39m ------------- 结束 耗时：23 ms -------------
2023-01-27 20:45:59.936 INFO  com.example.wiki.aspect.LogAspect                 :50   [32m274369389258739712[0;39m ------------- 开始 -------------
2023-01-27 20:45:59.936 INFO  com.example.wiki.aspect.LogAspect                 :51   [32m274369389258739712[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2023-01-27 20:45:59.936 INFO  com.example.wiki.aspect.LogAspect                 :52   [32m274369389258739712[0;39m 类名方法: com.example.wiki.controller.EbookController.list
2023-01-27 20:45:59.937 INFO  com.example.wiki.aspect.LogAspect                 :53   [32m274369389258739712[0;39m 远程地址: 127.0.0.1
2023-01-27 20:45:59.937 INFO  com.example.wiki.aspect.LogAspect                 :75   [32m274369389258739712[0;39m 请求参数: [{"page":1,"size":1000}]
2023-01-27 20:45:59.939 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274369389258739712[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2023-01-27 20:45:59.939 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274369389258739712[0;39m ==> Parameters: 
2023-01-27 20:45:59.941 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274369389258739712[0;39m <==    Columns: count(0)
2023-01-27 20:45:59.942 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274369389258739712[0;39m <==        Row: 5
2023-01-27 20:45:59.942 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274369389258739712[0;39m <==      Total: 1
2023-01-27 20:45:59.943 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274369389258739712[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2023-01-27 20:45:59.943 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274369389258739712[0;39m ==> Parameters: 1000(Integer)
2023-01-27 20:45:59.944 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274369389258739712[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2023-01-27 20:45:59.946 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274369389258739712[0;39m <==        Row: 1, Spring Boot 入门教程, null, null, 零基础入门 Java 开发，企业级应用开发最佳首选框架, null, 6, 0, 0
2023-01-27 20:45:59.947 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274369389258739712[0;39m <==        Row: 2, Vue 入门教程, null, null, 零基础入门 Vue 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 20:45:59.947 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274369389258739712[0;39m <==        Row: 3, Python 入门教程, null, null, 零基础入门 Python 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 20:45:59.947 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274369389258739712[0;39m <==        Row: 4, Mysql 入门教程, null, null, 零基础入门 Mysql 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 20:45:59.948 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274369389258739712[0;39m <==        Row: 5, Oracle 入门教程, null, null, 零基础入门 Oracle 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 20:45:59.948 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274369389258739712[0;39m <==      Total: 5
2023-01-27 20:45:59.948 INFO  com.example.wiki.service.EbookService             :51   [32m274369389258739712[0;39m 总行数 5
2023-01-27 20:45:59.949 INFO  com.example.wiki.service.EbookService             :52   [32m274369389258739712[0;39m 总页数 1
2023-01-27 20:45:59.949 INFO  com.example.wiki.aspect.LogAspect                 :87   [32m274369389258739712[0;39m 返回结果: {"content":{"list":[{"description":"零基础入门 Java 开发，企业级应用开发最佳首选框架","docCount":6,"id":1,"name":"Spring Boot 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Vue 开发，企业级应用开发最佳首选框架","id":2,"name":"Vue 入门教程"},{"description":"零基础入门 Python 开发，企业级应用开发最佳首选框架","id":3,"name":"Python 入门教程"},{"description":"零基础入门 Mysql 开发，企业级应用开发最佳首选框架","id":4,"name":"Mysql 入门教程"},{"description":"零基础入门 Oracle 开发，企业级应用开发最佳首选框架","id":5,"name":"Oracle 入门教程"}],"total":5},"success":true}
2023-01-27 20:45:59.950 INFO  com.example.wiki.aspect.LogAspect                 :88   [32m274369389258739712[0;39m ------------- 结束 耗时：14 ms -------------
2023-01-27 20:46:00.006 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274369389552340992[0;39m 生成今日电子书快照开始
2023-01-27 20:46:00.006 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274369389552340992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 20:46:00.008 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274369389552340992[0;39m ==> Parameters: 
2023-01-27 20:46:00.010 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274369389552340992[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor71.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 22 common frames omitted
2023-01-27 20:46:05.003 INFO  com.example.wiki.job.DocJob                       :32   [32m274369410511278080[0;39m 更新电子书下的文档数据开始
2023-01-27 20:46:05.005 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274369410511278080[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 20:46:05.006 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274369410511278080[0;39m ==> Parameters: 
2023-01-27 20:46:05.009 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274369410511278080[0;39m <==    Updates: 1
2023-01-27 20:46:05.010 INFO  com.example.wiki.job.DocJob                       :35   [32m274369410511278080[0;39m 更新电子书下的文档数据结束，耗时：6毫秒
2023-01-27 20:46:35.001 INFO  com.example.wiki.job.DocJob                       :32   [32m274369536332009472[0;39m 更新电子书下的文档数据开始
2023-01-27 20:46:35.003 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274369536332009472[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 20:46:35.004 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274369536332009472[0;39m ==> Parameters: 
2023-01-27 20:46:35.007 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274369536332009472[0;39m <==    Updates: 1
2023-01-27 20:46:35.007 INFO  com.example.wiki.job.DocJob                       :35   [32m274369536332009472[0;39m 更新电子书下的文档数据结束，耗时：5毫秒
2023-01-27 20:47:00.006 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274369641210580992[0;39m 生成今日电子书快照开始
2023-01-27 20:47:00.008 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274369641210580992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 20:47:00.009 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274369641210580992[0;39m ==> Parameters: 
2023-01-27 20:47:00.014 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274369641210580992[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor71.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 22 common frames omitted
2023-01-27 20:47:05.012 INFO  com.example.wiki.job.DocJob                       :32   [32m274369662207266816[0;39m 更新电子书下的文档数据开始
2023-01-27 20:47:05.013 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274369662207266816[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 20:47:05.013 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274369662207266816[0;39m ==> Parameters: 
2023-01-27 20:47:05.024 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274369662207266816[0;39m <==    Updates: 1
2023-01-27 20:47:05.025 INFO  com.example.wiki.job.DocJob                       :35   [32m274369662207266816[0;39m 更新电子书下的文档数据结束，耗时：13毫秒
2023-01-27 20:47:35.009 INFO  com.example.wiki.job.DocJob                       :32   [32m274369788023803904[0;39m 更新电子书下的文档数据开始
2023-01-27 20:47:35.011 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274369788023803904[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 20:47:35.011 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274369788023803904[0;39m ==> Parameters: 
2023-01-27 20:47:35.013 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274369788023803904[0;39m <==    Updates: 1
2023-01-27 20:47:35.013 INFO  com.example.wiki.job.DocJob                       :35   [32m274369788023803904[0;39m 更新电子书下的文档数据结束，耗时：3毫秒
2023-01-27 20:48:00.002 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274369892852043776[0;39m 生成今日电子书快照开始
2023-01-27 20:48:00.003 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274369892852043776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 20:48:00.004 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274369892852043776[0;39m ==> Parameters: 
2023-01-27 20:48:00.006 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274369892852043776[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor71.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 22 common frames omitted
2023-01-27 20:48:05.004 INFO  com.example.wiki.job.DocJob                       :32   [32m274369913831952384[0;39m 更新电子书下的文档数据开始
2023-01-27 20:48:05.004 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274369913831952384[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 20:48:05.005 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274369913831952384[0;39m ==> Parameters: 
2023-01-27 20:48:05.006 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274369913831952384[0;39m <==    Updates: 1
2023-01-27 20:48:05.007 INFO  com.example.wiki.job.DocJob                       :35   [32m274369913831952384[0;39m 更新电子书下的文档数据结束，耗时：3毫秒
2023-01-27 20:48:34.968 INFO  com.example.wiki.aspect.LogAspect                 :50   [32m274370039510077440[0;39m ------------- 开始 -------------
2023-01-27 20:48:34.969 INFO  com.example.wiki.aspect.LogAspect                 :51   [32m274370039510077440[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2023-01-27 20:48:34.969 INFO  com.example.wiki.aspect.LogAspect                 :52   [32m274370039510077440[0;39m 类名方法: com.example.wiki.controller.EbookController.list
2023-01-27 20:48:34.969 INFO  com.example.wiki.aspect.LogAspect                 :53   [32m274370039510077440[0;39m 远程地址: 127.0.0.1
2023-01-27 20:48:34.970 INFO  com.example.wiki.aspect.LogAspect                 :75   [32m274370039510077440[0;39m 请求参数: [{"page":1,"size":1000}]
2023-01-27 20:48:34.972 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274370039510077440[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2023-01-27 20:48:34.973 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274370039510077440[0;39m ==> Parameters: 
2023-01-27 20:48:34.980 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274370039510077440[0;39m <==    Columns: count(0)
2023-01-27 20:48:34.980 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274370039510077440[0;39m <==        Row: 5
2023-01-27 20:48:34.981 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274370039510077440[0;39m <==      Total: 1
2023-01-27 20:48:34.982 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274370039510077440[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2023-01-27 20:48:34.982 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274370039510077440[0;39m ==> Parameters: 1000(Integer)
2023-01-27 20:48:34.985 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274370039510077440[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2023-01-27 20:48:34.986 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274370039510077440[0;39m <==        Row: 1, Spring Boot 入门教程, null, null, 零基础入门 Java 开发，企业级应用开发最佳首选框架, null, 6, 0, 0
2023-01-27 20:48:34.986 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274370039510077440[0;39m <==        Row: 2, Vue 入门教程, null, null, 零基础入门 Vue 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 20:48:34.987 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274370039510077440[0;39m <==        Row: 3, Python 入门教程, null, null, 零基础入门 Python 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 20:48:34.987 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274370039510077440[0;39m <==        Row: 4, Mysql 入门教程, null, null, 零基础入门 Mysql 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 20:48:34.987 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274370039510077440[0;39m <==        Row: 5, Oracle 入门教程, null, null, 零基础入门 Oracle 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 20:48:34.988 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274370039510077440[0;39m <==      Total: 5
2023-01-27 20:48:34.990 INFO  com.example.wiki.service.EbookService             :51   [32m274370039510077440[0;39m 总行数 5
2023-01-27 20:48:34.990 INFO  com.example.wiki.service.EbookService             :52   [32m274370039510077440[0;39m 总页数 1
2023-01-27 20:48:34.990 INFO  com.example.wiki.aspect.LogAspect                 :87   [32m274370039510077440[0;39m 返回结果: {"content":{"list":[{"description":"零基础入门 Java 开发，企业级应用开发最佳首选框架","docCount":6,"id":1,"name":"Spring Boot 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Vue 开发，企业级应用开发最佳首选框架","id":2,"name":"Vue 入门教程"},{"description":"零基础入门 Python 开发，企业级应用开发最佳首选框架","id":3,"name":"Python 入门教程"},{"description":"零基础入门 Mysql 开发，企业级应用开发最佳首选框架","id":4,"name":"Mysql 入门教程"},{"description":"零基础入门 Oracle 开发，企业级应用开发最佳首选框架","id":5,"name":"Oracle 入门教程"}],"total":5},"success":true}
2023-01-27 20:48:34.991 INFO  com.example.wiki.aspect.LogAspect                 :88   [32m274370039510077440[0;39m ------------- 结束 耗时：23 ms -------------
2023-01-27 20:48:35.011 INFO  com.example.wiki.job.DocJob                       :32   [32m274370039690432512[0;39m 更新电子书下的文档数据开始
2023-01-27 20:48:35.011 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274370039690432512[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 20:48:35.012 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274370039690432512[0;39m ==> Parameters: 
2023-01-27 20:48:35.014 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274370039690432512[0;39m <==    Updates: 1
2023-01-27 20:48:35.015 INFO  com.example.wiki.job.DocJob                       :35   [32m274370039690432512[0;39m 更新电子书下的文档数据结束，耗时：4毫秒
2023-01-27 20:49:00.002 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274370144510283776[0;39m 生成今日电子书快照开始
2023-01-27 20:49:00.003 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274370144510283776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 20:49:00.004 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274370144510283776[0;39m ==> Parameters: 
2023-01-27 20:49:00.008 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274370144510283776[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor71.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 22 common frames omitted
2023-01-27 20:49:05.001 INFO  com.example.wiki.job.DocJob                       :32   [32m274370165477609472[0;39m 更新电子书下的文档数据开始
2023-01-27 20:49:05.002 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274370165477609472[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 20:49:05.002 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274370165477609472[0;39m ==> Parameters: 
2023-01-27 20:49:05.003 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274370165477609472[0;39m <==    Updates: 1
2023-01-27 20:49:05.004 INFO  com.example.wiki.job.DocJob                       :35   [32m274370165477609472[0;39m 更新电子书下的文档数据结束，耗时：3毫秒
2023-01-27 20:49:35.010 INFO  com.example.wiki.job.DocJob                       :32   [32m274370291344478208[0;39m 更新电子书下的文档数据开始
2023-01-27 20:49:35.011 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274370291344478208[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 20:49:35.011 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274370291344478208[0;39m ==> Parameters: 
2023-01-27 20:49:35.013 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274370291344478208[0;39m <==    Updates: 1
2023-01-27 20:49:35.013 INFO  com.example.wiki.job.DocJob                       :35   [32m274370291344478208[0;39m 更新电子书下的文档数据结束，耗时：3毫秒
2023-01-27 20:50:00.007 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274370396189495296[0;39m 生成今日电子书快照开始
2023-01-27 20:50:00.008 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274370396189495296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 20:50:00.009 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274370396189495296[0;39m ==> Parameters: 
2023-01-27 20:50:00.013 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274370396189495296[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor71.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 22 common frames omitted
2023-01-27 20:50:05.008 INFO  com.example.wiki.job.DocJob                       :32   [32m274370417165209600[0;39m 更新电子书下的文档数据开始
2023-01-27 20:50:05.009 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274370417165209600[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 20:50:05.009 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274370417165209600[0;39m ==> Parameters: 
2023-01-27 20:50:05.011 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274370417165209600[0;39m <==    Updates: 1
2023-01-27 20:50:05.011 INFO  com.example.wiki.job.DocJob                       :35   [32m274370417165209600[0;39m 更新电子书下的文档数据结束，耗时：3毫秒
2023-01-27 20:50:35.009 INFO  com.example.wiki.job.DocJob                       :32   [32m274370542998523904[0;39m 更新电子书下的文档数据开始
2023-01-27 20:50:35.010 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274370542998523904[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 20:50:35.010 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274370542998523904[0;39m ==> Parameters: 
2023-01-27 20:50:35.011 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274370542998523904[0;39m <==    Updates: 1
2023-01-27 20:50:35.012 INFO  com.example.wiki.job.DocJob                       :35   [32m274370542998523904[0;39m 更新电子书下的文档数据结束，耗时：3毫秒
2023-01-27 20:51:00.012 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274370647868706816[0;39m 生成今日电子书快照开始
2023-01-27 20:51:00.013 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274370647868706816[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 20:51:00.013 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274370647868706816[0;39m ==> Parameters: 
2023-01-27 20:51:00.020 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274370647868706816[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor71.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 22 common frames omitted
2023-01-27 20:51:05.011 INFO  com.example.wiki.job.DocJob                       :32   [32m274370668836032512[0;39m 更新电子书下的文档数据开始
2023-01-27 20:51:05.012 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274370668836032512[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 20:51:05.012 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274370668836032512[0;39m ==> Parameters: 
2023-01-27 20:51:05.013 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274370668836032512[0;39m <==    Updates: 1
2023-01-27 20:51:05.013 INFO  com.example.wiki.job.DocJob                       :35   [32m274370668836032512[0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2023-01-27 20:51:35.004 INFO  com.example.wiki.job.DocJob                       :32   [32m274370794635792384[0;39m 更新电子书下的文档数据开始
2023-01-27 20:51:35.005 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274370794635792384[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 20:51:35.005 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274370794635792384[0;39m ==> Parameters: 
2023-01-27 20:51:35.006 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274370794635792384[0;39m <==    Updates: 1
2023-01-27 20:51:35.006 INFO  com.example.wiki.job.DocJob                       :35   [32m274370794635792384[0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2023-01-27 20:52:00.017 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274370899547918336[0;39m 生成今日电子书快照开始
2023-01-27 20:52:00.019 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274370899547918336[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 20:52:00.020 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274370899547918336[0;39m ==> Parameters: 
2023-01-27 20:52:00.024 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274370899547918336[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor71.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 22 common frames omitted
2023-01-27 20:52:05.011 INFO  com.example.wiki.job.DocJob                       :32   [32m274370920494272512[0;39m 更新电子书下的文档数据开始
2023-01-27 20:52:05.012 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274370920494272512[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 20:52:05.012 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274370920494272512[0;39m ==> Parameters: 
2023-01-27 20:52:05.013 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274370920494272512[0;39m <==    Updates: 1
2023-01-27 20:52:05.013 INFO  com.example.wiki.job.DocJob                       :35   [32m274370920494272512[0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2023-01-27 20:52:35.012 INFO  com.example.wiki.job.DocJob                       :32   [32m274371046327586816[0;39m 更新电子书下的文档数据开始
2023-01-27 20:52:35.015 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274371046327586816[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 20:52:35.016 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274371046327586816[0;39m ==> Parameters: 
2023-01-27 20:52:35.019 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274371046327586816[0;39m <==    Updates: 1
2023-01-27 20:52:35.020 INFO  com.example.wiki.job.DocJob                       :35   [32m274371046327586816[0;39m 更新电子书下的文档数据结束，耗时：7毫秒
2023-01-27 20:53:00.008 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274371151168409600[0;39m 生成今日电子书快照开始
2023-01-27 20:53:00.010 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274371151168409600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 20:53:00.012 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274371151168409600[0;39m ==> Parameters: 
2023-01-27 20:53:00.030 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274371151168409600[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.GeneratedMethodAccessor111.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor71.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 21 common frames omitted
2023-01-27 20:53:05.006 INFO  com.example.wiki.job.DocJob                       :32   [32m274371172131540992[0;39m 更新电子书下的文档数据开始
2023-01-27 20:53:05.008 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274371172131540992[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 20:53:05.009 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274371172131540992[0;39m ==> Parameters: 
2023-01-27 20:53:05.011 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274371172131540992[0;39m <==    Updates: 1
2023-01-27 20:53:05.012 INFO  com.example.wiki.job.DocJob                       :35   [32m274371172131540992[0;39m 更新电子书下的文档数据结束，耗时：5毫秒
2023-01-27 20:53:35.003 INFO  com.example.wiki.job.DocJob                       :32   [32m274371297948078080[0;39m 更新电子书下的文档数据开始
2023-01-27 20:53:35.005 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274371297948078080[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 20:53:35.006 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274371297948078080[0;39m ==> Parameters: 
2023-01-27 20:53:35.008 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274371297948078080[0;39m <==    Updates: 1
2023-01-27 20:53:35.009 INFO  com.example.wiki.job.DocJob                       :35   [32m274371297948078080[0;39m 更新电子书下的文档数据结束，耗时：5毫秒
2023-01-27 20:54:00.009 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274371402830843904[0;39m 生成今日电子书快照开始
2023-01-27 20:54:00.011 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274371402830843904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 20:54:00.013 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274371402830843904[0;39m ==> Parameters: 
2023-01-27 20:54:00.018 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274371402830843904[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.GeneratedMethodAccessor111.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor71.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 21 common frames omitted
2023-01-27 20:54:05.004 INFO  com.example.wiki.job.DocJob                       :32   [32m274371423781392384[0;39m 更新电子书下的文档数据开始
2023-01-27 20:54:05.006 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274371423781392384[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 20:54:05.007 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274371423781392384[0;39m ==> Parameters: 
2023-01-27 20:54:05.010 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274371423781392384[0;39m <==    Updates: 1
2023-01-27 20:54:05.010 INFO  com.example.wiki.job.DocJob                       :35   [32m274371423781392384[0;39m 更新电子书下的文档数据结束，耗时：6毫秒
2023-01-27 20:54:35.001 INFO  com.example.wiki.job.DocJob                       :32   [32m274371549597929472[0;39m 更新电子书下的文档数据开始
2023-01-27 20:54:35.003 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274371549597929472[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 20:54:35.004 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274371549597929472[0;39m ==> Parameters: 
2023-01-27 20:54:35.007 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274371549597929472[0;39m <==    Updates: 1
2023-01-27 20:54:35.007 INFO  com.example.wiki.job.DocJob                       :35   [32m274371549597929472[0;39m 更新电子书下的文档数据结束，耗时：6毫秒
2023-01-27 20:55:00.001 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274371654455529472[0;39m 生成今日电子书快照开始
2023-01-27 20:55:00.002 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274371654455529472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 20:55:00.003 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274371654455529472[0;39m ==> Parameters: 
2023-01-27 20:55:00.007 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274371654455529472[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.GeneratedMethodAccessor111.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor71.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 21 common frames omitted
2023-01-27 20:55:05.014 INFO  com.example.wiki.job.DocJob                       :32   [32m274371675481575424[0;39m 更新电子书下的文档数据开始
2023-01-27 20:55:05.015 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274371675481575424[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 20:55:05.015 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274371675481575424[0;39m ==> Parameters: 
2023-01-27 20:55:05.016 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274371675481575424[0;39m <==    Updates: 1
2023-01-27 20:55:05.017 INFO  com.example.wiki.job.DocJob                       :35   [32m274371675481575424[0;39m 更新电子书下的文档数据结束，耗时：3毫秒
2023-01-27 20:55:35.009 INFO  com.example.wiki.job.DocJob                       :32   [32m274371801289723904[0;39m 更新电子书下的文档数据开始
2023-01-27 20:55:35.010 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274371801289723904[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 20:55:35.011 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274371801289723904[0;39m ==> Parameters: 
2023-01-27 20:55:35.012 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274371801289723904[0;39m <==    Updates: 1
2023-01-27 20:55:35.012 INFO  com.example.wiki.job.DocJob                       :35   [32m274371801289723904[0;39m 更新电子书下的文档数据结束，耗时：3毫秒
2023-01-27 20:56:00.002 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274371906117963776[0;39m 生成今日电子书快照开始
2023-01-27 20:56:00.004 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274371906117963776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 20:56:00.006 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274371906117963776[0;39m ==> Parameters: 
2023-01-27 20:56:00.011 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274371906117963776[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.GeneratedMethodAccessor111.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor71.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 21 common frames omitted
2023-01-27 20:56:05.011 INFO  com.example.wiki.job.DocJob                       :32   [32m274371927127232512[0;39m 更新电子书下的文档数据开始
2023-01-27 20:56:05.013 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274371927127232512[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 20:56:05.014 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274371927127232512[0;39m ==> Parameters: 
2023-01-27 20:56:05.017 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274371927127232512[0;39m <==    Updates: 1
2023-01-27 20:56:05.017 INFO  com.example.wiki.job.DocJob                       :35   [32m274371927127232512[0;39m 更新电子书下的文档数据结束，耗时：5毫秒
2023-01-27 20:56:35.001 INFO  com.example.wiki.job.DocJob                       :32   [32m274372052914409472[0;39m 更新电子书下的文档数据开始
2023-01-27 20:56:35.003 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274372052914409472[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 20:56:35.004 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274372052914409472[0;39m ==> Parameters: 
2023-01-27 20:56:35.007 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274372052914409472[0;39m <==    Updates: 1
2023-01-27 20:56:35.007 INFO  com.example.wiki.job.DocJob                       :35   [32m274372052914409472[0;39m 更新电子书下的文档数据结束，耗时：5毫秒
2023-01-27 20:57:00.006 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274372157792980992[0;39m 生成今日电子书快照开始
2023-01-27 20:57:00.008 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274372157792980992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 20:57:00.009 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274372157792980992[0;39m ==> Parameters: 
2023-01-27 20:57:00.016 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274372157792980992[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.GeneratedMethodAccessor111.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor71.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 21 common frames omitted
2023-01-27 20:57:05.011 INFO  com.example.wiki.job.DocJob                       :32   [32m274372178785472512[0;39m 更新电子书下的文档数据开始
2023-01-27 20:57:05.012 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274372178785472512[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 20:57:05.012 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274372178785472512[0;39m ==> Parameters: 
2023-01-27 20:57:05.013 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274372178785472512[0;39m <==    Updates: 1
2023-01-27 20:57:05.013 INFO  com.example.wiki.job.DocJob                       :35   [32m274372178785472512[0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2023-01-27 20:57:35.000 INFO  com.example.wiki.job.DocJob                       :32   [32m274372304568455168[0;39m 更新电子书下的文档数据开始
2023-01-27 20:57:35.001 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274372304568455168[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 20:57:35.002 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274372304568455168[0;39m ==> Parameters: 
2023-01-27 20:57:35.003 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274372304568455168[0;39m <==    Updates: 1
2023-01-27 20:57:35.003 INFO  com.example.wiki.job.DocJob                       :35   [32m274372304568455168[0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2023-01-27 20:58:00.005 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274372409447026688[0;39m 生成今日电子书快照开始
2023-01-27 20:58:00.006 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274372409447026688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 20:58:00.006 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274372409447026688[0;39m ==> Parameters: 
2023-01-27 20:58:00.008 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274372409447026688[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.GeneratedMethodAccessor111.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor71.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 21 common frames omitted
2023-01-27 20:58:05.008 INFO  com.example.wiki.job.DocJob                       :32   [32m274372430431129600[0;39m 更新电子书下的文档数据开始
2023-01-27 20:58:05.010 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274372430431129600[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 20:58:05.011 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274372430431129600[0;39m ==> Parameters: 
2023-01-27 20:58:05.014 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274372430431129600[0;39m <==    Updates: 1
2023-01-27 20:58:05.014 INFO  com.example.wiki.job.DocJob                       :35   [32m274372430431129600[0;39m 更新电子书下的文档数据结束，耗时：6毫秒
2023-01-27 20:58:35.014 INFO  com.example.wiki.job.DocJob                       :32   [32m274372556285415424[0;39m 更新电子书下的文档数据开始
2023-01-27 20:58:35.015 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274372556285415424[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 20:58:35.015 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274372556285415424[0;39m ==> Parameters: 
2023-01-27 20:58:35.016 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274372556285415424[0;39m <==    Updates: 1
2023-01-27 20:58:35.017 INFO  com.example.wiki.job.DocJob                       :35   [32m274372556285415424[0;39m 更新电子书下的文档数据结束，耗时：3毫秒
2023-01-27 20:59:00.001 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274372661088489472[0;39m 生成今日电子书快照开始
2023-01-27 20:59:00.003 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274372661088489472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 20:59:00.005 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274372661088489472[0;39m ==> Parameters: 
2023-01-27 20:59:00.010 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274372661088489472[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.GeneratedMethodAccessor111.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor71.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 21 common frames omitted
2023-01-27 20:59:05.007 INFO  com.example.wiki.job.DocJob                       :32   [32m274372682085175296[0;39m 更新电子书下的文档数据开始
2023-01-27 20:59:05.008 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274372682085175296[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 20:59:05.008 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274372682085175296[0;39m ==> Parameters: 
2023-01-27 20:59:05.009 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274372682085175296[0;39m <==    Updates: 1
2023-01-27 20:59:05.009 INFO  com.example.wiki.job.DocJob                       :35   [32m274372682085175296[0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2023-01-27 20:59:35.009 INFO  com.example.wiki.job.DocJob                       :32   [32m274372807922683904[0;39m 更新电子书下的文档数据开始
2023-01-27 20:59:35.011 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274372807922683904[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 20:59:35.012 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274372807922683904[0;39m ==> Parameters: 
2023-01-27 20:59:35.014 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274372807922683904[0;39m <==    Updates: 1
2023-01-27 20:59:35.015 INFO  com.example.wiki.job.DocJob                       :35   [32m274372807922683904[0;39m 更新电子书下的文档数据结束，耗时：6毫秒
2023-01-27 21:00:00.014 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274372912801255424[0;39m 生成今日电子书快照开始
2023-01-27 21:00:00.015 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274372912801255424[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 21:00:00.017 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274372912801255424[0;39m ==> Parameters: 
2023-01-27 21:00:00.019 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274372912801255424[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.GeneratedMethodAccessor111.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor71.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 21 common frames omitted
2023-01-27 21:00:05.007 INFO  com.example.wiki.job.DocJob                       :32   [32m274372933743415296[0;39m 更新电子书下的文档数据开始
2023-01-27 21:00:05.008 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274372933743415296[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:00:05.010 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274372933743415296[0;39m ==> Parameters: 
2023-01-27 21:00:05.012 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274372933743415296[0;39m <==    Updates: 1
2023-01-27 21:00:05.012 INFO  com.example.wiki.job.DocJob                       :35   [32m274372933743415296[0;39m 更新电子书下的文档数据结束，耗时：5毫秒
2023-01-27 21:00:35.007 INFO  com.example.wiki.job.DocJob                       :32   [32m274373059572535296[0;39m 更新电子书下的文档数据开始
2023-01-27 21:00:35.008 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274373059572535296[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:00:35.009 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274373059572535296[0;39m ==> Parameters: 
2023-01-27 21:00:35.011 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274373059572535296[0;39m <==    Updates: 1
2023-01-27 21:00:35.011 INFO  com.example.wiki.job.DocJob                       :35   [32m274373059572535296[0;39m 更新电子书下的文档数据结束，耗时：4毫秒
2023-01-27 21:01:00.004 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274373164417552384[0;39m 生成今日电子书快照开始
2023-01-27 21:01:00.017 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274373164417552384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 21:01:00.018 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274373164417552384[0;39m ==> Parameters: 
2023-01-27 21:01:00.022 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274373164417552384[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.GeneratedMethodAccessor111.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor71.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 21 common frames omitted
2023-01-27 21:01:05.010 INFO  com.example.wiki.job.DocJob                       :32   [32m274373185414238208[0;39m 更新电子书下的文档数据开始
2023-01-27 21:01:05.011 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274373185414238208[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:01:05.011 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274373185414238208[0;39m ==> Parameters: 
2023-01-27 21:01:05.012 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274373185414238208[0;39m <==    Updates: 1
2023-01-27 21:01:05.012 INFO  com.example.wiki.job.DocJob                       :35   [32m274373185414238208[0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2023-01-27 21:01:35.002 INFO  com.example.wiki.job.DocJob                       :32   [32m274373311209803776[0;39m 更新电子书下的文档数据开始
2023-01-27 21:01:35.004 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274373311209803776[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:01:35.005 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274373311209803776[0;39m ==> Parameters: 
2023-01-27 21:01:35.007 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274373311209803776[0;39m <==    Updates: 1
2023-01-27 21:01:35.008 INFO  com.example.wiki.job.DocJob                       :35   [32m274373311209803776[0;39m 更新电子书下的文档数据结束，耗时：6毫秒
2023-01-27 21:02:00.016 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274373416126124032[0;39m 生成今日电子书快照开始
2023-01-27 21:02:00.019 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274373416126124032[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 21:02:00.020 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274373416126124032[0;39m ==> Parameters: 
2023-01-27 21:02:00.023 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274373416126124032[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.GeneratedMethodAccessor111.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor71.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 21 common frames omitted
2023-01-27 21:02:05.006 INFO  com.example.wiki.job.DocJob                       :32   [32m274373437055700992[0;39m 更新电子书下的文档数据开始
2023-01-27 21:02:05.008 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274373437055700992[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:02:05.008 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274373437055700992[0;39m ==> Parameters: 
2023-01-27 21:02:05.010 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274373437055700992[0;39m <==    Updates: 1
2023-01-27 21:02:05.011 INFO  com.example.wiki.job.DocJob                       :35   [32m274373437055700992[0;39m 更新电子书下的文档数据结束，耗时：5毫秒
2023-01-27 21:02:35.008 INFO  com.example.wiki.job.DocJob                       :32   [32m274373562893209600[0;39m 更新电子书下的文档数据开始
2023-01-27 21:02:35.010 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274373562893209600[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:02:35.011 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274373562893209600[0;39m ==> Parameters: 
2023-01-27 21:02:35.013 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274373562893209600[0;39m <==    Updates: 1
2023-01-27 21:02:35.014 INFO  com.example.wiki.job.DocJob                       :35   [32m274373562893209600[0;39m 更新电子书下的文档数据结束，耗时：5毫秒
2023-01-27 21:03:00.008 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274373667750809600[0;39m 生成今日电子书快照开始
2023-01-27 21:03:00.010 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274373667750809600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 21:03:00.012 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274373667750809600[0;39m ==> Parameters: 
2023-01-27 21:03:00.014 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274373667750809600[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.GeneratedMethodAccessor111.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor71.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 21 common frames omitted
2023-01-27 21:03:05.002 INFO  com.example.wiki.job.DocJob                       :32   [32m274373688697163776[0;39m 更新电子书下的文档数据开始
2023-01-27 21:03:05.004 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274373688697163776[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:03:05.004 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274373688697163776[0;39m ==> Parameters: 
2023-01-27 21:03:05.007 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274373688697163776[0;39m <==    Updates: 1
2023-01-27 21:03:05.007 INFO  com.example.wiki.job.DocJob                       :35   [32m274373688697163776[0;39m 更新电子书下的文档数据结束，耗时：4毫秒
2023-01-27 21:03:35.016 INFO  com.example.wiki.job.DocJob                       :32   [32m274373814585004032[0;39m 更新电子书下的文档数据开始
2023-01-27 21:03:35.018 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274373814585004032[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:03:35.019 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274373814585004032[0;39m ==> Parameters: 
2023-01-27 21:03:35.021 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274373814585004032[0;39m <==    Updates: 1
2023-01-27 21:03:35.022 INFO  com.example.wiki.job.DocJob                       :35   [32m274373814585004032[0;39m 更新电子书下的文档数据结束，耗时：6毫秒
2023-01-27 21:04:00.008 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274373919409049600[0;39m 生成今日电子书快照开始
2023-01-27 21:04:00.010 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274373919409049600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 21:04:00.012 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274373919409049600[0;39m ==> Parameters: 
2023-01-27 21:04:00.014 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274373919409049600[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.GeneratedMethodAccessor111.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor71.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 21 common frames omitted
2023-01-27 21:04:05.007 INFO  com.example.wiki.job.DocJob                       :32   [32m274373940376375296[0;39m 更新电子书下的文档数据开始
2023-01-27 21:04:05.009 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274373940376375296[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:04:05.010 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274373940376375296[0;39m ==> Parameters: 
2023-01-27 21:04:05.013 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274373940376375296[0;39m <==    Updates: 1
2023-01-27 21:04:05.013 INFO  com.example.wiki.job.DocJob                       :35   [32m274373940376375296[0;39m 更新电子书下的文档数据结束，耗时：5毫秒
2023-01-27 21:04:35.012 INFO  com.example.wiki.job.DocJob                       :32   [32m274374066226466816[0;39m 更新电子书下的文档数据开始
2023-01-27 21:04:35.014 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274374066226466816[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:04:35.015 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274374066226466816[0;39m ==> Parameters: 
2023-01-27 21:04:35.028 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274374066226466816[0;39m <==    Updates: 1
2023-01-27 21:04:35.029 INFO  com.example.wiki.job.DocJob                       :35   [32m274374066226466816[0;39m 更新电子书下的文档数据结束，耗时：16毫秒
2023-01-27 21:05:00.008 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274374171067289600[0;39m 生成今日电子书快照开始
2023-01-27 21:05:00.009 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274374171067289600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 21:05:00.011 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274374171067289600[0;39m ==> Parameters: 
2023-01-27 21:05:00.014 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274374171067289600[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.GeneratedMethodAccessor111.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor71.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 21 common frames omitted
2023-01-27 21:05:05.005 INFO  com.example.wiki.job.DocJob                       :32   [32m274374192026226688[0;39m 更新电子书下的文档数据开始
2023-01-27 21:05:05.006 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274374192026226688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:05:05.006 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274374192026226688[0;39m ==> Parameters: 
2023-01-27 21:05:05.009 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274374192026226688[0;39m <==    Updates: 1
2023-01-27 21:05:05.009 INFO  com.example.wiki.job.DocJob                       :35   [32m274374192026226688[0;39m 更新电子书下的文档数据结束，耗时：4毫秒
2023-01-27 21:05:35.004 INFO  com.example.wiki.job.DocJob                       :32   [32m274374317851152384[0;39m 更新电子书下的文档数据开始
2023-01-27 21:05:35.006 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274374317851152384[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:05:35.007 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274374317851152384[0;39m ==> Parameters: 
2023-01-27 21:05:35.009 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274374317851152384[0;39m <==    Updates: 1
2023-01-27 21:05:35.010 INFO  com.example.wiki.job.DocJob                       :35   [32m274374317851152384[0;39m 更新电子书下的文档数据结束，耗时：5毫秒
2023-01-27 21:06:00.010 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274374422733918208[0;39m 生成今日电子书快照开始
2023-01-27 21:06:00.012 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274374422733918208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 21:06:00.013 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274374422733918208[0;39m ==> Parameters: 
2023-01-27 21:06:00.015 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274374422733918208[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.GeneratedMethodAccessor111.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor71.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 21 common frames omitted
2023-01-27 21:06:05.002 INFO  com.example.wiki.job.DocJob                       :32   [32m274374443671883776[0;39m 更新电子书下的文档数据开始
2023-01-27 21:06:05.004 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274374443671883776[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:06:05.004 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274374443671883776[0;39m ==> Parameters: 
2023-01-27 21:06:05.007 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274374443671883776[0;39m <==    Updates: 1
2023-01-27 21:06:05.008 INFO  com.example.wiki.job.DocJob                       :35   [32m274374443671883776[0;39m 更新电子书下的文档数据结束，耗时：5毫秒
2023-01-27 21:06:35.006 INFO  com.example.wiki.job.DocJob                       :32   [32m274374569517780992[0;39m 更新电子书下的文档数据开始
2023-01-27 21:06:35.010 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274374569517780992[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:06:35.011 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274374569517780992[0;39m ==> Parameters: 
2023-01-27 21:06:35.032 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274374569517780992[0;39m <==    Updates: 1
2023-01-27 21:06:35.033 INFO  com.example.wiki.job.DocJob                       :35   [32m274374569517780992[0;39m 更新电子书下的文档数据结束，耗时：26毫秒
2023-01-27 21:07:00.002 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274374674358603776[0;39m 生成今日电子书快照开始
2023-01-27 21:07:00.006 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274374674358603776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 21:07:00.007 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274374674358603776[0;39m ==> Parameters: 
2023-01-27 21:07:00.016 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274374674358603776[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.GeneratedMethodAccessor111.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor71.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 21 common frames omitted
2023-01-27 21:07:05.004 INFO  com.example.wiki.job.DocJob                       :32   [32m274374695338512384[0;39m 更新电子书下的文档数据开始
2023-01-27 21:07:05.006 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274374695338512384[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:07:05.006 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274374695338512384[0;39m ==> Parameters: 
2023-01-27 21:07:05.022 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274374695338512384[0;39m <==    Updates: 1
2023-01-27 21:07:05.023 INFO  com.example.wiki.job.DocJob                       :35   [32m274374695338512384[0;39m 更新电子书下的文档数据结束，耗时：18毫秒
2023-01-27 21:07:35.004 INFO  com.example.wiki.job.DocJob                       :32   [32m274374821167632384[0;39m 更新电子书下的文档数据开始
2023-01-27 21:07:35.006 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274374821167632384[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:07:35.006 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274374821167632384[0;39m ==> Parameters: 
2023-01-27 21:07:35.009 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274374821167632384[0;39m <==    Updates: 1
2023-01-27 21:07:35.009 INFO  com.example.wiki.job.DocJob                       :35   [32m274374821167632384[0;39m 更新电子书下的文档数据结束，耗时：4毫秒
2023-01-27 21:08:00.007 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274374926037815296[0;39m 生成今日电子书快照开始
2023-01-27 21:08:00.009 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274374926037815296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 21:08:00.010 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274374926037815296[0;39m ==> Parameters: 
2023-01-27 21:08:00.013 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274374926037815296[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.GeneratedMethodAccessor111.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor71.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 21 common frames omitted
2023-01-27 21:08:05.010 INFO  com.example.wiki.job.DocJob                       :32   [32m274374947021918208[0;39m 更新电子书下的文档数据开始
2023-01-27 21:08:05.012 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274374947021918208[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:08:05.012 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274374947021918208[0;39m ==> Parameters: 
2023-01-27 21:08:05.015 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274374947021918208[0;39m <==    Updates: 1
2023-01-27 21:08:05.016 INFO  com.example.wiki.job.DocJob                       :35   [32m274374947021918208[0;39m 更新电子书下的文档数据结束，耗时：5毫秒
2023-01-27 21:08:35.010 INFO  com.example.wiki.job.DocJob                       :32   [32m274375072851038208[0;39m 更新电子书下的文档数据开始
2023-01-27 21:08:35.012 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274375072851038208[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:08:35.012 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274375072851038208[0;39m ==> Parameters: 
2023-01-27 21:08:35.016 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274375072851038208[0;39m <==    Updates: 1
2023-01-27 21:08:35.016 INFO  com.example.wiki.job.DocJob                       :35   [32m274375072851038208[0;39m 更新电子书下的文档数据结束，耗时：6毫秒
2023-01-27 21:09:00.016 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274375177733804032[0;39m 生成今日电子书快照开始
2023-01-27 21:09:00.019 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274375177733804032[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 21:09:00.019 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274375177733804032[0;39m ==> Parameters: 
2023-01-27 21:09:00.023 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274375177733804032[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.GeneratedMethodAccessor111.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor71.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 21 common frames omitted
2023-01-27 21:09:05.010 INFO  com.example.wiki.job.DocJob                       :32   [32m274375198680158208[0;39m 更新电子书下的文档数据开始
2023-01-27 21:09:05.012 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274375198680158208[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:09:05.012 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274375198680158208[0;39m ==> Parameters: 
2023-01-27 21:09:05.015 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274375198680158208[0;39m <==    Updates: 1
2023-01-27 21:09:05.016 INFO  com.example.wiki.job.DocJob                       :35   [32m274375198680158208[0;39m 更新电子书下的文档数据结束，耗时：6毫秒
2023-01-27 21:09:16.423 INFO  com.example.wiki.aspect.LogAspect                 :50   [32m274375246549749760[0;39m ------------- 开始 -------------
2023-01-27 21:09:16.424 INFO  com.example.wiki.aspect.LogAspect                 :51   [32m274375246549749760[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2023-01-27 21:09:16.424 INFO  com.example.wiki.aspect.LogAspect                 :52   [32m274375246549749760[0;39m 类名方法: com.example.wiki.controller.EbookController.list
2023-01-27 21:09:16.424 INFO  com.example.wiki.aspect.LogAspect                 :53   [32m274375246549749760[0;39m 远程地址: 127.0.0.1
2023-01-27 21:09:16.425 INFO  com.example.wiki.aspect.LogAspect                 :75   [32m274375246549749760[0;39m 请求参数: [{"page":1,"size":1000}]
2023-01-27 21:09:16.428 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274375246549749760[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2023-01-27 21:09:16.428 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274375246549749760[0;39m ==> Parameters: 
2023-01-27 21:09:16.444 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274375246549749760[0;39m <==    Columns: count(0)
2023-01-27 21:09:16.445 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274375246549749760[0;39m <==        Row: 5
2023-01-27 21:09:16.445 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274375246549749760[0;39m <==      Total: 1
2023-01-27 21:09:16.447 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274375246549749760[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2023-01-27 21:09:16.447 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274375246549749760[0;39m ==> Parameters: 1000(Integer)
2023-01-27 21:09:16.449 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274375246549749760[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2023-01-27 21:09:16.449 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274375246549749760[0;39m <==        Row: 1, Spring Boot 入门教程, null, null, 零基础入门 Java 开发，企业级应用开发最佳首选框架, null, 6, 0, 0
2023-01-27 21:09:16.450 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274375246549749760[0;39m <==        Row: 2, Vue 入门教程, null, null, 零基础入门 Vue 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 21:09:16.450 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274375246549749760[0;39m <==        Row: 3, Python 入门教程, null, null, 零基础入门 Python 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 21:09:16.450 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274375246549749760[0;39m <==        Row: 4, Mysql 入门教程, null, null, 零基础入门 Mysql 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 21:09:16.451 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274375246549749760[0;39m <==        Row: 5, Oracle 入门教程, null, null, 零基础入门 Oracle 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 21:09:16.451 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274375246549749760[0;39m <==      Total: 5
2023-01-27 21:09:16.452 INFO  com.example.wiki.service.EbookService             :51   [32m274375246549749760[0;39m 总行数 5
2023-01-27 21:09:16.452 INFO  com.example.wiki.service.EbookService             :52   [32m274375246549749760[0;39m 总页数 1
2023-01-27 21:09:16.452 INFO  com.example.wiki.aspect.LogAspect                 :87   [32m274375246549749760[0;39m 返回结果: {"content":{"list":[{"description":"零基础入门 Java 开发，企业级应用开发最佳首选框架","docCount":6,"id":1,"name":"Spring Boot 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Vue 开发，企业级应用开发最佳首选框架","id":2,"name":"Vue 入门教程"},{"description":"零基础入门 Python 开发，企业级应用开发最佳首选框架","id":3,"name":"Python 入门教程"},{"description":"零基础入门 Mysql 开发，企业级应用开发最佳首选框架","id":4,"name":"Mysql 入门教程"},{"description":"零基础入门 Oracle 开发，企业级应用开发最佳首选框架","id":5,"name":"Oracle 入门教程"}],"total":5},"success":true}
2023-01-27 21:09:16.452 INFO  com.example.wiki.aspect.LogAspect                 :88   [32m274375246549749760[0;39m ------------- 结束 耗时：29 ms -------------
2023-01-27 21:09:29.034 INFO  com.example.wiki.aspect.LogAspect                 :50   [32m274375299444117504[0;39m ------------- 开始 -------------
2023-01-27 21:09:29.035 INFO  com.example.wiki.aspect.LogAspect                 :51   [32m274375299444117504[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2023-01-27 21:09:29.035 INFO  com.example.wiki.aspect.LogAspect                 :52   [32m274375299444117504[0;39m 类名方法: com.example.wiki.controller.EbookController.list
2023-01-27 21:09:29.035 INFO  com.example.wiki.aspect.LogAspect                 :53   [32m274375299444117504[0;39m 远程地址: 127.0.0.1
2023-01-27 21:09:29.035 INFO  com.example.wiki.aspect.LogAspect                 :75   [32m274375299444117504[0;39m 请求参数: [{"page":1,"size":10}]
2023-01-27 21:09:29.038 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274375299444117504[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2023-01-27 21:09:29.038 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274375299444117504[0;39m ==> Parameters: 
2023-01-27 21:09:29.040 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274375299444117504[0;39m <==    Columns: count(0)
2023-01-27 21:09:29.041 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274375299444117504[0;39m <==        Row: 5
2023-01-27 21:09:29.041 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274375299444117504[0;39m <==      Total: 1
2023-01-27 21:09:29.042 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274375299444117504[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2023-01-27 21:09:29.042 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274375299444117504[0;39m ==> Parameters: 10(Integer)
2023-01-27 21:09:29.043 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274375299444117504[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2023-01-27 21:09:29.043 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274375299444117504[0;39m <==        Row: 1, Spring Boot 入门教程, null, null, 零基础入门 Java 开发，企业级应用开发最佳首选框架, null, 6, 0, 0
2023-01-27 21:09:29.043 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274375299444117504[0;39m <==        Row: 2, Vue 入门教程, null, null, 零基础入门 Vue 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 21:09:29.044 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274375299444117504[0;39m <==        Row: 3, Python 入门教程, null, null, 零基础入门 Python 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 21:09:29.044 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274375299444117504[0;39m <==        Row: 4, Mysql 入门教程, null, null, 零基础入门 Mysql 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 21:09:29.044 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274375299444117504[0;39m <==        Row: 5, Oracle 入门教程, null, null, 零基础入门 Oracle 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 21:09:29.044 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274375299444117504[0;39m <==      Total: 5
2023-01-27 21:09:29.045 INFO  com.example.wiki.service.EbookService             :51   [32m274375299444117504[0;39m 总行数 5
2023-01-27 21:09:29.045 INFO  com.example.wiki.service.EbookService             :52   [32m274375299444117504[0;39m 总页数 1
2023-01-27 21:09:29.046 INFO  com.example.wiki.aspect.LogAspect                 :87   [32m274375299444117504[0;39m 返回结果: {"content":{"list":[{"description":"零基础入门 Java 开发，企业级应用开发最佳首选框架","docCount":6,"id":1,"name":"Spring Boot 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Vue 开发，企业级应用开发最佳首选框架","id":2,"name":"Vue 入门教程"},{"description":"零基础入门 Python 开发，企业级应用开发最佳首选框架","id":3,"name":"Python 入门教程"},{"description":"零基础入门 Mysql 开发，企业级应用开发最佳首选框架","id":4,"name":"Mysql 入门教程"},{"description":"零基础入门 Oracle 开发，企业级应用开发最佳首选框架","id":5,"name":"Oracle 入门教程"}],"total":5},"success":true}
2023-01-27 21:09:29.046 INFO  com.example.wiki.aspect.LogAspect                 :88   [32m274375299444117504[0;39m ------------- 结束 耗时：12 ms -------------
2023-01-27 21:09:35.002 INFO  com.example.wiki.job.DocJob                       :32   [32m274375324475723776[0;39m 更新电子书下的文档数据开始
2023-01-27 21:09:35.003 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274375324475723776[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:09:35.003 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274375324475723776[0;39m ==> Parameters: 
2023-01-27 21:09:35.005 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274375324475723776[0;39m <==    Updates: 1
2023-01-27 21:09:35.005 INFO  com.example.wiki.job.DocJob                       :35   [32m274375324475723776[0;39m 更新电子书下的文档数据结束，耗时：3毫秒
2023-01-27 21:10:00.016 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274375429392044032[0;39m 生成今日电子书快照开始
2023-01-27 21:10:00.020 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274375429392044032[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 21:10:00.021 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274375429392044032[0;39m ==> Parameters: 
2023-01-27 21:10:00.025 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274375429392044032[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.GeneratedMethodAccessor111.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor71.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 21 common frames omitted
2023-01-27 21:10:05.013 INFO  com.example.wiki.job.DocJob                       :32   [32m274375450350981120[0;39m 更新电子书下的文档数据开始
2023-01-27 21:10:05.014 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274375450350981120[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:10:05.014 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274375450350981120[0;39m ==> Parameters: 
2023-01-27 21:10:05.015 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274375450350981120[0;39m <==    Updates: 1
2023-01-27 21:10:05.016 INFO  com.example.wiki.job.DocJob                       :35   [32m274375450350981120[0;39m 更新电子书下的文档数据结束，耗时：3毫秒
2023-01-27 21:10:11.684 INFO  com.example.wiki.aspect.LogAspect                 :50   [32m274375478331183104[0;39m ------------- 开始 -------------
2023-01-27 21:10:11.685 INFO  com.example.wiki.aspect.LogAspect                 :51   [32m274375478331183104[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2023-01-27 21:10:11.685 INFO  com.example.wiki.aspect.LogAspect                 :52   [32m274375478331183104[0;39m 类名方法: com.example.wiki.controller.EbookController.list
2023-01-27 21:10:11.686 INFO  com.example.wiki.aspect.LogAspect                 :53   [32m274375478331183104[0;39m 远程地址: 127.0.0.1
2023-01-27 21:10:11.686 INFO  com.example.wiki.aspect.LogAspect                 :75   [32m274375478331183104[0;39m 请求参数: [{"page":1,"size":1000}]
2023-01-27 21:10:11.688 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274375478331183104[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2023-01-27 21:10:11.689 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274375478331183104[0;39m ==> Parameters: 
2023-01-27 21:10:11.700 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274375478331183104[0;39m <==    Columns: count(0)
2023-01-27 21:10:11.701 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274375478331183104[0;39m <==        Row: 5
2023-01-27 21:10:11.702 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274375478331183104[0;39m <==      Total: 1
2023-01-27 21:10:11.702 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274375478331183104[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2023-01-27 21:10:11.703 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274375478331183104[0;39m ==> Parameters: 1000(Integer)
2023-01-27 21:10:11.704 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274375478331183104[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2023-01-27 21:10:11.704 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274375478331183104[0;39m <==        Row: 1, Spring Boot 入门教程, null, null, 零基础入门 Java 开发，企业级应用开发最佳首选框架, null, 6, 0, 0
2023-01-27 21:10:11.704 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274375478331183104[0;39m <==        Row: 2, Vue 入门教程, null, null, 零基础入门 Vue 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 21:10:11.704 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274375478331183104[0;39m <==        Row: 3, Python 入门教程, null, null, 零基础入门 Python 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 21:10:11.705 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274375478331183104[0;39m <==        Row: 4, Mysql 入门教程, null, null, 零基础入门 Mysql 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 21:10:11.705 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274375478331183104[0;39m <==        Row: 5, Oracle 入门教程, null, null, 零基础入门 Oracle 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 21:10:11.705 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274375478331183104[0;39m <==      Total: 5
2023-01-27 21:10:11.705 INFO  com.example.wiki.service.EbookService             :51   [32m274375478331183104[0;39m 总行数 5
2023-01-27 21:10:11.705 INFO  com.example.wiki.service.EbookService             :52   [32m274375478331183104[0;39m 总页数 1
2023-01-27 21:10:11.706 INFO  com.example.wiki.aspect.LogAspect                 :87   [32m274375478331183104[0;39m 返回结果: {"content":{"list":[{"description":"零基础入门 Java 开发，企业级应用开发最佳首选框架","docCount":6,"id":1,"name":"Spring Boot 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Vue 开发，企业级应用开发最佳首选框架","id":2,"name":"Vue 入门教程"},{"description":"零基础入门 Python 开发，企业级应用开发最佳首选框架","id":3,"name":"Python 入门教程"},{"description":"零基础入门 Mysql 开发，企业级应用开发最佳首选框架","id":4,"name":"Mysql 入门教程"},{"description":"零基础入门 Oracle 开发，企业级应用开发最佳首选框架","id":5,"name":"Oracle 入门教程"}],"total":5},"success":true}
2023-01-27 21:10:11.706 INFO  com.example.wiki.aspect.LogAspect                 :88   [32m274375478331183104[0;39m ------------- 结束 耗时：22 ms -------------
2023-01-27 21:10:35.007 INFO  com.example.wiki.job.DocJob                       :32   [32m274375576154935296[0;39m 更新电子书下的文档数据开始
2023-01-27 21:10:35.008 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274375576154935296[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:10:35.008 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274375576154935296[0;39m ==> Parameters: 
2023-01-27 21:10:35.009 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274375576154935296[0;39m <==    Updates: 1
2023-01-27 21:10:35.009 INFO  com.example.wiki.job.DocJob                       :35   [32m274375576154935296[0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2023-01-27 21:11:00.001 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274375680987369472[0;39m 生成今日电子书快照开始
2023-01-27 21:11:00.002 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274375680987369472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 21:11:00.003 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274375680987369472[0;39m ==> Parameters: 
2023-01-27 21:11:00.004 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274375680987369472[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.GeneratedMethodAccessor111.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor71.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 21 common frames omitted
2023-01-27 21:11:05.010 INFO  com.example.wiki.job.DocJob                       :32   [32m274375701996638208[0;39m 更新电子书下的文档数据开始
2023-01-27 21:11:05.011 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274375701996638208[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:11:05.011 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274375701996638208[0;39m ==> Parameters: 
2023-01-27 21:11:05.013 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274375701996638208[0;39m <==    Updates: 1
2023-01-27 21:11:05.013 INFO  com.example.wiki.job.DocJob                       :35   [32m274375701996638208[0;39m 更新电子书下的文档数据结束，耗时：3毫秒
2023-01-27 21:11:35.003 INFO  com.example.wiki.job.DocJob                       :32   [32m274375827796398080[0;39m 更新电子书下的文档数据开始
2023-01-27 21:11:35.004 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274375827796398080[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:11:35.004 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274375827796398080[0;39m ==> Parameters: 
2023-01-27 21:11:35.016 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274375827796398080[0;39m <==    Updates: 1
2023-01-27 21:11:35.016 INFO  com.example.wiki.job.DocJob                       :35   [32m274375827796398080[0;39m 更新电子书下的文档数据结束，耗时：13毫秒
2023-01-27 21:12:00.004 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274375932658192384[0;39m 生成今日电子书快照开始
2023-01-27 21:12:00.006 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274375932658192384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 21:12:00.007 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274375932658192384[0;39m ==> Parameters: 
2023-01-27 21:12:00.010 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274375932658192384[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.GeneratedMethodAccessor111.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor71.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 21 common frames omitted
2023-01-27 21:12:05.003 INFO  com.example.wiki.job.DocJob                       :32   [32m274375953625518080[0;39m 更新电子书下的文档数据开始
2023-01-27 21:12:05.005 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274375953625518080[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:12:05.006 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274375953625518080[0;39m ==> Parameters: 
2023-01-27 21:12:05.008 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274375953625518080[0;39m <==    Updates: 1
2023-01-27 21:12:05.009 INFO  com.example.wiki.job.DocJob                       :35   [32m274375953625518080[0;39m 更新电子书下的文档数据结束，耗时：5毫秒
2023-01-27 21:12:35.015 INFO  com.example.wiki.job.DocJob                       :32   [32m274376079504969728[0;39m 更新电子书下的文档数据开始
2023-01-27 21:12:35.016 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274376079504969728[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:12:35.017 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274376079504969728[0;39m ==> Parameters: 
2023-01-27 21:12:35.018 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274376079504969728[0;39m <==    Updates: 1
2023-01-27 21:12:35.018 INFO  com.example.wiki.job.DocJob                       :35   [32m274376079504969728[0;39m 更新电子书下的文档数据结束，耗时：3毫秒
2023-01-27 21:13:00.011 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274376184345792512[0;39m 生成今日电子书快照开始
2023-01-27 21:13:00.012 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274376184345792512[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 21:13:00.013 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274376184345792512[0;39m ==> Parameters: 
2023-01-27 21:13:00.016 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274376184345792512[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.GeneratedMethodAccessor111.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor71.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 21 common frames omitted
2023-01-27 21:13:05.009 INFO  com.example.wiki.job.DocJob                       :32   [32m274376205308923904[0;39m 更新电子书下的文档数据开始
2023-01-27 21:13:05.011 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274376205308923904[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:13:05.012 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274376205308923904[0;39m ==> Parameters: 
2023-01-27 21:13:05.014 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274376205308923904[0;39m <==    Updates: 1
2023-01-27 21:13:05.015 INFO  com.example.wiki.job.DocJob                       :35   [32m274376205308923904[0;39m 更新电子书下的文档数据结束，耗时：5毫秒
2023-01-27 21:13:35.005 INFO  com.example.wiki.job.DocJob                       :32   [32m274376331121266688[0;39m 更新电子书下的文档数据开始
2023-01-27 21:13:35.006 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274376331121266688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:13:35.006 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274376331121266688[0;39m ==> Parameters: 
2023-01-27 21:13:35.007 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274376331121266688[0;39m <==    Updates: 1
2023-01-27 21:13:35.007 INFO  com.example.wiki.job.DocJob                       :35   [32m274376331121266688[0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2023-01-27 21:14:00.009 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274376435995643904[0;39m 生成今日电子书快照开始
2023-01-27 21:14:00.011 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274376435995643904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 21:14:00.012 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274376435995643904[0;39m ==> Parameters: 
2023-01-27 21:14:00.017 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274376435995643904[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.GeneratedMethodAccessor111.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor71.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 21 common frames omitted
2023-01-27 21:14:05.004 INFO  com.example.wiki.job.DocJob                       :32   [32m274376456946192384[0;39m 更新电子书下的文档数据开始
2023-01-27 21:14:05.006 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274376456946192384[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:14:05.007 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274376456946192384[0;39m ==> Parameters: 
2023-01-27 21:14:05.010 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274376456946192384[0;39m <==    Updates: 1
2023-01-27 21:14:05.010 INFO  com.example.wiki.job.DocJob                       :35   [32m274376456946192384[0;39m 更新电子书下的文档数据结束，耗时：5毫秒
2023-01-27 21:14:35.011 INFO  com.example.wiki.job.DocJob                       :32   [32m274376582804672512[0;39m 更新电子书下的文档数据开始
2023-01-27 21:14:35.014 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274376582804672512[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:14:35.014 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274376582804672512[0;39m ==> Parameters: 
2023-01-27 21:14:35.017 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274376582804672512[0;39m <==    Updates: 1
2023-01-27 21:14:35.017 INFO  com.example.wiki.job.DocJob                       :35   [32m274376582804672512[0;39m 更新电子书下的文档数据结束，耗时：6毫秒
2023-01-27 21:15:00.009 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274376687653883904[0;39m 生成今日电子书快照开始
2023-01-27 21:15:00.010 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274376687653883904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 21:15:00.010 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274376687653883904[0;39m ==> Parameters: 
2023-01-27 21:15:00.012 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274376687653883904[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.GeneratedMethodAccessor111.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor71.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 21 common frames omitted
2023-01-27 21:15:05.009 INFO  com.example.wiki.job.DocJob                       :32   [32m274376708625403904[0;39m 更新电子书下的文档数据开始
2023-01-27 21:15:05.011 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274376708625403904[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:15:05.011 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274376708625403904[0;39m ==> Parameters: 
2023-01-27 21:15:05.014 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274376708625403904[0;39m <==    Updates: 1
2023-01-27 21:15:05.014 INFO  com.example.wiki.job.DocJob                       :35   [32m274376708625403904[0;39m 更新电子书下的文档数据结束，耗时：4毫秒
2023-01-27 21:15:35.000 INFO  com.example.wiki.job.DocJob                       :32   [32m274376834416775168[0;39m 更新电子书下的文档数据开始
2023-01-27 21:15:35.002 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274376834416775168[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:15:35.003 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274376834416775168[0;39m ==> Parameters: 
2023-01-27 21:15:35.005 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274376834416775168[0;39m <==    Updates: 1
2023-01-27 21:15:35.006 INFO  com.example.wiki.job.DocJob                       :35   [32m274376834416775168[0;39m 更新电子书下的文档数据结束，耗时：5毫秒
2023-01-27 21:16:00.015 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274376939337289728[0;39m 生成今日电子书快照开始
2023-01-27 21:16:00.016 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274376939337289728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 21:16:00.017 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274376939337289728[0;39m ==> Parameters: 
2023-01-27 21:16:00.019 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274376939337289728[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.GeneratedMethodAccessor111.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor71.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 21 common frames omitted
2023-01-27 21:16:05.015 INFO  com.example.wiki.job.DocJob                       :32   [32m274376960308809728[0;39m 更新电子书下的文档数据开始
2023-01-27 21:16:05.016 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274376960308809728[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:16:05.017 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274376960308809728[0;39m ==> Parameters: 
2023-01-27 21:16:05.020 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274376960308809728[0;39m <==    Updates: 1
2023-01-27 21:16:05.020 INFO  com.example.wiki.job.DocJob                       :35   [32m274376960308809728[0;39m 更新电子书下的文档数据结束，耗时：5毫秒
2023-01-27 21:16:35.005 INFO  com.example.wiki.job.DocJob                       :32   [32m274377086095986688[0;39m 更新电子书下的文档数据开始
2023-01-27 21:16:35.007 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274377086095986688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:16:35.007 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274377086095986688[0;39m ==> Parameters: 
2023-01-27 21:16:35.010 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274377086095986688[0;39m <==    Updates: 1
2023-01-27 21:16:35.010 INFO  com.example.wiki.job.DocJob                       :35   [32m274377086095986688[0;39m 更新电子书下的文档数据结束，耗时：5毫秒
2023-01-27 21:17:00.009 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274377190970363904[0;39m 生成今日电子书快照开始
2023-01-27 21:17:00.011 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274377190970363904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 21:17:00.013 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274377190970363904[0;39m ==> Parameters: 
2023-01-27 21:17:00.017 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274377190970363904[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.GeneratedMethodAccessor111.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor71.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 21 common frames omitted
2023-01-27 21:17:05.007 INFO  com.example.wiki.job.DocJob                       :32   [32m274377211933495296[0;39m 更新电子书下的文档数据开始
2023-01-27 21:17:05.008 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274377211933495296[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:17:05.008 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274377211933495296[0;39m ==> Parameters: 
2023-01-27 21:17:05.010 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274377211933495296[0;39m <==    Updates: 1
2023-01-27 21:17:05.010 INFO  com.example.wiki.job.DocJob                       :35   [32m274377211933495296[0;39m 更新电子书下的文档数据结束，耗时：3毫秒
2023-01-27 21:17:35.012 INFO  com.example.wiki.job.DocJob                       :32   [32m274377337783586816[0;39m 更新电子书下的文档数据开始
2023-01-27 21:17:35.013 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274377337783586816[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:17:35.013 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274377337783586816[0;39m ==> Parameters: 
2023-01-27 21:17:35.014 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274377337783586816[0;39m <==    Updates: 1
2023-01-27 21:17:35.014 INFO  com.example.wiki.job.DocJob                       :35   [32m274377337783586816[0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2023-01-27 21:18:00.006 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274377442616020992[0;39m 生成今日电子书快照开始
2023-01-27 21:18:00.007 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274377442616020992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 21:18:00.008 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274377442616020992[0;39m ==> Parameters: 
2023-01-27 21:18:00.011 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274377442616020992[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.GeneratedMethodAccessor111.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor71.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 21 common frames omitted
2023-01-27 21:18:05.010 INFO  com.example.wiki.job.DocJob                       :32   [32m274377463604318208[0;39m 更新电子书下的文档数据开始
2023-01-27 21:18:05.012 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274377463604318208[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:18:05.013 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274377463604318208[0;39m ==> Parameters: 
2023-01-27 21:18:05.014 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274377463604318208[0;39m <==    Updates: 1
2023-01-27 21:18:05.016 INFO  com.example.wiki.job.DocJob                       :35   [32m274377463604318208[0;39m 更新电子书下的文档数据结束，耗时：5毫秒
2023-01-27 21:18:35.008 INFO  com.example.wiki.job.DocJob                       :32   [32m274377589425049600[0;39m 更新电子书下的文档数据开始
2023-01-27 21:18:35.009 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274377589425049600[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:18:35.009 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274377589425049600[0;39m ==> Parameters: 
2023-01-27 21:18:35.011 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274377589425049600[0;39m <==    Updates: 1
2023-01-27 21:18:35.011 INFO  com.example.wiki.job.DocJob                       :35   [32m274377589425049600[0;39m 更新电子书下的文档数据结束，耗时：3毫秒
2023-01-27 21:19:00.004 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274377694265872384[0;39m 生成今日电子书快照开始
2023-01-27 21:19:00.006 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274377694265872384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 21:19:00.008 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274377694265872384[0;39m ==> Parameters: 
2023-01-27 21:19:00.024 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274377694265872384[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.GeneratedMethodAccessor111.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor71.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 21 common frames omitted
2023-01-27 21:19:05.003 INFO  com.example.wiki.job.DocJob                       :32   [32m274377715233198080[0;39m 更新电子书下的文档数据开始
2023-01-27 21:19:05.005 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274377715233198080[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:19:05.006 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274377715233198080[0;39m ==> Parameters: 
2023-01-27 21:19:05.008 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274377715233198080[0;39m <==    Updates: 1
2023-01-27 21:19:05.008 INFO  com.example.wiki.job.DocJob                       :35   [32m274377715233198080[0;39m 更新电子书下的文档数据结束，耗时：4毫秒
2023-01-27 21:19:35.014 INFO  com.example.wiki.job.DocJob                       :32   [32m274377841108455424[0;39m 更新电子书下的文档数据开始
2023-01-27 21:19:35.015 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274377841108455424[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:19:35.015 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274377841108455424[0;39m ==> Parameters: 
2023-01-27 21:19:35.017 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274377841108455424[0;39m <==    Updates: 1
2023-01-27 21:19:35.017 INFO  com.example.wiki.job.DocJob                       :35   [32m274377841108455424[0;39m 更新电子书下的文档数据结束，耗时：3毫秒
2023-01-27 21:19:55.371 INFO  com.example.wiki.aspect.LogAspect                 :50   [32m274377926491901952[0;39m ------------- 开始 -------------
2023-01-27 21:19:55.371 INFO  com.example.wiki.aspect.LogAspect                 :51   [32m274377926491901952[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2023-01-27 21:19:55.372 INFO  com.example.wiki.aspect.LogAspect                 :52   [32m274377926491901952[0;39m 类名方法: com.example.wiki.controller.EbookController.list
2023-01-27 21:19:55.372 INFO  com.example.wiki.aspect.LogAspect                 :53   [32m274377926491901952[0;39m 远程地址: 127.0.0.1
2023-01-27 21:19:55.372 INFO  com.example.wiki.aspect.LogAspect                 :75   [32m274377926491901952[0;39m 请求参数: [{"page":1,"size":1000}]
2023-01-27 21:19:55.374 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274377926491901952[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2023-01-27 21:19:55.374 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274377926491901952[0;39m ==> Parameters: 
2023-01-27 21:19:55.379 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274377926491901952[0;39m <==    Columns: count(0)
2023-01-27 21:19:55.379 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274377926491901952[0;39m <==        Row: 5
2023-01-27 21:19:55.379 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274377926491901952[0;39m <==      Total: 1
2023-01-27 21:19:55.380 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274377926491901952[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2023-01-27 21:19:55.380 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274377926491901952[0;39m ==> Parameters: 1000(Integer)
2023-01-27 21:19:55.382 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274377926491901952[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2023-01-27 21:19:55.382 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274377926491901952[0;39m <==        Row: 1, Spring Boot 入门教程, null, null, 零基础入门 Java 开发，企业级应用开发最佳首选框架, null, 6, 0, 0
2023-01-27 21:19:55.383 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274377926491901952[0;39m <==        Row: 2, Vue 入门教程, null, null, 零基础入门 Vue 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 21:19:55.383 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274377926491901952[0;39m <==        Row: 3, Python 入门教程, null, null, 零基础入门 Python 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 21:19:55.383 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274377926491901952[0;39m <==        Row: 4, Mysql 入门教程, null, null, 零基础入门 Mysql 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 21:19:55.384 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274377926491901952[0;39m <==        Row: 5, Oracle 入门教程, null, null, 零基础入门 Oracle 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 21:19:55.384 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274377926491901952[0;39m <==      Total: 5
2023-01-27 21:19:55.384 INFO  com.example.wiki.service.EbookService             :51   [32m274377926491901952[0;39m 总行数 5
2023-01-27 21:19:55.385 INFO  com.example.wiki.service.EbookService             :52   [32m274377926491901952[0;39m 总页数 1
2023-01-27 21:19:55.385 INFO  com.example.wiki.aspect.LogAspect                 :87   [32m274377926491901952[0;39m 返回结果: {"content":{"list":[{"description":"零基础入门 Java 开发，企业级应用开发最佳首选框架","docCount":6,"id":1,"name":"Spring Boot 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Vue 开发，企业级应用开发最佳首选框架","id":2,"name":"Vue 入门教程"},{"description":"零基础入门 Python 开发，企业级应用开发最佳首选框架","id":3,"name":"Python 入门教程"},{"description":"零基础入门 Mysql 开发，企业级应用开发最佳首选框架","id":4,"name":"Mysql 入门教程"},{"description":"零基础入门 Oracle 开发，企业级应用开发最佳首选框架","id":5,"name":"Oracle 入门教程"}],"total":5},"success":true}
2023-01-27 21:19:55.385 INFO  com.example.wiki.aspect.LogAspect                 :88   [32m274377926491901952[0;39m ------------- 结束 耗时：14 ms -------------
2023-01-27 21:19:55.390 INFO  com.example.wiki.aspect.LogAspect                 :50   [32m274377926571593728[0;39m ------------- 开始 -------------
2023-01-27 21:19:55.391 INFO  com.example.wiki.aspect.LogAspect                 :51   [32m274377926571593728[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2023-01-27 21:19:55.391 INFO  com.example.wiki.aspect.LogAspect                 :52   [32m274377926571593728[0;39m 类名方法: com.example.wiki.controller.EbookController.list
2023-01-27 21:19:55.391 INFO  com.example.wiki.aspect.LogAspect                 :53   [32m274377926571593728[0;39m 远程地址: 127.0.0.1
2023-01-27 21:19:55.391 INFO  com.example.wiki.aspect.LogAspect                 :75   [32m274377926571593728[0;39m 请求参数: [{"page":1,"size":1000}]
2023-01-27 21:19:55.392 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274377926571593728[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2023-01-27 21:19:55.393 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274377926571593728[0;39m ==> Parameters: 
2023-01-27 21:19:55.394 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274377926571593728[0;39m <==    Columns: count(0)
2023-01-27 21:19:55.395 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274377926571593728[0;39m <==        Row: 5
2023-01-27 21:19:55.395 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274377926571593728[0;39m <==      Total: 1
2023-01-27 21:19:55.395 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274377926571593728[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2023-01-27 21:19:55.396 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274377926571593728[0;39m ==> Parameters: 1000(Integer)
2023-01-27 21:19:55.396 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274377926571593728[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2023-01-27 21:19:55.396 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274377926571593728[0;39m <==        Row: 1, Spring Boot 入门教程, null, null, 零基础入门 Java 开发，企业级应用开发最佳首选框架, null, 6, 0, 0
2023-01-27 21:19:55.398 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274377926571593728[0;39m <==        Row: 2, Vue 入门教程, null, null, 零基础入门 Vue 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 21:19:55.398 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274377926571593728[0;39m <==        Row: 3, Python 入门教程, null, null, 零基础入门 Python 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 21:19:55.398 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274377926571593728[0;39m <==        Row: 4, Mysql 入门教程, null, null, 零基础入门 Mysql 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 21:19:55.398 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274377926571593728[0;39m <==        Row: 5, Oracle 入门教程, null, null, 零基础入门 Oracle 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 21:19:55.399 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274377926571593728[0;39m <==      Total: 5
2023-01-27 21:19:55.399 INFO  com.example.wiki.service.EbookService             :51   [32m274377926571593728[0;39m 总行数 5
2023-01-27 21:19:55.399 INFO  com.example.wiki.service.EbookService             :52   [32m274377926571593728[0;39m 总页数 1
2023-01-27 21:19:55.400 INFO  com.example.wiki.aspect.LogAspect                 :87   [32m274377926571593728[0;39m 返回结果: {"content":{"list":[{"description":"零基础入门 Java 开发，企业级应用开发最佳首选框架","docCount":6,"id":1,"name":"Spring Boot 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Vue 开发，企业级应用开发最佳首选框架","id":2,"name":"Vue 入门教程"},{"description":"零基础入门 Python 开发，企业级应用开发最佳首选框架","id":3,"name":"Python 入门教程"},{"description":"零基础入门 Mysql 开发，企业级应用开发最佳首选框架","id":4,"name":"Mysql 入门教程"},{"description":"零基础入门 Oracle 开发，企业级应用开发最佳首选框架","id":5,"name":"Oracle 入门教程"}],"total":5},"success":true}
2023-01-27 21:19:55.400 INFO  com.example.wiki.aspect.LogAspect                 :88   [32m274377926571593728[0;39m ------------- 结束 耗时：10 ms -------------
2023-01-27 21:20:00.013 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274377945961861120[0;39m 生成今日电子书快照开始
2023-01-27 21:20:00.014 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274377945961861120[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 21:20:00.014 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274377945961861120[0;39m ==> Parameters: 
2023-01-27 21:20:00.018 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274377945961861120[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.GeneratedMethodAccessor111.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor71.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 21 common frames omitted
2023-01-27 21:20:05.014 INFO  com.example.wiki.job.DocJob                       :32   [32m274377966937575424[0;39m 更新电子书下的文档数据开始
2023-01-27 21:20:05.015 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274377966937575424[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:20:05.015 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274377966937575424[0;39m ==> Parameters: 
2023-01-27 21:20:05.016 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274377966937575424[0;39m <==    Updates: 1
2023-01-27 21:20:05.016 INFO  com.example.wiki.job.DocJob                       :35   [32m274377966937575424[0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2023-01-27 21:20:34.869 INFO  com.example.wiki.interceptor.LoginInterceptor     :29   [32m274370039510077440[0;39m ------------- LoginInterceptor 开始 -------------
2023-01-27 21:20:34.869 INFO  com.example.wiki.interceptor.LoginInterceptor     :40   [32m274370039510077440[0;39m 接口登录拦截：，path：http://127.0.0.1:8080/category/list
2023-01-27 21:20:34.869 INFO  com.example.wiki.interceptor.LoginInterceptor     :44   [32m274370039510077440[0;39m 登录校验开始，token：null
2023-01-27 21:20:34.869 INFO  com.example.wiki.interceptor.LoginInterceptor     :46   [32m274370039510077440[0;39m token为空，请求被拦截
2023-01-27 21:20:35.010 INFO  com.example.wiki.job.DocJob                       :32   [32m274378092749918208[0;39m 更新电子书下的文档数据开始
2023-01-27 21:20:35.011 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274378092749918208[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:20:35.011 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274378092749918208[0;39m ==> Parameters: 
2023-01-27 21:20:35.012 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274378092749918208[0;39m <==    Updates: 1
2023-01-27 21:20:35.013 INFO  com.example.wiki.job.DocJob                       :35   [32m274378092749918208[0;39m 更新电子书下的文档数据结束，耗时：3毫秒
2023-01-27 21:21:00.011 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274378197611712512[0;39m 生成今日电子书快照开始
2023-01-27 21:21:00.013 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274378197611712512[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 21:21:00.015 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274378197611712512[0;39m ==> Parameters: 
2023-01-27 21:21:00.018 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274378197611712512[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.GeneratedMethodAccessor111.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor71.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 21 common frames omitted
2023-01-27 21:21:05.013 INFO  com.example.wiki.job.DocJob                       :32   [32m274378218591621120[0;39m 更新电子书下的文档数据开始
2023-01-27 21:21:05.015 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274378218591621120[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:21:05.016 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274378218591621120[0;39m ==> Parameters: 
2023-01-27 21:21:05.018 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274378218591621120[0;39m <==    Updates: 1
2023-01-27 21:21:05.018 INFO  com.example.wiki.job.DocJob                       :35   [32m274378218591621120[0;39m 更新电子书下的文档数据结束，耗时：4毫秒
2023-01-27 21:21:35.014 INFO  com.example.wiki.job.DocJob                       :32   [32m274378344424935424[0;39m 更新电子书下的文档数据开始
2023-01-27 21:21:35.015 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274378344424935424[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:21:35.015 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274378344424935424[0;39m ==> Parameters: 
2023-01-27 21:21:35.016 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274378344424935424[0;39m <==    Updates: 1
2023-01-27 21:21:35.016 INFO  com.example.wiki.job.DocJob                       :35   [32m274378344424935424[0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2023-01-27 21:22:00.013 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274378449278341120[0;39m 生成今日电子书快照开始
2023-01-27 21:22:00.015 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274378449278341120[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 21:22:00.017 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274378449278341120[0;39m ==> Parameters: 
2023-01-27 21:22:00.021 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274378449278341120[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.GeneratedMethodAccessor111.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor71.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 21 common frames omitted
2023-01-27 21:22:05.008 INFO  com.example.wiki.job.DocJob                       :32   [32m274378470228889600[0;39m 更新电子书下的文档数据开始
2023-01-27 21:22:05.009 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274378470228889600[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:22:05.010 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274378470228889600[0;39m ==> Parameters: 
2023-01-27 21:22:05.013 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274378470228889600[0;39m <==    Updates: 1
2023-01-27 21:22:05.013 INFO  com.example.wiki.job.DocJob                       :35   [32m274378470228889600[0;39m 更新电子书下的文档数据结束，耗时：5毫秒
2023-01-27 21:22:35.015 INFO  com.example.wiki.job.DocJob                       :32   [32m274378596087369728[0;39m 更新电子书下的文档数据开始
2023-01-27 21:22:35.017 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274378596087369728[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:22:35.017 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274378596087369728[0;39m ==> Parameters: 
2023-01-27 21:22:35.030 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274378596087369728[0;39m <==    Updates: 1
2023-01-27 21:22:35.031 INFO  com.example.wiki.job.DocJob                       :35   [32m274378596087369728[0;39m 更新电子书下的文档数据结束，耗时：15毫秒
2023-01-27 21:22:41.518 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :218  [32m                  [0;39m Shutting down ExecutorService 'taskScheduler'
2023-01-27 21:22:41.520 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :218  [32m                  [0;39m Shutting down ExecutorService 'applicationTaskExecutor'
2023-01-27 21:22:41.520 INFO  com.zaxxer.hikari.HikariDataSource                :350  [32m                  [0;39m HikariPool-1 - Shutdown initiated...
2023-01-27 21:22:41.527 INFO  com.zaxxer.hikari.HikariDataSource                :352  [32m                  [0;39m HikariPool-1 - Shutdown completed.
2023-01-27 21:22:51.359 INFO  org.hibernate.validator.internal.util.Version     :21   [32m                  [0;39m HV000001: Hibernate Validator 6.1.6.Final
2023-01-27 21:22:51.366 INFO  com.example.wiki.config.WikiApplication           :55   [32m                  [0;39m Starting WikiApplication using Java 1.8.0_352 on Noland with PID 31568 (C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes started by amper in C:\Users\amper\project\Wiki\Knowledge-Based-System)
2023-01-27 21:22:51.368 INFO  com.example.wiki.config.WikiApplication           :660  [32m                  [0;39m No active profile set, falling back to default profiles: default
2023-01-27 21:22:51.428 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2023-01-27 21:22:51.428 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2023-01-27 21:22:52.269 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :250  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2023-01-27 21:22:52.272 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :128  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2023-01-27 21:22:52.296 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :188  [32m                  [0;39m Finished Spring Data repository scanning in 7 ms. Found 0 Redis repository interfaces.
2023-01-27 21:22:53.197 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8080 (http)
2023-01-27 21:22:53.208 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8080"]
2023-01-27 21:22:53.208 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2023-01-27 21:22:53.210 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.39]
2023-01-27 21:22:53.444 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2023-01-27 21:22:53.444 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :289  [32m                  [0;39m Root WebApplicationContext: initialization completed in 2015 ms
2023-01-27 21:22:54.126 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :181  [32m                  [0;39m Initializing ExecutorService 'applicationTaskExecutor'
2023-01-27 21:22:54.426 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :181  [32m                  [0;39m Initializing ExecutorService 'taskScheduler'
2023-01-27 21:22:54.466 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2023-01-27 21:22:54.492 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Starting ProtocolHandler ["http-nio-8080"]
2023-01-27 21:22:54.515 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8080 (http) with context path ''
2023-01-27 21:22:54.525 INFO  com.example.wiki.config.WikiApplication           :61   [32m                  [0;39m Started WikiApplication in 3.691 seconds (JVM running for 4.826)
2023-01-27 21:22:54.527 INFO  com.example.wiki.config.WikiApplication           :24   [32m                  [0;39m Start successfully!
2023-01-27 21:22:54.528 INFO  com.example.wiki.config.WikiApplication           :25   [32m                  [0;39m Address: 	http://127.0.0.1:8080
2023-01-27 21:23:00.007 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274378700907220992[0;39m 生成今日电子书快照开始
2023-01-27 21:23:00.052 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m274378700907220992[0;39m HikariPool-1 - Starting...
2023-01-27 21:23:00.329 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m274378700907220992[0;39m HikariPool-1 - Start completed.
2023-01-27 21:23:00.335 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274378700907220992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 21:23:00.351 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274378700907220992[0;39m ==> Parameters: 
2023-01-27 21:23:00.400 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274378700907220992[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 22 common frames omitted
2023-01-27 21:23:05.014 INFO  com.example.wiki.job.DocJob                       :32   [32m274378721912295424[0;39m 更新电子书下的文档数据开始
2023-01-27 21:23:05.024 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274378721912295424[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:23:05.024 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274378721912295424[0;39m ==> Parameters: 
2023-01-27 21:23:05.036 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274378721912295424[0;39m <==    Updates: 1
2023-01-27 21:23:05.037 INFO  com.example.wiki.job.DocJob                       :35   [32m274378721912295424[0;39m 更新电子书下的文档数据结束，耗时：22毫秒
2023-01-27 21:23:28.274 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring DispatcherServlet 'dispatcherServlet'
2023-01-27 21:23:28.275 INFO  org.springframework.web.servlet.DispatcherServlet :525  [32m                  [0;39m Initializing Servlet 'dispatcherServlet'
2023-01-27 21:23:28.277 INFO  org.springframework.web.servlet.DispatcherServlet :547  [32m                  [0;39m Completed initialization in 2 ms
2023-01-27 21:23:28.300 INFO  com.example.wiki.interceptor.LoginInterceptor     :29   [32m                  [0;39m ------------- LoginInterceptor 开始 -------------
2023-01-27 21:23:28.301 INFO  com.example.wiki.interceptor.LoginInterceptor     :40   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/category/list
2023-01-27 21:23:28.301 INFO  com.example.wiki.interceptor.LoginInterceptor     :44   [32m                  [0;39m 登录校验开始，token：null
2023-01-27 21:23:28.301 INFO  com.example.wiki.interceptor.LoginInterceptor     :46   [32m                  [0;39m token为空，请求被拦截
2023-01-27 21:23:35.010 INFO  com.example.wiki.job.DocJob                       :32   [32m274378847724638208[0;39m 更新电子书下的文档数据开始
2023-01-27 21:23:35.011 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274378847724638208[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:23:35.012 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274378847724638208[0;39m ==> Parameters: 
2023-01-27 21:23:35.014 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274378847724638208[0;39m <==    Updates: 1
2023-01-27 21:23:35.014 INFO  com.example.wiki.job.DocJob                       :35   [32m274378847724638208[0;39m 更新电子书下的文档数据结束，耗时：4毫秒
2023-01-27 21:23:35.718 INFO  com.example.wiki.aspect.LogAspect                 :50   [32m274378850690011136[0;39m ------------- 开始 -------------
2023-01-27 21:23:35.719 INFO  com.example.wiki.aspect.LogAspect                 :51   [32m274378850690011136[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2023-01-27 21:23:35.719 INFO  com.example.wiki.aspect.LogAspect                 :52   [32m274378850690011136[0;39m 类名方法: com.example.wiki.controller.EbookController.list
2023-01-27 21:23:35.720 INFO  com.example.wiki.aspect.LogAspect                 :53   [32m274378850690011136[0;39m 远程地址: 127.0.0.1
2023-01-27 21:23:35.791 INFO  com.example.wiki.aspect.LogAspect                 :75   [32m274378850690011136[0;39m 请求参数: [{"page":1,"size":1000}]
2023-01-27 21:23:35.842 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274378850690011136[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2023-01-27 21:23:35.842 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274378850690011136[0;39m ==> Parameters: 
2023-01-27 21:23:35.864 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274378850690011136[0;39m <==    Columns: count(0)
2023-01-27 21:23:35.865 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274378850690011136[0;39m <==        Row: 5
2023-01-27 21:23:35.866 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274378850690011136[0;39m <==      Total: 1
2023-01-27 21:23:35.869 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274378850690011136[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2023-01-27 21:23:35.870 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274378850690011136[0;39m ==> Parameters: 1000(Integer)
2023-01-27 21:23:35.872 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274378850690011136[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2023-01-27 21:23:35.872 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274378850690011136[0;39m <==        Row: 1, Spring Boot 入门教程, null, null, 零基础入门 Java 开发，企业级应用开发最佳首选框架, null, 6, 0, 0
2023-01-27 21:23:35.873 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274378850690011136[0;39m <==        Row: 2, Vue 入门教程, null, null, 零基础入门 Vue 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 21:23:35.874 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274378850690011136[0;39m <==        Row: 3, Python 入门教程, null, null, 零基础入门 Python 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 21:23:35.874 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274378850690011136[0;39m <==        Row: 4, Mysql 入门教程, null, null, 零基础入门 Mysql 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 21:23:35.874 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274378850690011136[0;39m <==        Row: 5, Oracle 入门教程, null, null, 零基础入门 Oracle 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 21:23:35.875 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274378850690011136[0;39m <==      Total: 5
2023-01-27 21:23:35.877 INFO  com.example.wiki.service.EbookService             :51   [32m274378850690011136[0;39m 总行数 5
2023-01-27 21:23:35.877 INFO  com.example.wiki.service.EbookService             :52   [32m274378850690011136[0;39m 总页数 1
2023-01-27 21:23:35.889 INFO  com.example.wiki.aspect.LogAspect                 :87   [32m274378850690011136[0;39m 返回结果: {"content":{"list":[{"description":"零基础入门 Java 开发，企业级应用开发最佳首选框架","docCount":6,"id":1,"name":"Spring Boot 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Vue 开发，企业级应用开发最佳首选框架","id":2,"name":"Vue 入门教程"},{"description":"零基础入门 Python 开发，企业级应用开发最佳首选框架","id":3,"name":"Python 入门教程"},{"description":"零基础入门 Mysql 开发，企业级应用开发最佳首选框架","id":4,"name":"Mysql 入门教程"},{"description":"零基础入门 Oracle 开发，企业级应用开发最佳首选框架","id":5,"name":"Oracle 入门教程"}],"total":5},"success":true}
2023-01-27 21:23:35.889 INFO  com.example.wiki.aspect.LogAspect                 :88   [32m274378850690011136[0;39m ------------- 结束 耗时：172 ms -------------
2023-01-27 21:23:46.368 INFO  com.example.wiki.interceptor.LoginInterceptor     :29   [32m                  [0;39m ------------- LoginInterceptor 开始 -------------
2023-01-27 21:23:46.369 INFO  com.example.wiki.interceptor.LoginInterceptor     :40   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/category/list
2023-01-27 21:23:46.369 INFO  com.example.wiki.interceptor.LoginInterceptor     :44   [32m                  [0;39m 登录校验开始，token：null
2023-01-27 21:23:46.369 INFO  com.example.wiki.interceptor.LoginInterceptor     :46   [32m                  [0;39m token为空，请求被拦截
2023-01-27 21:24:00.004 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274378952557072384[0;39m 生成今日电子书快照开始
2023-01-27 21:24:00.012 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274378952557072384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 21:24:00.014 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274378952557072384[0;39m ==> Parameters: 
2023-01-27 21:24:00.033 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274378952557072384[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 22 common frames omitted
2023-01-27 21:24:05.014 INFO  com.example.wiki.job.DocJob                       :32   [32m274378973570535424[0;39m 更新电子书下的文档数据开始
2023-01-27 21:24:05.015 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274378973570535424[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:24:05.016 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274378973570535424[0;39m ==> Parameters: 
2023-01-27 21:24:05.018 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274378973570535424[0;39m <==    Updates: 1
2023-01-27 21:24:05.019 INFO  com.example.wiki.job.DocJob                       :35   [32m274378973570535424[0;39m 更新电子书下的文档数据结束，耗时：5毫秒
2023-01-27 21:24:12.494 INFO  com.example.wiki.aspect.LogAspect                 :50   [32m274379004943929344[0;39m ------------- 开始 -------------
2023-01-27 21:24:12.495 INFO  com.example.wiki.aspect.LogAspect                 :51   [32m274379004943929344[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2023-01-27 21:24:12.495 INFO  com.example.wiki.aspect.LogAspect                 :52   [32m274379004943929344[0;39m 类名方法: com.example.wiki.controller.EbookController.list
2023-01-27 21:24:12.495 INFO  com.example.wiki.aspect.LogAspect                 :53   [32m274379004943929344[0;39m 远程地址: 127.0.0.1
2023-01-27 21:24:12.496 INFO  com.example.wiki.aspect.LogAspect                 :75   [32m274379004943929344[0;39m 请求参数: [{"page":1,"size":10}]
2023-01-27 21:24:12.498 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274379004943929344[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2023-01-27 21:24:12.498 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274379004943929344[0;39m ==> Parameters: 
2023-01-27 21:24:12.500 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274379004943929344[0;39m <==    Columns: count(0)
2023-01-27 21:24:12.501 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274379004943929344[0;39m <==        Row: 5
2023-01-27 21:24:12.501 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274379004943929344[0;39m <==      Total: 1
2023-01-27 21:24:12.502 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274379004943929344[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2023-01-27 21:24:12.503 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274379004943929344[0;39m ==> Parameters: 10(Integer)
2023-01-27 21:24:12.504 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274379004943929344[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2023-01-27 21:24:12.504 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274379004943929344[0;39m <==        Row: 1, Spring Boot 入门教程, null, null, 零基础入门 Java 开发，企业级应用开发最佳首选框架, null, 6, 0, 0
2023-01-27 21:24:12.505 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274379004943929344[0;39m <==        Row: 2, Vue 入门教程, null, null, 零基础入门 Vue 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 21:24:12.505 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274379004943929344[0;39m <==        Row: 3, Python 入门教程, null, null, 零基础入门 Python 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 21:24:12.507 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274379004943929344[0;39m <==        Row: 4, Mysql 入门教程, null, null, 零基础入门 Mysql 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 21:24:12.507 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274379004943929344[0;39m <==        Row: 5, Oracle 入门教程, null, null, 零基础入门 Oracle 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 21:24:12.508 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274379004943929344[0;39m <==      Total: 5
2023-01-27 21:24:12.509 INFO  com.example.wiki.service.EbookService             :51   [32m274379004943929344[0;39m 总行数 5
2023-01-27 21:24:12.509 INFO  com.example.wiki.service.EbookService             :52   [32m274379004943929344[0;39m 总页数 1
2023-01-27 21:24:12.510 INFO  com.example.wiki.aspect.LogAspect                 :87   [32m274379004943929344[0;39m 返回结果: {"content":{"list":[{"description":"零基础入门 Java 开发，企业级应用开发最佳首选框架","docCount":6,"id":1,"name":"Spring Boot 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Vue 开发，企业级应用开发最佳首选框架","id":2,"name":"Vue 入门教程"},{"description":"零基础入门 Python 开发，企业级应用开发最佳首选框架","id":3,"name":"Python 入门教程"},{"description":"零基础入门 Mysql 开发，企业级应用开发最佳首选框架","id":4,"name":"Mysql 入门教程"},{"description":"零基础入门 Oracle 开发，企业级应用开发最佳首选框架","id":5,"name":"Oracle 入门教程"}],"total":5},"success":true}
2023-01-27 21:24:12.510 INFO  com.example.wiki.aspect.LogAspect                 :88   [32m274379004943929344[0;39m ------------- 结束 耗时：16 ms -------------
2023-01-27 21:24:34.457 INFO  com.example.wiki.interceptor.LoginInterceptor     :29   [32m                  [0;39m ------------- LoginInterceptor 开始 -------------
2023-01-27 21:24:34.458 INFO  com.example.wiki.interceptor.LoginInterceptor     :40   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/category/list
2023-01-27 21:24:34.458 INFO  com.example.wiki.interceptor.LoginInterceptor     :44   [32m                  [0;39m 登录校验开始，token：null
2023-01-27 21:24:34.458 INFO  com.example.wiki.interceptor.LoginInterceptor     :46   [32m                  [0;39m token为空，请求被拦截
2023-01-27 21:24:35.005 INFO  com.example.wiki.job.DocJob                       :32   [32m274379099361906688[0;39m 更新电子书下的文档数据开始
2023-01-27 21:24:35.006 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274379099361906688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:24:35.006 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274379099361906688[0;39m ==> Parameters: 
2023-01-27 21:24:35.008 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274379099361906688[0;39m <==    Updates: 1
2023-01-27 21:24:35.008 INFO  com.example.wiki.job.DocJob                       :35   [32m274379099361906688[0;39m 更新电子书下的文档数据结束，耗时：3毫秒
2023-01-27 21:24:47.210 INFO  com.example.wiki.interceptor.LoginInterceptor     :29   [32m                  [0;39m ------------- LoginInterceptor 开始 -------------
2023-01-27 21:24:47.211 INFO  com.example.wiki.interceptor.LoginInterceptor     :40   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/category/list
2023-01-27 21:24:47.211 INFO  com.example.wiki.interceptor.LoginInterceptor     :44   [32m                  [0;39m 登录校验开始，token：null
2023-01-27 21:24:47.211 INFO  com.example.wiki.interceptor.LoginInterceptor     :46   [32m                  [0;39m token为空，请求被拦截
2023-01-27 21:24:47.215 INFO  com.example.wiki.interceptor.LoginInterceptor     :29   [32m                  [0;39m ------------- LoginInterceptor 开始 -------------
2023-01-27 21:24:47.216 INFO  com.example.wiki.interceptor.LoginInterceptor     :40   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/category/list
2023-01-27 21:24:47.216 INFO  com.example.wiki.interceptor.LoginInterceptor     :44   [32m                  [0;39m 登录校验开始，token：null
2023-01-27 21:24:47.216 INFO  com.example.wiki.interceptor.LoginInterceptor     :46   [32m                  [0;39m token为空，请求被拦截
2023-01-27 21:24:53.318 INFO  com.example.wiki.aspect.LogAspect                 :50   [32m274379176172195840[0;39m ------------- 开始 -------------
2023-01-27 21:24:53.318 INFO  com.example.wiki.aspect.LogAspect                 :51   [32m274379176172195840[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2023-01-27 21:24:53.318 INFO  com.example.wiki.aspect.LogAspect                 :52   [32m274379176172195840[0;39m 类名方法: com.example.wiki.controller.EbookController.list
2023-01-27 21:24:53.319 INFO  com.example.wiki.aspect.LogAspect                 :53   [32m274379176172195840[0;39m 远程地址: 127.0.0.1
2023-01-27 21:24:53.319 INFO  com.example.wiki.aspect.LogAspect                 :75   [32m274379176172195840[0;39m 请求参数: [{"page":1,"size":10}]
2023-01-27 21:24:53.321 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274379176172195840[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2023-01-27 21:24:53.322 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274379176172195840[0;39m ==> Parameters: 
2023-01-27 21:24:53.324 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274379176172195840[0;39m <==    Columns: count(0)
2023-01-27 21:24:53.325 TRACE c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m274379176172195840[0;39m <==        Row: 5
2023-01-27 21:24:53.325 DEBUG c.e.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m274379176172195840[0;39m <==      Total: 1
2023-01-27 21:24:53.326 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274379176172195840[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2023-01-27 21:24:53.327 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274379176172195840[0;39m ==> Parameters: 10(Integer)
2023-01-27 21:24:53.328 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274379176172195840[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2023-01-27 21:24:53.329 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274379176172195840[0;39m <==        Row: 1, Spring Boot 入门教程, null, null, 零基础入门 Java 开发，企业级应用开发最佳首选框架, null, 6, 0, 0
2023-01-27 21:24:53.329 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274379176172195840[0;39m <==        Row: 2, Vue 入门教程, null, null, 零基础入门 Vue 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 21:24:53.330 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274379176172195840[0;39m <==        Row: 3, Python 入门教程, null, null, 零基础入门 Python 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 21:24:53.330 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274379176172195840[0;39m <==        Row: 4, Mysql 入门教程, null, null, 零基础入门 Mysql 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 21:24:53.330 TRACE c.example.wiki.mapper.EbookMapper.selectByExample :143  [32m274379176172195840[0;39m <==        Row: 5, Oracle 入门教程, null, null, 零基础入门 Oracle 开发，企业级应用开发最佳首选框架, null, null, null, null
2023-01-27 21:24:53.331 DEBUG c.example.wiki.mapper.EbookMapper.selectByExample :137  [32m274379176172195840[0;39m <==      Total: 5
2023-01-27 21:24:53.331 INFO  com.example.wiki.service.EbookService             :51   [32m274379176172195840[0;39m 总行数 5
2023-01-27 21:24:53.331 INFO  com.example.wiki.service.EbookService             :52   [32m274379176172195840[0;39m 总页数 1
2023-01-27 21:24:53.331 INFO  com.example.wiki.aspect.LogAspect                 :87   [32m274379176172195840[0;39m 返回结果: {"content":{"list":[{"description":"零基础入门 Java 开发，企业级应用开发最佳首选框架","docCount":6,"id":1,"name":"Spring Boot 入门教程","viewCount":0,"voteCount":0},{"description":"零基础入门 Vue 开发，企业级应用开发最佳首选框架","id":2,"name":"Vue 入门教程"},{"description":"零基础入门 Python 开发，企业级应用开发最佳首选框架","id":3,"name":"Python 入门教程"},{"description":"零基础入门 Mysql 开发，企业级应用开发最佳首选框架","id":4,"name":"Mysql 入门教程"},{"description":"零基础入门 Oracle 开发，企业级应用开发最佳首选框架","id":5,"name":"Oracle 入门教程"}],"total":5},"success":true}
2023-01-27 21:24:53.332 INFO  com.example.wiki.aspect.LogAspect                 :88   [32m274379176172195840[0;39m ------------- 结束 耗时：14 ms -------------
2023-01-27 21:25:00.013 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274379204253061120[0;39m 生成今日电子书快照开始
2023-01-27 21:25:00.016 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274379204253061120[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 21:25:00.018 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274379204253061120[0;39m ==> Parameters: 
2023-01-27 21:25:00.035 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274379204253061120[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 22 common frames omitted
2023-01-27 21:25:00.080 INFO  com.example.wiki.interceptor.LoginInterceptor     :29   [32m                  [0;39m ------------- LoginInterceptor 开始 -------------
2023-01-27 21:25:00.082 INFO  com.example.wiki.interceptor.LoginInterceptor     :40   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/category/list
2023-01-27 21:25:00.082 INFO  com.example.wiki.interceptor.LoginInterceptor     :44   [32m                  [0;39m 登录校验开始，token：null
2023-01-27 21:25:00.082 INFO  com.example.wiki.interceptor.LoginInterceptor     :46   [32m                  [0;39m token为空，请求被拦截
2023-01-27 21:25:05.009 INFO  com.example.wiki.job.DocJob                       :32   [32m274379225207803904[0;39m 更新电子书下的文档数据开始
2023-01-27 21:25:05.011 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274379225207803904[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:25:05.011 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274379225207803904[0;39m ==> Parameters: 
2023-01-27 21:25:05.015 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274379225207803904[0;39m <==    Updates: 1
2023-01-27 21:25:05.016 INFO  com.example.wiki.job.DocJob                       :35   [32m274379225207803904[0;39m 更新电子书下的文档数据结束，耗时：7毫秒
2023-01-27 21:25:07.406 INFO  com.example.wiki.interceptor.LoginInterceptor     :29   [32m274379004943929344[0;39m ------------- LoginInterceptor 开始 -------------
2023-01-27 21:25:07.407 INFO  com.example.wiki.interceptor.LoginInterceptor     :40   [32m274379004943929344[0;39m 接口登录拦截：，path：http://127.0.0.1:8080/category/list
2023-01-27 21:25:07.407 INFO  com.example.wiki.interceptor.LoginInterceptor     :44   [32m274379004943929344[0;39m 登录校验开始，token：null
2023-01-27 21:25:07.407 INFO  com.example.wiki.interceptor.LoginInterceptor     :46   [32m274379004943929344[0;39m token为空，请求被拦截
2023-01-27 21:25:08.912 INFO  com.example.wiki.interceptor.LoginInterceptor     :29   [32m                  [0;39m ------------- LoginInterceptor 开始 -------------
2023-01-27 21:25:08.912 INFO  com.example.wiki.interceptor.LoginInterceptor     :40   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/category/list
2023-01-27 21:25:08.912 INFO  com.example.wiki.interceptor.LoginInterceptor     :44   [32m                  [0;39m 登录校验开始，token：null
2023-01-27 21:25:08.913 INFO  com.example.wiki.interceptor.LoginInterceptor     :46   [32m                  [0;39m token为空，请求被拦截
2023-01-27 21:25:35.005 INFO  com.example.wiki.job.DocJob                       :32   [32m274379351020146688[0;39m 更新电子书下的文档数据开始
2023-01-27 21:25:35.006 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274379351020146688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:25:35.006 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274379351020146688[0;39m ==> Parameters: 
2023-01-27 21:25:35.008 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274379351020146688[0;39m <==    Updates: 1
2023-01-27 21:25:35.009 INFO  com.example.wiki.job.DocJob                       :35   [32m274379351020146688[0;39m 更新电子书下的文档数据结束，耗时：4毫秒
2023-01-27 21:26:00.011 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274379455902912512[0;39m 生成今日电子书快照开始
2023-01-27 21:26:00.014 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274379455902912512[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 21:26:00.018 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274379455902912512[0;39m ==> Parameters: 
2023-01-27 21:26:00.030 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274379455902912512[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 22 common frames omitted
2023-01-27 21:26:05.010 INFO  com.example.wiki.job.DocJob                       :32   [32m274379476870238208[0;39m 更新电子书下的文档数据开始
2023-01-27 21:26:05.012 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274379476870238208[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:26:05.014 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274379476870238208[0;39m ==> Parameters: 
2023-01-27 21:26:05.017 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274379476870238208[0;39m <==    Updates: 1
2023-01-27 21:26:05.017 INFO  com.example.wiki.job.DocJob                       :35   [32m274379476870238208[0;39m 更新电子书下的文档数据结束，耗时：6毫秒
2023-01-27 21:26:35.014 INFO  com.example.wiki.job.DocJob                       :32   [32m274379602716135424[0;39m 更新电子书下的文档数据开始
2023-01-27 21:26:35.014 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274379602716135424[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:26:35.014 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274379602716135424[0;39m ==> Parameters: 
2023-01-27 21:26:35.016 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274379602716135424[0;39m <==    Updates: 1
2023-01-27 21:26:35.016 INFO  com.example.wiki.job.DocJob                       :35   [32m274379602716135424[0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2023-01-27 21:27:00.010 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274379707556958208[0;39m 生成今日电子书快照开始
2023-01-27 21:27:00.013 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274379707556958208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 21:27:00.014 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274379707556958208[0;39m ==> Parameters: 
2023-01-27 21:27:00.024 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274379707556958208[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor66.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 22 common frames omitted
2023-01-27 21:27:05.005 INFO  com.example.wiki.job.DocJob                       :32   [32m274379728507506688[0;39m 更新电子书下的文档数据开始
2023-01-27 21:27:05.007 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274379728507506688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:27:05.008 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274379728507506688[0;39m ==> Parameters: 
2023-01-27 21:27:05.012 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274379728507506688[0;39m <==    Updates: 1
2023-01-27 21:27:05.013 INFO  com.example.wiki.job.DocJob                       :35   [32m274379728507506688[0;39m 更新电子书下的文档数据结束，耗时：7毫秒
2023-01-27 21:27:35.005 INFO  com.example.wiki.job.DocJob                       :32   [32m274379854336626688[0;39m 更新电子书下的文档数据开始
2023-01-27 21:27:35.007 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274379854336626688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:27:35.008 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274379854336626688[0;39m ==> Parameters: 
2023-01-27 21:27:35.011 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274379854336626688[0;39m <==    Updates: 1
2023-01-27 21:27:35.012 INFO  com.example.wiki.job.DocJob                       :35   [32m274379854336626688[0;39m 更新电子书下的文档数据结束，耗时：6毫秒
2023-01-27 21:27:57.920 INFO  com.example.wiki.interceptor.LoginInterceptor     :29   [32m                  [0;39m ------------- LoginInterceptor 开始 -------------
2023-01-27 21:27:57.921 INFO  com.example.wiki.interceptor.LoginInterceptor     :40   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/admin/category/list
2023-01-27 21:27:57.921 INFO  com.example.wiki.interceptor.LoginInterceptor     :44   [32m                  [0;39m 登录校验开始，token：null
2023-01-27 21:27:57.921 INFO  com.example.wiki.interceptor.LoginInterceptor     :46   [32m                  [0;39m token为空，请求被拦截
2023-01-27 21:27:57.926 INFO  com.example.wiki.interceptor.LoginInterceptor     :29   [32m                  [0;39m ------------- LoginInterceptor 开始 -------------
2023-01-27 21:27:57.926 INFO  com.example.wiki.interceptor.LoginInterceptor     :40   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/admin/category/list
2023-01-27 21:27:57.927 INFO  com.example.wiki.interceptor.LoginInterceptor     :44   [32m                  [0;39m 登录校验开始，token：null
2023-01-27 21:27:57.927 INFO  com.example.wiki.interceptor.LoginInterceptor     :46   [32m                  [0;39m token为空，请求被拦截
2023-01-27 21:28:00.003 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274379959185838080[0;39m 生成今日电子书快照开始
2023-01-27 21:28:00.005 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274379959185838080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 21:28:00.006 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274379959185838080[0;39m ==> Parameters: 
2023-01-27 21:28:00.011 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m274379959185838080[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [C:\Users\amper\project\Wiki\Knowledge-Based-System\wiki\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count             from ebook_snapshot             where `date` = date_sub(curdate(), interval 1 day)) t2         on t1.ebook_id = t2.ebook_id             set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),                 t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.genSnapshot(Unknown Source)
	at com.example.wiki.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:16)
	at com.example.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor66.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy130.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy128.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 22 common frames omitted
2023-01-27 21:28:02.749 INFO  com.example.wiki.interceptor.LoginInterceptor     :29   [32m274379176172195840[0;39m ------------- LoginInterceptor 开始 -------------
2023-01-27 21:28:02.749 INFO  com.example.wiki.interceptor.LoginInterceptor     :40   [32m274379176172195840[0;39m 接口登录拦截：，path：http://127.0.0.1:8080/admin/category/list
2023-01-27 21:28:02.750 INFO  com.example.wiki.interceptor.LoginInterceptor     :44   [32m274379176172195840[0;39m 登录校验开始，token：null
2023-01-27 21:28:02.750 INFO  com.example.wiki.interceptor.LoginInterceptor     :46   [32m274379176172195840[0;39m token为空，请求被拦截
2023-01-27 21:28:05.009 INFO  com.example.wiki.job.DocJob                       :32   [32m274379980182523904[0;39m 更新电子书下的文档数据开始
2023-01-27 21:28:05.010 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274379980182523904[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:28:05.011 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274379980182523904[0;39m ==> Parameters: 
2023-01-27 21:28:05.012 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274379980182523904[0;39m <==    Updates: 1
2023-01-27 21:28:05.014 INFO  com.example.wiki.job.DocJob                       :35   [32m274379980182523904[0;39m 更新电子书下的文档数据结束，耗时：5毫秒
2023-01-27 21:28:35.014 INFO  com.example.wiki.job.DocJob                       :32   [32m274380106032615424[0;39m 更新电子书下的文档数据开始
2023-01-27 21:28:35.015 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274380106032615424[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2023-01-27 21:28:35.015 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274380106032615424[0;39m ==> Parameters: 
2023-01-27 21:28:35.016 DEBUG c.e.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m274380106032615424[0;39m <==    Updates: 1
2023-01-27 21:28:35.016 INFO  com.example.wiki.job.DocJob                       :35   [32m274380106032615424[0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2023-01-27 21:29:00.008 INFO  com.example.wiki.job.EbookSnapshotJob             :32   [32m274380210865049600[0;39m 生成今日电子书快照开始
2023-01-27 21:29:00.008 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274380210865049600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2023-01-27 21:29:00.009 DEBUG c.e.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m274380210865049600[0;39m ==> Parameters: 
